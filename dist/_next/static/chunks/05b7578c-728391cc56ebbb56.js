"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[919],{3719:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});let s=r(2731),o=r(8146),i=r(5577),n=r(4831),h=r(7920);Object.defineProperty(e,"__esModule",{value:!0});var l=r(9900),u=r(9655);let a=" ".repeat(2),c=" ".repeat(4);function f(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{maxRows:r=15,maxColumns:s=10,maxNumSize:o=8,padMinus:i="auto"}=e;return"".concat(t.constructor.name," {\n").concat(a,"[\n").concat(c).concat(function(t,e,r,s,o){let{rows:i,columns:n}=t,h=Math.min(i,e),l=Math.min(n,r),u=[];if("auto"===o){o=!1;t:for(let e=0;e<h;e++)for(let r=0;r<l;r++)if(0>t.get(e,r)){o=!0;break t}}for(let e=0;e<h;e++){let r=[];for(let i=0;i<l;i++){var a,f;r.push((a=t.get(e,i),f=o,(a>=0&&f?" ".concat(g(a,s-1)):g(a,s)).padEnd(s)))}u.push("".concat(r.join(" ")))}return l!==n&&(u[u.length-1]+=" ... ".concat(n-r," more columns")),h!==i&&u.push("... ".concat(i-e," more rows")),u.join("\n".concat(c))}(t,r,s,o,i),"\n").concat(a,"]\n").concat(a,"rows: ").concat(t.rows,"\n").concat(a,"columns: ").concat(t.columns,"\n}")}function g(t,e){let r=t.toString();if(r.length<=e)return r;let s=t.toFixed(e);if(s.length>e&&(s=t.toFixed(Math.max(0,e-(s.length-e)))),s.length<=e&&!s.startsWith("0.000")&&!s.startsWith("-0.000"))return s;let o=t.toExponential(e);return o.length>e&&(o=t.toExponential(Math.max(0,e-(o.length-e)))),o.slice(0)}function m(t,e,r){let s=r?t.rows:t.rows-1;if(e<0||e>s)throw RangeError("Row index out of range")}function w(t,e,r){let s=r?t.columns:t.columns-1;if(e<0||e>s)throw RangeError("Column index out of range")}function p(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw RangeError("vector size must be the same as the number of columns");return e}function d(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw RangeError("vector size must be the same as the number of rows");return e}function y(t,e){if(!l.isAnyArray(e))throw TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw RangeError("row indices are out of range")}function M(t,e){if(!l.isAnyArray(e))throw TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw RangeError("column indices are out of range")}function b(t,e,r,s,o){if(5!=arguments.length)throw RangeError("expected 4 arguments");if(v("startRow",e),v("endRow",r),v("startColumn",s),v("endColumn",o),e>r||s>o||e<0||e>=t.rows||r<0||r>=t.rows||s<0||s>=t.columns||o<0||o>=t.columns)throw RangeError("Submatrix indices are out of range")}function x(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[];for(let s=0;s<t;s++)r.push(e);return r}function v(t,e){if("number"!=typeof e)throw TypeError("".concat(t," must be a number"))}function S(t){if(t.isEmpty())throw Error("Empty matrix has no elements to index")}class E{static from1DArray(t,e,r){if(t*e!==r.length)throw RangeError("data length does not match given dimensions");let s=new A(t,e);for(let o=0;o<t;o++)for(let t=0;t<e;t++)s.set(o,t,r[o*e+t]);return s}static rowVector(t){let e=new A(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new A(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new A(t,e)}static ones(t,e){return new A(t,e).fill(1)}static rand(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!=typeof r)throw TypeError("options must be an object");let{random:s=Math.random}=r,o=new A(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)o.set(r,t,s());return o}static randInt(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!=typeof r)throw TypeError("options must be an object");let{min:s=0,max:o=1e3,random:i=Math.random}=r;if(!Number.isInteger(s))throw TypeError("min must be an integer");if(!Number.isInteger(o))throw TypeError("max must be an integer");if(s>=o)throw RangeError("min must be smaller than max");let n=o-s,h=new A(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=s+Math.round(i()*n);h.set(r,t,e)}return h}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let s=Math.min(t,e),o=this.zeros(t,e);for(let t=0;t<s;t++)o.set(t,t,r);return o}static diag(t,e,r){let s=t.length;void 0===e&&(e=s),void 0===r&&(r=e);let o=Math.min(s,e,r),i=this.zeros(e,r);for(let e=0;e<o;e++)i.set(e,e,t[e]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,s=t.columns,o=new A(r,s);for(let i=0;i<r;i++)for(let r=0;r<s;r++)o.set(i,r,Math.min(t.get(i,r),e.get(i,r)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,s=t.columns,o=new this(r,s);for(let i=0;i<r;i++)for(let r=0;r<s;r++)o.set(i,r,Math.max(t.get(i,r),e.get(i,r)));return o}static checkMatrix(t){return E.isMatrix(t)?t:new A(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,s=!0,o=!1;for(;t<this.rows&&s;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(s=!1,o=!0);t++}return s}isReducedEchelonForm(){let t=0,e=0,r=-1,s=!0,o=!1;for(;t<this.rows&&s;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(s=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(s=!1);t++}return s}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let s=e;for(let o=e;o<t.rows;o++)t.get(o,r)>t.get(s,r)&&(s=o);if(0===t.get(s,r))r++;else{t.swapRows(e,s);let o=t.get(e,r);for(let s=r;s<t.columns;s++)t.set(e,s,t.get(e,s)/o);for(let s=e+1;s<t.rows;s++){let o=t.get(s,r)/t.get(e,r);t.set(s,r,0);for(let i=r+1;i<t.columns;i++)t.set(s,i,t.get(s,i)-t.get(e,i)*o)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,s=r-1;for(;s>=0;)if(0===t.maxRow(s))s--;else{let o=0,i=!1;for(;o<r&&!1===i;)1===t.get(s,o)?i=!0:o++;for(let r=0;r<s;r++){let i=t.get(r,o);for(let n=o;n<e;n++){let e=t.get(r,n)-i*t.get(s,n);t.set(r,n,e)}}s--}return t}set(){throw Error("set method is unimplemented")}get(){throw Error("get method is unimplemented")}repeat(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!=typeof t)throw TypeError("options must be an object");let{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw TypeError("columns must be a positive integer");let s=new A(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)s.setSubMatrix(this,this.rows*t,this.columns*e);return s}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){m(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return A.rowVector(this.getRow(t))}setRow(t,e){m(this,t),e=p(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){m(this,t),m(this,e);for(let r=0;r<this.columns;r++){let s=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,s)}return this}getColumn(t){w(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return A.columnVector(this.getColumn(t))}setColumn(t,e){w(this,t),e=d(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){w(this,t),w(this,e);for(let r=0;r<this.rows;r++){let s=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,s)}return this}addRowVector(t){t=p(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=p(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=p(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=p(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){m(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){w(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{let t=Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{let t=Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw Error("invalid option: ".concat(t))}}maxIndex(){S(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>t&&(t=this.get(r,s),e[0]=r,e[1]=s);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{let t=Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{let t=Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw Error("invalid option: ".concat(t))}}minIndex(){S(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<t&&(t=this.get(r,s),e[0]=r,e[1]=s);return e}maxRow(t){if(m(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){m(this,t),S(this);let e=this.get(t,0),r=[t,0];for(let s=1;s<this.columns;s++)this.get(t,s)>e&&(e=this.get(t,s),r[1]=s);return r}minRow(t){if(m(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){m(this,t),S(this);let e=this.get(t,0),r=[t,0];for(let s=1;s<this.columns;s++)this.get(t,s)<e&&(e=this.get(t,s),r[1]=s);return r}maxColumn(t){if(w(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){w(this,t),S(this);let e=this.get(0,t),r=[0,t];for(let s=1;s<this.rows;s++)this.get(s,t)>e&&(e=this.get(s,t),r[0]=s);return r}minColumn(t){if(w(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){w(this,t),S(this);let e=this.get(0,t),r=[0,t];for(let s=1;s<this.rows;s++)this.get(s,t)<e&&(e=this.get(s,t),r[0]=s);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frobenius";switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw RangeError("unknown norm type: ".concat(t))}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){E.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw RangeError("vectors do not have the same size");let r=0;for(let s=0;s<e.length;s++)r+=e[s]*t[s];return r}mmul(t){t=A.checkMatrix(t);let e=this.rows,r=this.columns,s=t.columns,o=new A(e,s),i=new Float64Array(r);for(let n=0;n<s;n++){for(let e=0;e<r;e++)i[e]=t.get(e,n);for(let t=0;t<e;t++){let e=0;for(let s=0;s<r;s++)e+=this.get(t,s)*i[s];o.set(t,n,e)}}return o}strassen2x2(t){t=A.checkMatrix(t);let e=new A(2,2),r=this.get(0,0),s=t.get(0,0),o=this.get(0,1),i=t.get(0,1),n=this.get(1,0),h=t.get(1,0),l=this.get(1,1),u=t.get(1,1),a=(r+l)*(s+u),c=(n+l)*s,f=r*(i-u),g=l*(h-s),m=(r+o)*u;return e.set(0,0,a+g-m+(o-l)*(h+u)),e.set(0,1,f+m),e.set(1,0,c+g),e.set(1,1,a-c+f+(n-r)*(s+i)),e}strassen3x3(t){t=A.checkMatrix(t);let e=new A(3,3),r=this.get(0,0),s=this.get(0,1),o=this.get(0,2),i=this.get(1,0),n=this.get(1,1),h=this.get(1,2),l=this.get(2,0),u=this.get(2,1),a=this.get(2,2),c=t.get(0,0),f=t.get(0,1),g=t.get(0,2),m=t.get(1,0),w=t.get(1,1),p=t.get(1,2),d=t.get(2,0),y=t.get(2,1),M=t.get(2,2),b=(r-i)*(-f+w),x=(-r+i+n)*(c-f+w),v=(i+n)*(-c+f),S=r*c,E=(-r+l+u)*(c-g+p),R=(-r+l)*(g-p),k=(l+u)*(-c+g),I=(-o+u+a)*(w+d-y),N=(o-a)*(w-y),T=o*d,V=(u+a)*(-d+y),C=(-o+n+h)*(p+d-M),q=(o-h)*(p-M),F=(n+h)*(-d+M);return e.set(0,0,S+T+s*m),e.set(0,1,(r+s+o-i-n-u-a)*w+x+v+S+I+T+V),e.set(0,2,S+E+k+(r+s+o-n-h-l-u)*p+T+C+F),e.set(1,0,b+n*(-c+f+m-w-p-d+M)+x+S+T+C+q),e.set(1,1,b+x+v+S+h*y),e.set(1,2,T+C+q+F+i*g),e.set(2,0,S+E+R+u*(-c+g+m-w-p-d+y)+I+N+T),e.set(2,1,I+N+T+V+l*f),e.set(2,2,S+E+R+k+a*M),e}mmulStrassen(t){t=A.checkMatrix(t);let e=this.clone(),r=e.rows,s=e.columns,o=t.rows,i=t.columns;function n(t,e,r){let s=t.rows,o=t.columns;return s===e&&o===r?t:E.zeros(e,r).setSubMatrix(t,0,0)}s!==o&&console.warn("Multiplying ".concat(r," x ").concat(s," and ").concat(o," x ").concat(i," matrix: dimensions do not match."));let h=Math.max(r,o),l=Math.max(s,i);return function t(e,r,s,o){if(s<=512||o<=512)return e.mmul(r);s%2==1&&o%2==1?(e=n(e,s+1,o+1),r=n(r,s+1,o+1)):s%2==1?(e=n(e,s+1,o),r=n(r,s+1,o)):o%2==1&&(e=n(e,s,o+1),r=n(r,s,o+1));let i=parseInt(e.rows/2,10),h=parseInt(e.columns/2,10),l=e.subMatrix(0,i-1,0,h-1),u=r.subMatrix(0,i-1,0,h-1),a=e.subMatrix(0,i-1,h,e.columns-1),c=r.subMatrix(0,i-1,h,r.columns-1),f=e.subMatrix(i,e.rows-1,0,h-1),g=r.subMatrix(i,r.rows-1,0,h-1),m=e.subMatrix(i,e.rows-1,h,e.columns-1),w=r.subMatrix(i,r.rows-1,h,r.columns-1),p=t(E.add(l,m),E.add(u,w),i,h),d=t(E.add(f,m),u,i,h),y=t(l,E.sub(c,w),i,h),M=t(m,E.sub(g,u),i,h),b=t(E.add(l,a),w,i,h),x=t(E.sub(f,l),E.add(u,c),i,h),v=t(E.sub(a,m),E.add(g,w),i,h),S=E.add(p,M);S.sub(b),S.add(v);let R=E.add(y,b),k=E.add(d,M),A=E.sub(p,d);A.add(y),A.add(x);let I=E.zeros(2*S.rows,2*S.columns);return(I=(I=(I=(I=I.setSubMatrix(S,0,0)).setSubMatrix(R,S.rows,0)).setSubMatrix(k,0,S.columns)).setSubMatrix(A,S.rows,S.columns)).subMatrix(0,s-1,0,o-1)}(e=n(e,h,l),t=n(t,h,l),h,l)}scaleRows(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!=typeof t)throw TypeError("options must be an object");let{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw TypeError("min must be a number");if(!Number.isFinite(r))throw TypeError("max must be a number");if(e>=r)throw RangeError("min must be smaller than max");let s=new A(this.rows,this.columns);for(let t=0;t<this.rows;t++){let o=this.getRow(t);o.length>0&&u(o,{min:e,max:r,output:o}),s.setRow(t,o)}return s}scaleColumns(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!=typeof t)throw TypeError("options must be an object");let{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw TypeError("min must be a number");if(!Number.isFinite(r))throw TypeError("max must be a number");if(e>=r)throw RangeError("min must be smaller than max");let s=new A(this.rows,this.columns);for(let t=0;t<this.columns;t++){let o=this.getColumn(t);o.length&&u(o,{min:e,max:r,output:o}),s.setColumn(t,o)}return s}flipRows(){let t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),s=this.get(e,this.columns-1-r);this.set(e,r,s),this.set(e,this.columns-1-r,t)}return this}flipColumns(){let t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),s=this.get(this.rows-1-r,e);this.set(r,e,s),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=A.checkMatrix(t);let e=this.rows,r=this.columns,s=t.rows,o=t.columns,i=new A(e*s,r*o);for(let n=0;n<e;n++)for(let e=0;e<r;e++)for(let r=0;r<s;r++)for(let h=0;h<o;h++)i.set(s*n+r,o*e+h,this.get(n,e)*t.get(r,h));return i}kroneckerSum(t){if(t=A.checkMatrix(t),!this.isSquare()||!t.isSquare())throw Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,s=this.kroneckerProduct(A.eye(r,r)),o=A.eye(e,e).kroneckerProduct(t);return s.add(o)}transpose(){let t=new A(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R;for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R;for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,s){b(this,t,e,r,s);let o=new A(e-t+1,s-r+1);for(let i=t;i<=e;i++)for(let e=r;e<=s;e++)o.set(i-t,e-r,this.get(i,e));return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw RangeError("Argument out of range");let s=new A(t.length,r-e+1);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw RangeError("Row index out of range: ".concat(t[o]));s.set(o,i-e,this.get(t[o],i))}return s}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw RangeError("Argument out of range");let s=new A(r-e+1,t.length);for(let o=0;o<t.length;o++)for(let i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw RangeError("Column index out of range: ".concat(t[o]));s.set(i-e,o,this.get(i,t[o]))}return s}setSubMatrix(t,e,r){if((t=A.checkMatrix(t)).isEmpty())return this;let s=e+t.rows-1,o=r+t.columns-1;b(this,e,s,r,o);for(let s=0;s<t.rows;s++)for(let o=0;o<t.columns;o++)this.set(e+s,r+o,t.get(s,o));return this}selection(t,e){y(this,t),M(this,e);let r=new A(t.length,e.length);for(let s=0;s<t.length;s++){let o=t[s];for(let t=0;t<e.length;t++){let i=e[t];r.set(s,t,this.get(o,i))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new A(this.rows,this.columns))}static copy(t,e){for(let[r,s,o]of t.entries())e.set(r,s,o);return e}sum(t){switch(t){case"row":return function(t){let e=x(t.rows);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[r]+=t.get(r,s);return e}(this);case"column":return function(t){let e=x(t.columns);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[s]+=t.get(r,s);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)e+=t.get(r,s);return e}(this);default:throw Error("invalid option: ".concat(t))}}product(t){switch(t){case"row":return function(t){let e=x(t.rows,1);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[r]*=t.get(r,s);return e}(this);case"column":return function(t){let e=x(t.columns,1);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[s]*=t.get(r,s);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)e*=t.get(r,s);return e}(this);default:throw Error("invalid option: ".concat(t))}}mean(t){let e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw Error("invalid option: ".concat(t))}}variance(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let{unbiased:r=!0,mean:s=this.mean(t)}=e;if("boolean"!=typeof r)throw TypeError("unbiased must be a boolean");switch(t){case"row":if(!l.isAnyArray(s))throw TypeError("mean must be an array");return function(t,e,r){let s=t.rows,o=t.columns,i=[];for(let n=0;n<s;n++){let s=0,h=0,l=0;for(let e=0;e<o;e++)s+=l=t.get(n,e)-r[n],h+=l*l;e?i.push((h-s*s/o)/(o-1)):i.push((h-s*s/o)/o)}return i}(this,r,s);case"column":if(!l.isAnyArray(s))throw TypeError("mean must be an array");return function(t,e,r){let s=t.rows,o=t.columns,i=[];for(let n=0;n<o;n++){let o=0,h=0,l=0;for(let e=0;e<s;e++)o+=l=t.get(e,n)-r[n],h+=l*l;e?i.push((h-o*o/s)/(s-1)):i.push((h-o*o/s)/s)}return i}(this,r,s);case void 0:if("number"!=typeof s)throw TypeError("mean must be a number");return function(t,e,r){let s=t.rows,o=t.columns,i=s*o,n=0,h=0,l=0;for(let e=0;e<s;e++)for(let s=0;s<o;s++)n+=l=t.get(e,s)-r,h+=l*l;return e?(h-n*n/i)/(i-1):(h-n*n/i)/i}(this,r,s);default:throw Error("invalid option: ".concat(t))}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);let r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let{center:r=this.mean(t)}=e;switch(t){case"row":if(!l.isAnyArray(r))throw TypeError("center must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)-e[r])}(this,r),this;case"column":if(!l.isAnyArray(r))throw TypeError("center must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)-e[s])}(this,r),this;case void 0:if("number"!=typeof r)throw TypeError("center must be a number");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)-e)}(this,r),this;default:throw Error("invalid option: ".concat(t))}}scale(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){let e=[];for(let r=0;r<t.rows;r++){let s=0;for(let e=0;e<t.columns;e++)s+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(s))}return e}(this);else if(!l.isAnyArray(r))throw TypeError("scale must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){let e=[];for(let r=0;r<t.columns;r++){let s=0;for(let e=0;e<t.rows;e++)s+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(s))}return e}(this);else if(!l.isAnyArray(r))throw TypeError("scale must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)/e[s])}(this,r),this;case void 0:if(void 0===r)r=function(t){let e=t.size-1,r=0;for(let s=0;s<t.columns;s++)for(let o=0;o<t.rows;o++)r+=Math.pow(t.get(o,s),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw TypeError("scale must be a number");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)/e)}(this,r),this;default:throw Error("invalid option: ".concat(t))}}toString(t){return f(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function R(t,e){return t-e}E.prototype.klass="Matrix","undefined"!=typeof Symbol&&(E.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return f(this)}),E.random=E.rand,E.randomInt=E.randInt,E.diagonal=E.diag,E.prototype.diagonal=E.prototype.diag,E.identity=E.eye,E.prototype.negate=E.prototype.neg,E.prototype.tensorProduct=E.prototype.kroneckerProduct;var k=new WeakSet;class A extends E{set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return m(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),m(this,t,!0),e=Float64Array.from(p(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){w(this,t);for(let e=0;e<this.rows;e++){let r=new Float64Array(this.columns-1);for(let s=0;s<t;s++)r[s]=this.data[e][s];for(let s=t+1;s<this.columns;s++)r[s-1]=this.data[e][s];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),w(this,t,!0),e=d(this,e);for(let r=0;r<this.rows;r++){let s=new Float64Array(this.columns+1),o=0;for(;o<t;o++)s[o]=this.data[r][o];for(s[o++]=e[r];o<this.columns+1;o++)s[o]=this.data[r][o-1];this.data[r]=s}return this.columns+=1,this}constructor(t,e){if(super(),h._(this,k),A.isMatrix(t))n._(this,k,I).call(this,t.rows,t.columns),A.copy(t,this);else if(Number.isInteger(t)&&t>=0)n._(this,k,I).call(this,t,e);else if(l.isAnyArray(t)){let r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw TypeError("Data must be a 2D array with at least one element");this.data=[];for(let s=0;s<t;s++){if(r[s].length!==e)throw RangeError("Inconsistent array dimensions");if(!r[s].every(t=>"number"==typeof t))throw TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[s]))}this.rows=t,this.columns=e}else throw TypeError("First argument must be a positive number or an array")}}function I(t,e){if(this.data=[],Number.isInteger(e)&&e>=0)for(let r=0;r<t;r++)this.data.push(new Float64Array(e));else throw TypeError("nColumns must be a positive integer");this.rows=t,this.columns=e}E.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},E.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},E.prototype.addM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},E.add=function(t,e){return new A(t).add(e)},E.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},E.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},E.prototype.subM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},E.sub=function(t,e){return new A(t).sub(e)},E.prototype.subtract=E.prototype.sub,E.prototype.subtractS=E.prototype.subS,E.prototype.subtractM=E.prototype.subM,E.subtract=E.sub,E.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},E.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},E.prototype.mulM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},E.mul=function(t,e){return new A(t).mul(e)},E.prototype.multiply=E.prototype.mul,E.prototype.multiplyS=E.prototype.mulS,E.prototype.multiplyM=E.prototype.mulM,E.multiply=E.mul,E.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},E.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},E.prototype.divM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},E.div=function(t,e){return new A(t).div(e)},E.prototype.divide=E.prototype.div,E.prototype.divideS=E.prototype.divS,E.prototype.divideM=E.prototype.divM,E.divide=E.div,E.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},E.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},E.prototype.modM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},E.mod=function(t,e){return new A(t).mod(e)},E.prototype.modulus=E.prototype.mod,E.prototype.modulusS=E.prototype.modS,E.prototype.modulusM=E.prototype.modM,E.modulus=E.mod,E.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},E.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},E.prototype.andM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},E.and=function(t,e){return new A(t).and(e)},E.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},E.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},E.prototype.orM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},E.or=function(t,e){return new A(t).or(e)},E.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},E.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},E.prototype.xorM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},E.xor=function(t,e){return new A(t).xor(e)},E.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},E.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},E.prototype.leftShiftM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},E.leftShift=function(t,e){return new A(t).leftShift(e)},E.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},E.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},E.prototype.signPropagatingRightShiftM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},E.signPropagatingRightShift=function(t,e){return new A(t).signPropagatingRightShift(e)},E.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},E.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},E.prototype.rightShiftM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},E.rightShift=function(t,e){return new A(t).rightShift(e)},E.prototype.zeroFillRightShift=E.prototype.rightShift,E.prototype.zeroFillRightShiftS=E.prototype.rightShiftS,E.prototype.zeroFillRightShiftM=E.prototype.rightShiftM,E.zeroFillRightShift=E.rightShift,E.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},E.not=function(t){return new A(t).not()},E.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},E.abs=function(t){return new A(t).abs()},E.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},E.acos=function(t){return new A(t).acos()},E.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},E.acosh=function(t){return new A(t).acosh()},E.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},E.asin=function(t){return new A(t).asin()},E.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},E.asinh=function(t){return new A(t).asinh()},E.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},E.atan=function(t){return new A(t).atan()},E.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},E.atanh=function(t){return new A(t).atanh()},E.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},E.cbrt=function(t){return new A(t).cbrt()},E.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},E.ceil=function(t){return new A(t).ceil()},E.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},E.clz32=function(t){return new A(t).clz32()},E.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},E.cos=function(t){return new A(t).cos()},E.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},E.cosh=function(t){return new A(t).cosh()},E.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},E.exp=function(t){return new A(t).exp()},E.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},E.expm1=function(t){return new A(t).expm1()},E.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},E.floor=function(t){return new A(t).floor()},E.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},E.fround=function(t){return new A(t).fround()},E.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},E.log=function(t){return new A(t).log()},E.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},E.log1p=function(t){return new A(t).log1p()},E.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},E.log10=function(t){return new A(t).log10()},E.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},E.log2=function(t){return new A(t).log2()},E.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},E.round=function(t){return new A(t).round()},E.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},E.sign=function(t){return new A(t).sign()},E.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},E.sin=function(t){return new A(t).sin()},E.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},E.sinh=function(t){return new A(t).sinh()},E.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},E.sqrt=function(t){return new A(t).sqrt()},E.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},E.tan=function(t){return new A(t).tan()},E.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},E.tanh=function(t){return new A(t).tanh()},E.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},E.trunc=function(t){return new A(t).trunc()},E.pow=function(t,e){return new A(t).pow(e)},E.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},E.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},E.prototype.powM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this};var N=new WeakMap;class T extends E{get size(){return s._(this,N).size}get rows(){return s._(this,N).rows}get columns(){return s._(this,N).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return A.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}clone(){let t=new T(this.diagonalSize);for(let[e,r,s]of this.upperRightEntries())t.set(e,r,s);return t}toMatrix(){return new A(this)}get(t,e){return s._(this,N).get(t,e)}set(t,e,r){return s._(this,N).set(t,e,r),s._(this,N).set(e,t,r),this}removeCross(t){return s._(this,N).removeRow(t),s._(this,N).removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);let r=e.slice();return r.splice(t,1),s._(this,N).addRow(t,r),s._(this,N).addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw RangeError("Mask size do not match with matrix size");let e=[];for(let[r,s]of t.entries())s||e.push(r);for(let t of(e.reverse(),e))this.removeCross(t);return this}toCompact(){let{diagonalSize:t}=this,e=Array(t*(t+1)/2);for(let r=0,s=0,o=0;o<e.length;o++)e[o]=this.get(s,r),++r>=t&&(r=++s);return e}static fromCompact(t){let e=t.length,r=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(r))throw TypeError("This array is not a compact representation of a Symmetric Matrix, ".concat(JSON.stringify(t)));let s=new T(r);for(let o=0,i=0,n=0;n<e;n++)s.set(o,i,t[n]),++o>=r&&(o=++i);return s}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;){let r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;){let r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}constructor(t){if(super(),o._(this,N,{writable:!0,value:void 0}),A.isMatrix(t)){if(!t.isSymmetric())throw TypeError("not symmetric data");i._(this,N,A.copy(t,new A(t.rows,t.rows)))}else if(Number.isInteger(t)&&t>=0)i._(this,N,new A(t,t));else if(i._(this,N,new A(t)),!this.isSymmetric())throw TypeError("not symmetric data")}}T.prototype.klassType="SymmetricMatrix";class V extends T{static isDistanceMatrix(t){return T.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new T(this)}clone(){let t=new V(this.diagonalSize);for(let[e,r,s]of this.upperRightEntries())e!==r&&t.set(e,r,s);return t}toCompact(){let{diagonalSize:t}=this,e=Array((t-1)*t/2);for(let r=1,s=0,o=0;o<e.length;o++)e[o]=this.get(s,r),++r>=t&&(r=++s+1);return e}static fromCompact(t){let e=t.length,r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw TypeError("This array is not a compact representation of a DistanceMatrix, ".concat(JSON.stringify(t)));let s=new this(r);for(let o=1,i=0,n=0;n<e;n++)s.set(o,i,t[n]),++o>=r&&(o=++i+1);return s}constructor(t){if(super(t),!this.isDistance())throw TypeError("Provided arguments do no produce a distance matrix")}}V.prototype.klassSubType="DistanceMatrix";class C extends E{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class q extends C{set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}constructor(t,e){w(t,e),super(t,t.rows,1),this.column=e}}class F extends C{set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}constructor(t,e){M(t,e),super(t,t.rows,e.length),this.columnIndices=e}}class D extends C{set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}constructor(t){super(t,t.rows,t.columns)}}class z extends C{set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}constructor(t){super(t,t.rows,t.columns)}}class _ extends C{set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}constructor(t,e){m(t,e),super(t,1,t.columns),this.row=e}}class j extends C{set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}constructor(t,e){y(t,e),super(t,e.length,t.columns),this.rowIndices=e}}class P extends C{set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}constructor(t,e,r){y(t,e),M(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}}class L extends C{set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}constructor(t,e,r,s,o){b(t,e,r,s,o),super(t,r-e+1,o-s+1),this.startRow=e,this.startColumn=s}}class U extends C{set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}constructor(t){super(t,t.columns,t.rows)}}class O extends E{set(t,e,r){let s=this._calculateIndex(t,e);return this.data[s]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}constructor(t,e={}){let{rows:r=1}=e;if(t.length%r!=0)throw Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}}class Q extends E{set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}}class W{isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){let e,r,s;t=A.checkMatrix(t);let o=this.LU;if(o.rows!==t.rows)throw Error("Invalid matrix dimensions");if(this.isSingular())throw Error("LU matrix is singular");let i=t.columns,n=t.subMatrixRow(this.pivotVector,0,i-1),h=o.columns;for(s=0;s<h;s++)for(e=s+1;e<h;e++)for(r=0;r<i;r++)n.set(e,r,n.get(e,r)-n.get(s,r)*o.get(e,s));for(s=h-1;s>=0;s--){for(r=0;r<i;r++)n.set(s,r,n.get(s,r)/o.get(s,s));for(e=0;e<s;e++)for(r=0;r<i;r++)n.set(e,r,n.get(e,r)-n.get(s,r)*o.get(e,s))}return n}get determinant(){let t=this.LU;if(!t.isSquare())throw Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let s=0;s<r;s++)e*=t.get(s,s);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,s=new A(e,r);for(let o=0;o<e;o++)for(let e=0;e<r;e++)o>e?s.set(o,e,t.get(o,e)):o===e?s.set(o,e,1):s.set(o,e,0);return s}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,s=new A(e,r);for(let o=0;o<e;o++)for(let e=0;e<r;e++)o<=e?s.set(o,e,t.get(o,e)):s.set(o,e,0);return s}get pivotPermutationVector(){return Array.from(this.pivotVector)}constructor(t){let e,r,s,o,i,n,h,l,u;let a=(t=Q.checkMatrix(t)).clone(),c=a.rows,f=a.columns,g=new Float64Array(c),m=1;for(e=0;e<c;e++)g[e]=e;for(r=0,l=new Float64Array(c);r<f;r++){for(e=0;e<c;e++)l[e]=a.get(e,r);for(e=0;e<c;e++){for(s=0,u=Math.min(e,r),i=0;s<u;s++)i+=a.get(e,s)*l[s];l[e]-=i,a.set(e,r,l[e])}for(o=r,e=r+1;e<c;e++)Math.abs(l[e])>Math.abs(l[o])&&(o=e);if(o!==r){for(s=0;s<f;s++)n=a.get(o,s),a.set(o,s,a.get(r,s)),a.set(r,s,n);h=g[o],g[o]=g[r],g[r]=h,m=-m}if(r<c&&0!==a.get(r,r))for(e=r+1;e<c;e++)a.set(e,r,a.get(e,r)/a.get(r,r))}this.LU=a,this.pivotVector=g,this.pivotSign=m}}function Y(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class J{solve(t){let e,r,s,o;t=A.checkMatrix(t);let i=this.QR,n=i.rows;if(t.rows!==n)throw Error("Matrix row dimensions must agree");if(!this.isFullRank())throw Error("Matrix is rank deficient");let h=t.columns,l=t.clone(),u=i.columns;for(s=0;s<u;s++)for(r=0;r<h;r++){for(o=0,e=s;e<n;e++)o+=i.get(e,s)*l.get(e,r);for(o=-o/i.get(s,s),e=s;e<n;e++)l.set(e,r,l.get(e,r)+o*i.get(e,s))}for(s=u-1;s>=0;s--){for(r=0;r<h;r++)l.set(s,r,l.get(s,r)/this.Rdiag[s]);for(e=0;e<s;e++)for(r=0;r<h;r++)l.set(e,r,l.get(e,r)-l.get(s,r)*i.get(e,s))}return l.subMatrix(0,u-1,0,h-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,s=r.columns,o=new A(s,s);for(t=0;t<s;t++)for(e=0;e<s;e++)t<e?o.set(t,e,r.get(t,e)):t===e?o.set(t,e,this.Rdiag[t]):o.set(t,e,0);return o}get orthogonalMatrix(){let t,e,r,s,o=this.QR,i=o.rows,n=o.columns,h=new A(i,n);for(r=n-1;r>=0;r--){for(t=0;t<i;t++)h.set(t,r,0);for(h.set(r,r,1),e=r;e<n;e++)if(0!==o.get(r,r)){for(s=0,t=r;t<i;t++)s+=o.get(t,r)*h.get(t,e);for(s=-s/o.get(r,r),t=r;t<i;t++)h.set(t,e,h.get(t,e)+s*o.get(t,r))}}return h}constructor(t){let e,r,s,o;let i=(t=Q.checkMatrix(t)).clone(),n=t.rows,h=t.columns,l=new Float64Array(h);for(s=0;s<h;s++){let t=0;for(e=s;e<n;e++)t=Y(t,i.get(e,s));if(0!==t){for(0>i.get(s,s)&&(t=-t),e=s;e<n;e++)i.set(e,s,i.get(e,s)/t);for(i.set(s,s,i.get(s,s)+1),r=s+1;r<h;r++){for(o=0,e=s;e<n;e++)o+=i.get(e,s)*i.get(e,r);for(o=-o/i.get(s,s),e=s;e<n;e++)i.set(e,r,i.get(e,r)+o*i.get(e,s))}}l[s]=-t}this.QR=i,this.Rdiag=l}}class B{solve(t){let e=this.threshold,r=this.s.length,s=A.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=e?s.set(t,t,0):s.set(t,t,1/this.s[t]);let o=this.U,i=this.rightSingularVectors,n=i.mmul(s),h=i.rows,l=o.rows,u=A.zeros(h,l);for(let t=0;t<h;t++)for(let e=0;e<l;e++){let s=0;for(let i=0;i<r;i++)s+=n.get(t,i)*o.get(e,i);u.set(t,e,s)}return u.mmul(t)}solveForDiagonal(t){return this.solve(A.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,s=t.columns,o=new A(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<s;r++)Math.abs(this.s[r])>e&&o.set(i,r,t.get(i,r)/this.s[r]);let i=this.U,n=i.rows,h=i.columns,l=new A(r,n);for(let t=0;t<r;t++)for(let e=0;e<n;e++){let r=0;for(let s=0;s<h;s++)r+=o.get(t,s)*i.get(e,s);l.set(t,e,r)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let s=0,o=r.length;s<o;s++)r[s]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return A.diag(this.s)}constructor(t,e={}){let r;if((t=Q.checkMatrix(t)).isEmpty())throw Error("Matrix must be non-empty");let s=t.rows,o=t.columns,{computeLeftSingularVectors:i=!0,computeRightSingularVectors:n=!0,autoTranspose:h=!1}=e,l=!!i,u=!!n,a=!1;if(s<o){if(h){s=(r=t.transpose()).rows,o=r.columns,a=!0;let e=l;l=u,u=e}else r=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose")}else r=t.clone();let c=Math.min(s,o),f=Math.min(s+1,o),g=new Float64Array(f),m=new A(s,c),w=new A(o,o),p=new Float64Array(o),d=new Float64Array(s),y=new Float64Array(f);for(let t=0;t<f;t++)y[t]=t;let M=Math.min(s-1,o),b=Math.max(0,Math.min(o-2,s)),x=Math.max(M,b);for(let t=0;t<x;t++){if(t<M){g[t]=0;for(let e=t;e<s;e++)g[t]=Y(g[t],r.get(e,t));if(0!==g[t]){0>r.get(t,t)&&(g[t]=-g[t]);for(let e=t;e<s;e++)r.set(e,t,r.get(e,t)/g[t]);r.set(t,t,r.get(t,t)+1)}g[t]=-g[t]}for(let e=t+1;e<o;e++){if(t<M&&0!==g[t]){let o=0;for(let i=t;i<s;i++)o+=r.get(i,t)*r.get(i,e);o=-o/r.get(t,t);for(let i=t;i<s;i++)r.set(i,e,r.get(i,e)+o*r.get(i,t))}p[e]=r.get(t,e)}if(l&&t<M)for(let e=t;e<s;e++)m.set(e,t,r.get(e,t));if(t<b){p[t]=0;for(let e=t+1;e<o;e++)p[t]=Y(p[t],p[e]);if(0!==p[t]){p[t+1]<0&&(p[t]=0-p[t]);for(let e=t+1;e<o;e++)p[e]/=p[t];p[t+1]+=1}if(p[t]=-p[t],t+1<s&&0!==p[t]){for(let e=t+1;e<s;e++)d[e]=0;for(let e=t+1;e<s;e++)for(let s=t+1;s<o;s++)d[e]+=p[s]*r.get(e,s);for(let e=t+1;e<o;e++){let o=-p[e]/p[t+1];for(let i=t+1;i<s;i++)r.set(i,e,r.get(i,e)+o*d[i])}}if(u)for(let e=t+1;e<o;e++)w.set(e,t,p[e])}}let v=Math.min(o,s+1);if(M<o&&(g[M]=r.get(M,M)),s<v&&(g[v-1]=0),b+1<v&&(p[b]=r.get(b,v-1)),p[v-1]=0,l){for(let t=M;t<c;t++){for(let e=0;e<s;e++)m.set(e,t,0);m.set(t,t,1)}for(let t=M-1;t>=0;t--)if(0!==g[t]){for(let e=t+1;e<c;e++){let r=0;for(let o=t;o<s;o++)r+=m.get(o,t)*m.get(o,e);r=-r/m.get(t,t);for(let o=t;o<s;o++)m.set(o,e,m.get(o,e)+r*m.get(o,t))}for(let e=t;e<s;e++)m.set(e,t,-m.get(e,t));m.set(t,t,1+m.get(t,t));for(let e=0;e<t-1;e++)m.set(e,t,0)}else{for(let e=0;e<s;e++)m.set(e,t,0);m.set(t,t,1)}}if(u)for(let t=o-1;t>=0;t--){if(t<b&&0!==p[t])for(let e=t+1;e<o;e++){let r=0;for(let s=t+1;s<o;s++)r+=w.get(s,t)*w.get(s,e);r=-r/w.get(t+1,t);for(let s=t+1;s<o;s++)w.set(s,e,w.get(s,e)+r*w.get(s,t))}for(let e=0;e<o;e++)w.set(e,t,0);w.set(t,t,1)}let S=v-1,E=Number.EPSILON;for(;v>0;){let t,e;for(t=v-2;t>=-1&&-1!==t;t--){let e=Number.MIN_VALUE+E*Math.abs(g[t]+Math.abs(g[t+1]));if(Math.abs(p[t])<=e||Number.isNaN(p[t])){p[t]=0;break}}if(t===v-2)e=4;else{let r;for(r=v-1;r>=t&&r!==t;r--){let e=(r!==v?Math.abs(p[r]):0)+(r!==t+1?Math.abs(p[r-1]):0);if(Math.abs(g[r])<=E*e){g[r]=0;break}}r===t?e=3:r===v-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=p[v-2];p[v-2]=0;for(let r=v-2;r>=t;r--){let s=Y(g[r],e),i=g[r]/s,n=e/s;if(g[r]=s,r!==t&&(e=-n*p[r-1],p[r-1]=i*p[r-1]),u)for(let t=0;t<o;t++)s=i*w.get(t,r)+n*w.get(t,v-1),w.set(t,v-1,-n*w.get(t,r)+i*w.get(t,v-1)),w.set(t,r,s)}break}case 2:{let e=p[t-1];p[t-1]=0;for(let r=t;r<v;r++){let o=Y(g[r],e),i=g[r]/o,n=e/o;if(g[r]=o,e=-n*p[r],p[r]=i*p[r],l)for(let e=0;e<s;e++)o=i*m.get(e,r)+n*m.get(e,t-1),m.set(e,t-1,-n*m.get(e,r)+i*m.get(e,t-1)),m.set(e,r,o)}break}case 3:{let e=Math.max(Math.abs(g[v-1]),Math.abs(g[v-2]),Math.abs(p[v-2]),Math.abs(g[t]),Math.abs(p[t])),r=g[v-1]/e,i=g[v-2]/e,n=p[v-2]/e,h=g[t]/e,a=p[t]/e,c=((i+r)*(i-r)+n*n)/2,f=r*n*(r*n),d=0;(0!==c||0!==f)&&(d=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),d=f/(c+d));let y=(h+r)*(h-r)+d,M=h*a;for(let e=t;e<v-1;e++){let r=Y(y,M);0===r&&(r=Number.MIN_VALUE);let i=y/r,n=M/r;if(e!==t&&(p[e-1]=r),y=i*g[e]+n*p[e],p[e]=i*p[e]-n*g[e],M=n*g[e+1],g[e+1]=i*g[e+1],u)for(let t=0;t<o;t++)r=i*w.get(t,e)+n*w.get(t,e+1),w.set(t,e+1,-n*w.get(t,e)+i*w.get(t,e+1)),w.set(t,e,r);if(0===(r=Y(y,M))&&(r=Number.MIN_VALUE),i=y/r,n=M/r,g[e]=r,y=i*p[e]+n*g[e+1],g[e+1]=-n*p[e]+i*g[e+1],M=n*p[e+1],p[e+1]=i*p[e+1],l&&e<s-1)for(let t=0;t<s;t++)r=i*m.get(t,e)+n*m.get(t,e+1),m.set(t,e+1,-n*m.get(t,e)+i*m.get(t,e+1)),m.set(t,e,r)}p[v-2]=y;break}case 4:if(g[t]<=0&&(g[t]=g[t]<0?-g[t]:0,u))for(let e=0;e<=S;e++)w.set(e,t,-w.get(e,t));for(;t<S&&!(g[t]>=g[t+1]);){let e=g[t];if(g[t]=g[t+1],g[t+1]=e,u&&t<o-1)for(let r=0;r<o;r++)e=w.get(r,t+1),w.set(r,t+1,w.get(r,t)),w.set(r,t,e);if(l&&t<s-1)for(let r=0;r<s;r++)e=m.get(r,t+1),m.set(r,t+1,m.get(r,t)),m.set(r,t,e);t++}v--}}if(a){let t=w;w=m,m=t}this.m=s,this.n=o,this.s=g,this.U=m,this.V=w}}function G(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(t=Q.checkMatrix(t),e=Q.checkMatrix(e),r)?new B(t).solve(e):t.isSquare()?new W(t).solve(e):new J(t).solve(e)}class H{get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,s=this.e,o=this.d,i=new A(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)i.set(t,e,0);i.set(t,t,o[t]),s[t]>0?i.set(t,t+1,s[t]):s[t]<0&&i.set(t,t-1,s[t])}return i}constructor(t,e={}){let r,s;let{assumeSymmetric:o=!1}=e;if(!(t=Q.checkMatrix(t)).isSquare())throw Error("Matrix is not a square matrix");if(t.isEmpty())throw Error("Matrix must be non-empty");let i=t.columns,n=new A(i,i),h=new Float64Array(i),l=new Float64Array(i),u=t;if(o||t.isSymmetric()){for(r=0;r<i;r++)for(s=0;s<i;s++)n.set(r,s,u.get(r,s));(function(t,e,r,s){let o,i,n,h,l,u,a,c;for(l=0;l<t;l++)r[l]=s.get(t-1,l);for(h=t-1;h>0;h--){for(u=0,c=0,n=0;u<h;u++)c+=Math.abs(r[u]);if(0===c)for(l=0,e[h]=r[h-1];l<h;l++)r[l]=s.get(h-1,l),s.set(h,l,0),s.set(l,h,0);else{for(u=0;u<h;u++)r[u]/=c,n+=r[u]*r[u];for(o=r[h-1],i=Math.sqrt(n),o>0&&(i=-i),e[h]=c*i,n-=o*i,r[h-1]=o-i,l=0;l<h;l++)e[l]=0;for(l=0;l<h;l++){for(o=r[l],s.set(l,h,o),i=e[l]+s.get(l,l)*o,u=l+1;u<=h-1;u++)i+=s.get(u,l)*r[u],e[u]+=s.get(u,l)*o;e[l]=i}for(l=0,o=0;l<h;l++)e[l]/=n,o+=e[l]*r[l];for(l=0,a=o/(n+n);l<h;l++)e[l]-=a*r[l];for(l=0;l<h;l++){for(o=r[l],i=e[l],u=l;u<=h-1;u++)s.set(u,l,s.get(u,l)-(o*e[u]+i*r[u]));r[l]=s.get(h-1,l),s.set(h,l,0)}}r[h]=n}for(h=0;h<t-1;h++){if(s.set(t-1,h,s.get(h,h)),s.set(h,h,1),0!==(n=r[h+1])){for(u=0;u<=h;u++)r[u]=s.get(u,h+1)/n;for(l=0;l<=h;l++){for(u=0,i=0;u<=h;u++)i+=s.get(u,h+1)*s.get(u,l);for(u=0;u<=h;u++)s.set(u,l,s.get(u,l)-i*r[u])}}for(u=0;u<=h;u++)s.set(u,h+1,0)}for(l=0;l<t;l++)r[l]=s.get(t-1,l),s.set(t-1,l,0);s.set(t-1,t-1,1),e[0]=0})(i,l,h,n),function(t,e,r,s){let o,i,n,h,l,u,a,c,f,g,m,w,p,d,y,M;for(n=1;n<t;n++)e[n-1]=e[n];e[t-1]=0;let b=0,x=0,v=Number.EPSILON;for(u=0;u<t;u++){for(x=Math.max(x,Math.abs(r[u])+Math.abs(e[u])),a=u;a<t&&!(Math.abs(e[a])<=v*x);)a++;if(a>u)do{for(o=r[u],f=Y(c=(r[u+1]-o)/(2*e[u]),1),c<0&&(f=-f),r[u]=e[u]/(c+f),r[u+1]=e[u]*(c+f),g=r[u+1],i=o-r[u],n=u+2;n<t;n++)r[n]-=i;for(b+=i,c=r[a],w=m=1,p=m,d=e[u+1],y=0,M=0,n=a-1;n>=u;n--)for(l=0,p=w,w=m,M=y,o=m*e[n],i=m*c,f=Y(c,e[n]),e[n+1]=y*f,y=e[n]/f,c=(m=c/f)*r[n]-y*o,r[n+1]=i+y*(m*o+y*r[n]);l<t;l++)i=s.get(l,n+1),s.set(l,n+1,y*s.get(l,n)+m*i),s.set(l,n,m*s.get(l,n)-y*i);c=-y*M*p*d*e[u]/g,e[u]=y*c,r[u]=m*c}while(Math.abs(e[u])>v*x);r[u]=r[u]+b,e[u]=0}for(n=0;n<t-1;n++){for(l=n,c=r[n],h=n+1;h<t;h++)r[h]<c&&(l=h,c=r[h]);if(l!==n)for(h=0,r[l]=r[n],r[n]=c;h<t;h++)c=s.get(h,n),s.set(h,n,s.get(h,l)),s.set(h,l,c)}}(i,l,h,n)}else{let t=new A(i,i),e=new Float64Array(i);for(s=0;s<i;s++)for(r=0;r<i;r++)t.set(r,s,u.get(r,s));(function(t,e,r,s){let o,i,n,h,l,u,a;let c=t-1;for(u=1;u<=c-1;u++){for(a=0,h=u;h<=c;h++)a+=Math.abs(e.get(h,u-1));if(0!==a){for(n=0,h=c;h>=u;h--)r[h]=e.get(h,u-1)/a,n+=r[h]*r[h];for(i=Math.sqrt(n),r[u]>0&&(i=-i),n-=r[u]*i,r[u]=r[u]-i,l=u;l<t;l++){for(o=0,h=c;h>=u;h--)o+=r[h]*e.get(h,l);for(o/=n,h=u;h<=c;h++)e.set(h,l,e.get(h,l)-o*r[h])}for(h=0;h<=c;h++){for(o=0,l=c;l>=u;l--)o+=r[l]*e.get(h,l);for(o/=n,l=u;l<=c;l++)e.set(h,l,e.get(h,l)-o*r[l])}r[u]=a*r[u],e.set(u,u-1,a*i)}}for(h=0;h<t;h++)for(l=0;l<t;l++)s.set(h,l,h===l?1:0);for(u=c-1;u>=1;u--)if(0!==e.get(u,u-1)){for(h=u+1;h<=c;h++)r[h]=e.get(h,u-1);for(l=u;l<=c;l++){for(i=0,h=u;h<=c;h++)i+=r[h]*s.get(h,l);for(i=i/r[u]/e.get(u,u-1),h=u;h<=c;h++)s.set(h,l,s.get(h,l)+i*r[h])}}})(i,t,e,n),function(t,e,r,s,o){let i,n,h,l,u,a,c,f,g,m,w,p,d,y,M,b=t-1,x=t-1,v=Number.EPSILON,S=0,E=0,R=0,k=0,A=0,I=0,N=0,T=0;for(i=0;i<t;i++)for((i<0||i>x)&&(r[i]=o.get(i,i),e[i]=0),n=Math.max(i-1,0);n<t;n++)E+=Math.abs(o.get(i,n));for(;b>=0;){for(l=b;l>0&&(0===(I=Math.abs(o.get(l-1,l-1))+Math.abs(o.get(l,l)))&&(I=E),!(Math.abs(o.get(l,l-1))<v*I));)l--;if(l===b)o.set(b,b,o.get(b,b)+S),r[b]=o.get(b,b),e[b]=0,b--,T=0;else if(l===b-1){if(c=o.get(b,b-1)*o.get(b-1,b),N=Math.sqrt(Math.abs(k=(R=(o.get(b-1,b-1)-o.get(b,b))/2)*R+c)),o.set(b,b,o.get(b,b)+S),o.set(b-1,b-1,o.get(b-1,b-1)+S),f=o.get(b,b),k>=0){for(N=R>=0?R+N:R-N,r[b-1]=f+N,r[b]=r[b-1],0!==N&&(r[b]=f-c/N),e[b-1]=0,e[b]=0,I=Math.abs(f=o.get(b,b-1))+Math.abs(N),A=Math.sqrt((R=f/I)*R+(k=N/I)*k),R/=A,k/=A,n=b-1;n<t;n++)N=o.get(b-1,n),o.set(b-1,n,k*N+R*o.get(b,n)),o.set(b,n,k*o.get(b,n)-R*N);for(i=0;i<=b;i++)N=o.get(i,b-1),o.set(i,b-1,k*N+R*o.get(i,b)),o.set(i,b,k*o.get(i,b)-R*N);for(i=0;i<=x;i++)N=s.get(i,b-1),s.set(i,b-1,k*N+R*s.get(i,b)),s.set(i,b,k*s.get(i,b)-R*N)}else r[b-1]=f+R,r[b]=f+R,e[b-1]=N,e[b]=-N;b-=2,T=0}else{if(f=o.get(b,b),g=0,c=0,l<b&&(g=o.get(b-1,b-1),c=o.get(b,b-1)*o.get(b-1,b)),10===T){for(S+=f,i=0;i<=b;i++)o.set(i,i,o.get(i,i)-f);f=g=.75*(I=Math.abs(o.get(b,b-1))+Math.abs(o.get(b-1,b-2))),c=-.4375*I*I}if(30===T&&(I=(I=(g-f)/2)*I+c)>0){for(I=Math.sqrt(I),g<f&&(I=-I),I=f-c/((g-f)/2+I),i=0;i<=b;i++)o.set(i,i,o.get(i,i)-I);S+=I,f=g=c=.964}for(T+=1,u=b-2;u>=l&&(I=Math.abs(R=((A=f-(N=o.get(u,u)))*(I=g-N)-c)/o.get(u+1,u)+o.get(u,u+1))+Math.abs(k=o.get(u+1,u+1)-N-A-I)+Math.abs(A=o.get(u+2,u+1)),R/=I,k/=I,A/=I,!(u===l||Math.abs(o.get(u,u-1))*(Math.abs(k)+Math.abs(A))<Math.abs(R)*(Math.abs(o.get(u-1,u-1))+Math.abs(N)+Math.abs(o.get(u+1,u+1)))*v));)u--;for(i=u+2;i<=b;i++)o.set(i,i-2,0),i>u+2&&o.set(i,i-3,0);for(h=u;h<=b-1&&(y=h!==b-1,h!==u&&0!==(f=Math.abs(R=o.get(h,h-1))+Math.abs(k=o.get(h+1,h-1))+Math.abs(A=y?o.get(h+2,h-1):0))&&(R/=f,k/=f,A/=f),0!==f);h++)if(I=Math.sqrt(R*R+k*k+A*A),R<0&&(I=-I),0!==I){for(h!==u?o.set(h,h-1,-I*f):l!==u&&o.set(h,h-1,-o.get(h,h-1)),R+=I,f=R/I,g=k/I,N=A/I,k/=R,A/=R,n=h;n<t;n++)R=o.get(h,n)+k*o.get(h+1,n),y&&(R+=A*o.get(h+2,n),o.set(h+2,n,o.get(h+2,n)-R*N)),o.set(h,n,o.get(h,n)-R*f),o.set(h+1,n,o.get(h+1,n)-R*g);for(i=0;i<=Math.min(b,h+3);i++)R=f*o.get(i,h)+g*o.get(i,h+1),y&&(R+=N*o.get(i,h+2),o.set(i,h+2,o.get(i,h+2)-R*A)),o.set(i,h,o.get(i,h)-R),o.set(i,h+1,o.get(i,h+1)-R*k);for(i=0;i<=x;i++)R=f*s.get(i,h)+g*s.get(i,h+1),y&&(R+=N*s.get(i,h+2),s.set(i,h+2,s.get(i,h+2)-R*A)),s.set(i,h,s.get(i,h)-R),s.set(i,h+1,s.get(i,h+1)-R*k)}}}if(0!==E){for(b=t-1;b>=0;b--)if(R=r[b],0===(k=e[b]))for(l=b,o.set(b,b,1),i=b-1;i>=0;i--){for(c=o.get(i,i)-R,A=0,n=l;n<=b;n++)A+=o.get(i,n)*o.get(n,b);if(e[i]<0)N=c,I=A;else if(l=i,0===e[i]?o.set(i,b,0!==c?-A/c:-A/(v*E)):(f=o.get(i,i+1),g=o.get(i+1,i),a=(f*I-N*A)/(k=(r[i]-R)*(r[i]-R)+e[i]*e[i]),o.set(i,b,a),o.set(i+1,b,Math.abs(f)>Math.abs(N)?(-A-c*a)/f:(-I-g*a)/N)),v*(a=Math.abs(o.get(i,b)))*a>1)for(n=i;n<=b;n++)o.set(n,b,o.get(n,b)/a)}else if(k<0)for(l=b-1,Math.abs(o.get(b,b-1))>Math.abs(o.get(b-1,b))?(o.set(b-1,b-1,k/o.get(b,b-1)),o.set(b-1,b,-(o.get(b,b)-R)/o.get(b,b-1))):(M=K(0,-o.get(b-1,b),o.get(b-1,b-1)-R,k),o.set(b-1,b-1,M[0]),o.set(b-1,b,M[1])),o.set(b,b-1,0),o.set(b,b,1),i=b-2;i>=0;i--){for(m=0,w=0,n=l;n<=b;n++)m+=o.get(i,n)*o.get(n,b-1),w+=o.get(i,n)*o.get(n,b);if(c=o.get(i,i)-R,e[i]<0)N=c,A=m,I=w;else if(l=i,0===e[i]?(M=K(-m,-w,c,k),o.set(i,b-1,M[0]),o.set(i,b,M[1])):(f=o.get(i,i+1),g=o.get(i+1,i),p=(r[i]-R)*(r[i]-R)+e[i]*e[i]-k*k,d=(r[i]-R)*2*k,0===p&&0===d&&(p=v*E*(Math.abs(c)+Math.abs(k)+Math.abs(f)+Math.abs(g)+Math.abs(N))),M=K(f*A-N*m+k*w,f*I-N*w-k*m,p,d),o.set(i,b-1,M[0]),o.set(i,b,M[1]),Math.abs(f)>Math.abs(N)+Math.abs(k)?(o.set(i+1,b-1,(-m-c*o.get(i,b-1)+k*o.get(i,b))/f),o.set(i+1,b,(-w-c*o.get(i,b)-k*o.get(i,b-1))/f)):(M=K(-A-g*o.get(i,b-1),-I-g*o.get(i,b),N,k),o.set(i+1,b-1,M[0]),o.set(i+1,b,M[1]))),v*(a=Math.max(Math.abs(o.get(i,b-1)),Math.abs(o.get(i,b))))*a>1)for(n=i;n<=b;n++)o.set(n,b-1,o.get(n,b-1)/a),o.set(n,b,o.get(n,b)/a)}for(i=0;i<t;i++)if(i<0||i>x)for(n=i;n<t;n++)s.set(i,n,o.get(i,n));for(n=t-1;n>=0;n--)for(i=0;i<=x;i++){for(h=0,N=0;h<=Math.min(n,x);h++)N+=s.get(i,h)*o.get(h,n);s.set(i,n,N)}}}(i,l,h,n,t)}this.n=i,this.e=l,this.d=h,this.V=n}}function K(t,e,r,s){let o,i;return Math.abs(r)>Math.abs(s)?(o=s/r,i=r+o*s,[(t+o*e)/i,(e-o*t)/i]):(o=r/s,i=s+o*r,[(o*t+e)/i,(o*e-t)/i])}class X{isPositiveDefinite(){return this.positiveDefinite}solve(t){let e,r,s;t=Q.checkMatrix(t);let o=this.L,i=o.rows;if(t.rows!==i)throw Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw Error("Matrix is not positive definite");let n=t.columns,h=t.clone();for(s=0;s<i;s++)for(r=0;r<n;r++){for(e=0;e<s;e++)h.set(s,r,h.get(s,r)-h.get(e,r)*o.get(s,e));h.set(s,r,h.get(s,r)/o.get(s,s))}for(s=i-1;s>=0;s--)for(r=0;r<n;r++){for(e=s+1;e<i;e++)h.set(s,r,h.get(s,r)-h.get(e,r)*o.get(e,s));h.set(s,r,h.get(s,r)/o.get(s,s))}return h}get lowerTriangularMatrix(){return this.L}constructor(t){let e,r,s;if(!(t=Q.checkMatrix(t)).isSymmetric())throw Error("Matrix is not symmetric");let o=t,i=o.rows,n=new A(i,i),h=!0;for(r=0;r<i;r++){let t=0;for(s=0;s<r;s++){let i=0;for(e=0;e<s;e++)i+=n.get(s,e)*n.get(r,e);i=(o.get(r,s)-i)/n.get(s,s),n.set(r,s,i),t+=i*i}for(h&=(t=o.get(r,r)-t)>0,n.set(r,r,Math.sqrt(Math.max(t,0))),s=r+1;s<i;s++)n.set(r,s,0)}this.L=n,this.positiveDefinite=!!h}}class Z{constructor(t,e={}){let r,s,o,i,n;t=Q.checkMatrix(t);let{Y:h}=e,{scaleScores:u=!1,maxIterations:a=1e3,terminationCriteria:c=1e-10}=e;if(h){if((h=l.isAnyArray(h)&&"number"==typeof h[0]?A.columnVector(h):Q.checkMatrix(h)).rows!==t.rows)throw Error("Y should have the same number of rows as X");r=h.getColumnVector(0)}else r=t.getColumnVector(0);let f=1;for(let e=0;e<a&&f>c;e++)i=(i=t.transpose().mmul(r).div(r.transpose().mmul(r).get(0,0))).div(i.norm()),s=t.mmul(i).div(i.transpose().mmul(i).get(0,0)),e>0&&(f=s.clone().sub(n).pow(2).sum()),n=s.clone(),h?(o=(o=h.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0))).div(o.norm()),r=h.mmul(o).div(o.transpose().mmul(o).get(0,0))):r=s;if(h){let e=t.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0));e=e.div(e.norm());let n=t.clone().sub(s.clone().mmul(e.transpose())),l=r.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),u=h.clone().sub(s.clone().mulS(l.get(0,0)).mmul(o.transpose()));this.t=s,this.p=e.transpose(),this.w=i.transpose(),this.q=o,this.u=r,this.s=s.transpose().mmul(s),this.xResidual=n,this.yResidual=u,this.betas=l}else this.w=i.transpose(),this.s=s.transpose().mmul(s).sqrt(),u?this.t=s.clone().div(this.s.get(0,0)):this.t=s,this.xResidual=t.sub(s.mmul(i.transpose()))}}e.AbstractMatrix=E,e.CHO=X,e.CholeskyDecomposition=X,e.DistanceMatrix=V,e.EVD=H,e.EigenvalueDecomposition=H,e.LU=W,e.LuDecomposition=W,e.Matrix=A,e.MatrixColumnSelectionView=F,e.MatrixColumnView=q,e.MatrixFlipColumnView=D,e.MatrixFlipRowView=z,e.MatrixRowSelectionView=j,e.MatrixRowView=_,e.MatrixSelectionView=P,e.MatrixSubView=L,e.MatrixTransposeView=U,e.NIPALS=Z,e.Nipals=Z,e.QR=J,e.QrDecomposition=J,e.SVD=B,e.SingularValueDecomposition=B,e.SymmetricMatrix=T,e.WrapperMatrix1D=O,e.WrapperMatrix2D=Q,e.correlation=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=new A(t);let s=!1;if("object"!=typeof e||A.isMatrix(e)||l.isAnyArray(e)?e=new A(e):(r=e,e=t,s=!0),t.rows!==e.rows)throw TypeError("Both matrices must have the same number of rows");let{center:o=!0,scale:i=!0}=r;o&&(t.center("column"),s||e.center("column")),i&&(t.scale("column"),s||e.scale("column"));let n=t.standardDeviation("column",{unbiased:!0}),h=s?n:e.standardDeviation("column",{unbiased:!0}),u=t.transpose().mmul(e);for(let e=0;e<u.rows;e++)for(let r=0;r<u.columns;r++)u.set(e,r,u.get(e,r)*(1/(n[e]*h[r]))*(1/(t.rows-1)));return u},e.covariance=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=new A(t);let s=!1;if("object"!=typeof e||A.isMatrix(e)||l.isAnyArray(e)?e=new A(e):(r=e,e=t,s=!0),t.rows!==e.rows)throw TypeError("Both matrices must have the same number of rows");let{center:o=!0}=r;o&&(t=t.center("column"),s||(e=e.center("column")));let i=t.transpose().mmul(e);for(let e=0;e<i.rows;e++)for(let r=0;r<i.columns;r++)i.set(e,r,i.get(e,r)*(1/(t.rows-1)));return i},e.default=A,e.determinant=function t(e){if((e=A.checkMatrix(e)).isSquare()){let r,s,o;if(0===e.columns)return 1;if(2===e.columns)return r=e.get(0,0),s=e.get(0,1),o=e.get(1,0),r*e.get(1,1)-s*o;if(3!==e.columns)return new W(e).determinant;{let i,n,h;return i=new P(e,[1,2],[1,2]),n=new P(e,[1,2],[0,2]),h=new P(e,[1,2],[0,1]),r=e.get(0,0),s=e.get(0,1),o=e.get(0,2),r*t(i)-s*t(n)+o*t(h)}}throw Error("determinant can only be calculated for a square matrix")},e.inverse=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(t=Q.checkMatrix(t),e)?new B(t).inverse():G(t,A.eye(t.rows))},e.linearDependencies=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{thresholdValue:r=1e-9,thresholdError:s=1e-9}=e,o=(t=A.checkMatrix(t)).rows,i=new A(o,o);for(let e=0;e<o;e++){let n=A.columnVector(t.getRow(e)),h=t.subMatrixRow(function(t,e){let r=[];for(let s=0;s<t;s++)s!==e&&r.push(s);return r}(o,e)).transpose(),l=new B(h).solve(n),u=A.sub(n,h.mmul(l)).abs().max();i.setRow(e,function(t,e,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-9,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-9;if(t>o)return Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<s&&t.set(e,0,0);return t.to1DArray()}}(u,l,e,r,s))}return i},e.pseudoInverse=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.EPSILON;if((t=A.checkMatrix(t)).isEmpty())return t.transpose();let r=new B(t,{autoTranspose:!0}),s=r.leftSingularVectors,o=r.rightSingularVectors,i=r.diagonal;for(let t=0;t<i.length;t++)Math.abs(i[t])>e?i[t]=1/i[t]:i[t]=0;return o.mmul(A.diag(i).mmul(s.transpose()))},e.solve=G,e.wrap=function(t,e){if(l.isAnyArray(t))return t[0]&&l.isAnyArray(t[0])?new Q(t):new O(t,e);throw Error("the argument is not an array")}}}]);