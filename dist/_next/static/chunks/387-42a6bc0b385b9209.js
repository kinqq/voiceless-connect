(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[387],{2727:function(t,e,r){"use strict";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var n=function(t,e,r,n){function i(t){return t instanceof r?t:new r(function(e){e(t)})}return new(r||(r=Promise))(function(r,o){function a(t){try{h(n.next(t))}catch(t){o(t)}}function s(t){try{h(n.throw(t))}catch(t){o(t)}}function h(t){t.done?r(t.value):i(t.value).then(a,s)}h((n=n.apply(t,e||[])).next())})},i=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return h([t,e])}}function h(o){if(r)throw TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.loadFromFiles=e.load=e.loadTruncatedMobileNet=e.CustomMobileNet=e.getTopKClasses=e.IMAGE_SIZE=void 0;var o=r(4080),a=r(4080),s=r(7279),h=r(2880),l=r(9303),u=1,c="conv_pw_13_relu",f="out_relu",d=.25,p=.35;e.IMAGE_SIZE=224;var m=function(t){return t.packageVersion=t.packageVersion||l.version,t.packageName=t.packageName||"@teachablemachine/image",t.timeStamp=t.timeStamp||new Date().toISOString(),t.userMetadata=t.userMetadata||{},t.modelName=t.modelName||"untitled",t.labels=t.labels||[],t.imageSize=t.imageSize||e.IMAGE_SIZE,t},g=function(t){return!!t&&Array.isArray(t.labels)},v=function(t,e){if(1===t){if(.25!==e&&.5!==e&&.75!==e&&1!==e)return console.warn("Invalid alpha. Options are: 0.25, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",d.toFixed(2)),d}else if(.35!==e&&.5!==e&&.75!==e&&1!==e)return console.warn("Invalid alpha. Options are: 0.35, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",p.toFixed(2)),p;return e},y=function(t){if((t=t||{}).checkpointUrl&&t.trainingLayer)return(t.alpha||t.version)&&console.warn("Checkpoint URL passed to modelOptions, alpha options are ignored"),[t.checkpointUrl,t.trainingLayer];if(t.version=t.version||u,1===t.version){t.alpha=t.alpha||d,t.alpha=v(t.version,t.alpha),console.log("Loading mobilenet "+t.version+" and alpha "+t.alpha);var r=t.alpha.toFixed(2);return"1.00"===r&&(r="1.0"),["https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_"+r+"_"+e.IMAGE_SIZE+"/model.json",c]}if(2===t.version)return t.alpha=t.alpha||p,t.alpha=v(t.version,t.alpha),console.log("Loading mobilenet "+t.version+" and alpha "+t.alpha),["https://storage.googleapis.com/teachable-machine-models/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_"+t.alpha.toFixed(2)+"_"+e.IMAGE_SIZE+"_no_top/model.json",f];throw Error("MobileNet V"+t.version+" doesn't exist")},b=function(t){return n(void 0,void 0,void 0,function(){var e;return i(this,function(r){switch(r.label){case 0:if("string"!=typeof t)return[3,3];return[4,fetch(t)];case 1:return[4,r.sent().json()];case 2:return e=r.sent(),[3,4];case 3:if(g(t))e=t;else throw Error("Invalid Metadata provided");r.label=4;case 4:return[2,m(e)]}})})};function w(t,e,r){return void 0===r&&(r=3),n(this,void 0,void 0,function(){var n;return i(this,function(i){switch(i.label){case 0:return[4,e.data()];case 1:return n=i.sent(),[2,o.tidy(function(){r=Math.min(r,n.length);for(var e=[],i=0;i<n.length;i++)e.push({value:n[i],index:i});e.sort(function(t,e){return e.value-t.value});for(var o=new Float32Array(r),a=new Int32Array(r),i=0;i<r;i++)o[i]=e[i].value,a[i]=e[i].index;for(var s=[],i=0;i<a.length;i++)s.push({className:t[a[i]],probability:o[i]});return s})]}})})}e.getTopKClasses=w;var x=function(){function t(t,e){this.model=t,this._metadata=m(e)}return Object.defineProperty(t,"EXPECTED_IMAGE_SIZE",{get:function(){return e.IMAGE_SIZE},enumerable:!1,configurable:!0}),t.prototype.getMetadata=function(){return this._metadata},t.prototype.getTotalClasses=function(){return this.model.output.shape[1]},t.prototype.getClassLabels=function(){return this._metadata.labels},t.prototype.predictTopK=function(t,e,r){return void 0===e&&(e=10),void 0===r&&(r=!1),n(this,void 0,void 0,function(){var n,l,u,c=this;return i(this,function(i){switch(i.label){case 0:return n=h.cropTo(t,this._metadata.imageSize,r),l=o.tidy(function(){var t=s.capture(n,c._metadata.grayscale);return c.model.predict(t)}),[4,w(this._metadata.labels,l,e)];case 1:return u=i.sent(),a.dispose(l),[2,u]}})})},t.prototype.predict=function(t,e){return void 0===e&&(e=!1),n(this,void 0,void 0,function(){var r,n,l,u,c,f=this;return i(this,function(i){switch(i.label){case 0:return r=h.cropTo(t,this._metadata.imageSize,e),[4,(n=o.tidy(function(){var t=s.capture(r,f._metadata.grayscale);return f.model.predict(t)})).data()];case 1:for(c=0,l=i.sent(),u=[];c<l.length;c++)u.push({className:this._metadata.labels[c],probability:l[c]});return a.dispose(n),[2,u]}})})},t.prototype.dispose=function(){this.truncatedModel.dispose()},t}();function M(t){return n(this,void 0,void 0,function(){var e,r,n,a,s,h,l;return i(this,function(i){switch(i.label){case 0:return r=(e=y(t))[0],n=e[1],[4,o.loadLayersModel(r)];case 1:if(a=i.sent(),t&&1===t.version)return s=a.getLayer(n),h=o.model({inputs:a.inputs,outputs:s.output}),(l=o.sequential()).add(h),l.add(o.layers.flatten()),[2,l];return s=a.getLayer(n),h=o.model({inputs:a.inputs,outputs:s.output}),(l=o.sequential()).add(h),l.add(o.layers.globalAveragePooling2d({})),[2,l]}})})}function k(t,e){return n(this,void 0,void 0,function(){var r,n;return i(this,function(i){switch(i.label){case 0:return[4,o.loadLayersModel(t)];case 1:if(r=i.sent(),!e)return[3,3];return[4,b(e)];case 2:return n=i.sent(),[3,4];case 3:n=null,i.label=4;case 4:return[2,new x(r,n)]}})})}function E(t,e,r){return n(this,void 0,void 0,function(){var n,a,s;return i(this,function(i){switch(i.label){case 0:return[4,o.loadLayersModel(o.io.browserFiles([t,e]))];case 1:return n=i.sent(),[4,new Response(r).json()];case 2:if(a=i.sent(),!r)return[3,4];return[4,b(a)];case 3:return s=i.sent(),[3,5];case 4:s=null,i.label=5;case 5:return[2,new x(n,s)]}})})}e.CustomMobileNet=x,e.loadTruncatedMobileNet=M,e.load=k,e.loadFromFiles=E},8324:function(t,e,r){"use strict";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */n={value:!0};var n,i=r(2727);n={enumerable:!0,get:function(){return i.IMAGE_SIZE}},n={enumerable:!0,get:function(){return i.CustomMobileNet}},Object.defineProperty(e,"zD",{enumerable:!0,get:function(){return i.load}}),n={enumerable:!0,get:function(){return i.loadFromFiles}},n={enumerable:!0,get:function(){return i.loadTruncatedMobileNet}};var o=r(3210);n={enumerable:!0,get:function(){return o.TeachableMobileNet}},n={enumerable:!0,get:function(){return o.createTeachable}};var a=r(7344);n={enumerable:!0,get:function(){return a.Webcam}},r(9303)},3210:function(t,e,r){"use strict";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var n=function(){var t=function(e,r){return(t=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(t,e,r,n){function i(t){return t instanceof r?t:new r(function(e){e(t)})}return new(r||(r=Promise))(function(r,o){function a(t){try{h(n.next(t))}catch(t){o(t)}}function s(t){try{h(n.throw(t))}catch(t){o(t)}}function h(t){t.done?r(t.value):i(t.value).then(a,s)}h((n=n.apply(t,e||[])).next())})},o=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return h([t,e])}}function h(o){if(r)throw TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.createTeachable=e.TeachableMobileNet=void 0;var a=r(4080),s=r(4080),h=r(7279),l=r(2727),u=r(3718),c=.15,f=function(t){return"object"==typeof t.dataId&&"object"==typeof t.shape};function d(t,e){var r=Array(e).fill(0);return r[t]=1,r}function p(t,e){for(var r,n=t.length,i=t.slice(),o=n-1;o>0;o-=1){var a=void 0;r=[i[a=e?Math.floor(e()*(o+1)):Math.floor(Math.random()*(o+1))],i[o]],i[o]=r[0],i[a]=r[1]}return i}var m=function(t){function e(e,r){var n=t.call(this,a.sequential(),r)||this;return n.totalSamples=0,n.examples=[],n.truncatedModel=e,n}return n(e,t),Object.defineProperty(e.prototype,"asSequentialModel",{get:function(){return this.model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!1,configurable:!0}),e.prototype.addExample=function(t,e){return i(this,void 0,void 0,function(){var r,n,i;return o(this,function(o){return r=f(e)?e:h.capture(e,this._metadata.grayscale),i=(n=this.truncatedModel.predict(r)).dataSync(),r.dispose(),n.dispose(),this.examples[t].push(i),this.totalSamples++,[2]})})},e.prototype.predict=function(e,r){return void 0===r&&(r=!1),i(this,void 0,void 0,function(){return o(this,function(n){if(!this.model)throw Error("Model has not been trained yet, called train() first");return[2,t.prototype.predict.call(this,e,r)]})})},e.prototype.predictTopK=function(e,r,n){return void 0===r&&(r=10),void 0===n&&(n=!1),i(this,void 0,void 0,function(){return o(this,function(i){if(!this.model)throw Error("Model has not been trained yet, called train() first");return[2,t.prototype.predictTopK.call(this,e,r,n)]})})},e.prototype.prepare=function(){for(var t in this.examples)if(0===t.length)throw Error("Add some examples before training");var e=this.convertToTfDataset();this.trainDataset=e.trainDataset,this.validationDataset=e.validationDataset},e.prototype.convertToTfDataset=function(){for(var t=0;t<this.examples.length;t++)this.examples[t]=p(this.examples[t],this.seed);for(var e=[],r=[],n=function(t){var n=d(t,i.numClasses),o=i.examples[t].length,a=Math.ceil(c*o),s=o-a,h=i.examples[t].slice(0,s).map(function(t){return{data:t,label:n}}),l=i.examples[t].slice(s).map(function(t){return{data:t,label:n}});e=e.concat(h),r=r.concat(l)},i=this,t=0;t<this.examples.length;t++)n(t);e=p(e,this.seed),r=p(r,this.seed);var o=a.data.array(e.map(function(t){return t.data})),s=a.data.array(r.map(function(t){return t.data})),h=a.data.array(e.map(function(t){return t.label})),l=a.data.array(r.map(function(t){return t.label}));return{trainDataset:a.data.zip({xs:o,ys:h}),validationDataset:a.data.zip({xs:s,ys:l})}},e.prototype.save=function(t,e){return i(this,void 0,void 0,function(){return o(this,function(r){return[2,this.model.save(t,e)]})})},e.prototype.train=function(t,e){return void 0===e&&(e={}),i(this,void 0,void 0,function(){var r,n,i,h,l,u,c,f,d,p,m=this;return o(this,function(o){switch(o.label){case 0:if(r=e.onTrainEnd||function(){},e.onTrainEnd=function(t){m.__stopTrainingResolve&&(m.__stopTrainingResolve(),m.__stopTrainingResolve=null),r(t)},this.isPrepared||this.prepare(),n=this.getLabels().length,s.util.assert(n===this.numClasses,function(){return"Can not train, has "+n+" labels and "+m.numClasses+" classes"}),i=this.truncatedModel.outputs[0].shape.slice(1),h=a.util.sizeFromShape(i),l=this.seed?a.initializers.varianceScaling({seed:3.14}):a.initializers.varianceScaling({}),this.trainingModel=a.sequential({layers:[a.layers.dense({inputShape:[h],units:t.denseUnits,activation:"relu",kernelInitializer:l,useBias:!0}),a.layers.dense({kernelInitializer:l,useBias:!1,activation:"softmax",units:this.numClasses})]}),u=a.train.adam(t.learningRate),this.trainingModel.compile({optimizer:u,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(t.batchSize>0))throw Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return c=this.trainDataset.batch(t.batchSize),f=this.validationDataset.batch(t.batchSize),[4,this.trainingModel.fitDataset(c,{epochs:t.epochs,validationData:f,callbacks:e})];case 1:return d=o.sent(),(p=a.sequential()).add(this.truncatedModel),p.add(this.trainingModel),this.model=p,u.dispose(),[2,this.model]}})})},e.prototype.prepareDataset=function(){for(var t=0;t<this.numClasses;t++)this.examples[t]=[]},e.prototype.setLabel=function(t,e){this._metadata.labels[t]=e},e.prototype.setLabels=function(t){this._metadata.labels=t,this.prepareDataset()},e.prototype.getLabel=function(t){return this._metadata.labels[t]},e.prototype.getLabels=function(){return this._metadata.labels},e.prototype.setName=function(t){this._metadata.modelName=t},e.prototype.getName=function(){return this._metadata.modelName},e.prototype.stopTraining=function(){var t=this;return new Promise(function(e,r){t.trainingModel.stopTraining=!0,t.__stopTrainingResolve=e})},e.prototype.dispose=function(){this.trainingModel.dispose(),t.prototype.dispose.call(this)},e.prototype.calculateAccuracyPerClass=function(){return i(this,void 0,void 0,function(){var t,e,r,n,s,h,l,u,c,f,d,p,m,g,v,y,b,w,x=this;return o(this,function(M){switch(M.label){case 0:return t=this.validationDataset.mapAsync(function(t){return i(x,void 0,void 0,function(){return o(this,function(e){return[2,t.xs]})})}),r=Math.min((e=this.validationDataset.mapAsync(function(t){return i(x,void 0,void 0,function(){return o(this,function(e){return[2,t.ys]})})})).size,32),n=Math.ceil(e.size/r),s=t.batch(r),h=e.batch(r),[4,s.iterator()];case 1:return l=M.sent(),[4,h.iterator()];case 2:u=M.sent(),c=[],f=[],d=0,M.label=3;case 3:if(!(d<n))return[3,7];return[4,l.next()];case 4:return p=M.sent(),g=(m=this.trainingModel.predict(p.value)).argMax(1),c.push(g),[4,u.next()];case 5:y=(v=M.sent()).value.argMax(1),f.push(y),p.value.dispose(),m.dispose(),v.value.dispose(),M.label=6;case 6:return d++,[3,3];case 7:if(b=a.concat(f),w=a.concat(c),1!==n)for(d=0;d<c.length;d++)c[d].dispose(),f[d].dispose();return[2,{reference:b,predictions:w}]}})})},e.prototype.setSeed=function(t){this.seed=u(t)},e}(l.CustomMobileNet);function g(t,e){return i(this,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return[4,l.loadTruncatedMobileNet(e)];case 1:return[2,new m(r.sent(),t)]}})})}e.TeachableMobileNet=m,e.createTeachable=g},2880:function(t,e){"use strict";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0}),e.cropTo=e.resizeMinTo=e.resizeMaxTo=e.resize=void 0;var r=function(){return document.createElement("canvas")};function n(t,e,n){return void 0===n&&(n=r()),n.width=t.width*e,n.height=t.height*e,n.getContext("2d").drawImage(t,0,0,n.width,n.height),n}function i(t,e,i){void 0===i&&(i=r());var o=Math.max(t.width,t.height);return n(t,e/o,i)}function o(t,e,i){void 0===i&&(i=r());var o=Math.min(t.width,t.height);return n(t,e/o,i)}function a(t,e,n,i){void 0===n&&(n=!1),void 0===i&&(i=r());var o=t.width,a=t.height;t instanceof HTMLVideoElement&&(o=t.videoWidth,a=t.videoHeight);var s=e/Math.min(o,a),h=Math.ceil(o*s),l=Math.ceil(a*s),u=h-e,c=l-e;i.width=i.height=e;var f=i.getContext("2d");return f.drawImage(t,-1*~~(u/2),-1*~~(c/2),h,l),n&&(f.scale(-1,1),f.drawImage(i,-1*e,0)),i}e.resize=n,e.resizeMaxTo=i,e.resizeMinTo=o,e.cropTo=a},7279:function(t,e,r){"use strict";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0}),e.cropTensor=e.capture=void 0;var n=r(4080);function i(t,e){return n.tidy(function(){return o(n.browser.fromPixels(t),e).expandDims(0).toFloat().div(n.scalar(127)).sub(n.scalar(1))})}function o(t,e,r){var i=Math.min(t.shape[0],t.shape[1]),o=t.shape[0]/2-i/2,a=t.shape[1]/2-i/2;if(e&&!r){var s=t.slice([o,a,0],[i,i,3]);s=s.reshape([i*i,1,3]);var h=[.2989,.587,.114];return s=(s=n.mul(s,h)).reshape([i,i,3]),s=n.sum(s,-1),s=n.expandDims(s,-1)}return t.slice([o,a,0],[i,i,3])}e.capture=i,e.cropTensor=o},7344:function(t,e,r){"use strict";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var n=function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},i=function(t,e,r,n){function i(t){return t instanceof r?t:new r(function(e){e(t)})}return new(r||(r=Promise))(function(r,o){function a(t){try{h(n.next(t))}catch(t){o(t)}}function s(t){try{h(n.throw(t))}catch(t){o(t)}}function h(t){t.done?r(t.value):i(t.value).then(a,s)}h((n=n.apply(t,e||[])).next())})},o=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return h([t,e])}}function h(o){if(r)throw TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Webcam=void 0;var a=r(3261),s=r(2880),h={facingMode:"user",frameRate:24},l=function(t){return t.facingMode=t.facingMode||h.facingMode,t.frameRate=t.frameRate||h.frameRate,t.aspectRatio=t.aspectRatio||h.aspectRatio,t},u=function(){function t(t,e,r){void 0===t&&(t=400),void 0===e&&(e=400),void 0===r&&(r=!1),this.width=t,this.height=e,this.flip=r}return t.prototype.getWebcam=function(t){if(void 0===t&&(t={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");t.width=640;var e=l(t),r=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:e}).then(function(t){return r.srcObject=t,r.addEventListener("loadedmetadata",function(t){var e=r.videoWidth,n=r.videoHeight;r.width=e,r.height=n}),r},function(){return Promise.reject("Could not open your camera. You may have denied access.")})},t.prototype.setup=function(t){return void 0===t&&(t={}),i(this,void 0,void 0,function(){var e;return o(this,function(r){switch(r.label){case 0:if(this.webcam)return[3,2];return e=this,[4,this.getWebcam(t)];case 1:e.webcam=r.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),r.label=2;case 2:return[2]}})})},t.prototype.play=function(){return this.webcam.play()},t.prototype.pause=function(){this.webcam.pause()},t.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},t.prototype.update=function(){this.renderCameraToCanvas()},t.prototype.stopStreamedVideo=function(t){t.srcObject.getTracks().forEach(function(t){t.stop()}),t.srcObject=null},t.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var t=this.canvas.getContext("2d");if(0!==this.webcam.videoWidth){var e=s.cropTo(this.webcam,this.width,this.flip);t.drawImage(e,0,0)}}},n([a.default],t.prototype,"getWebcam",null),n([a.default],t.prototype,"setup",null),n([a.default],t.prototype,"play",null),n([a.default],t.prototype,"pause",null),n([a.default],t.prototype,"stop",null),n([a.default],t.prototype,"update",null),n([a.default],t.prototype,"stopStreamedVideo",null),n([a.default],t.prototype,"renderCameraToCanvas",null),t}();e.Webcam=u},9303:function(t,e){"use strict";/** @license See the LICENSE file. */Object.defineProperty(e,"__esModule",{value:!0}),e.version=void 0;var r="0.8.4-alpha2";e.version=r},4080:function(t,e,r){"use strict";r.r(e),r.d(e,{AdadeltaOptimizer:function(){return i.zJI},AdagradOptimizer:function(){return i.HeW},AdamOptimizer:function(){return i.a4z},AdamaxOptimizer:function(){return i.DBS},Callback:function(){return o.AQ},CallbackList:function(){return o.BO},CustomCallback:function(){return o.iT},DataStorage:function(){return i.JLz},ENV:function(){return i.ViN},EarlyStopping:function(){return o.pV},Environment:function(){return i.qAh},GraphModel:function(){return a.g_},History:function(){return o.Ay},InputSpec:function(){return o.Zg},KernelBackend:function(){return i.Zuw},LayerVariable:function(){return o.fU},LayersModel:function(){return o.QV},MomentumOptimizer:function(){return i.rIn},Optimizer:function(){return i.gaJ},RMSPropOptimizer:function(){return i.gVI},RNN:function(){return o.$p},Rank:function(){return i.yw1},Reduction:function(){return i.IH3},SGDOptimizer:function(){return i.DYp},Sequential:function(){return o.sb},SymbolicTensor:function(){return o.Iy},Tensor:function(){return i.esB},TensorBuffer:function(){return i.YDk},Variable:function(){return i._wD},abs:function(){return i.WnP},acos:function(){return i.Khb},acosh:function(){return i.__u},add:function(){return i.IHx},addN:function(){return i.QBD},addStrict:function(){return i.zqr},all:function(){return i.$6P},any:function(){return i.YjB},argMax:function(){return i.NqF},argMin:function(){return i.vHJ},asin:function(){return i.ZRM},asinh:function(){return i.VfV},atan:function(){return i.z4N},atan2:function(){return i.fvJ},atanh:function(){return i.C80},avgPool:function(){return i.wS1},avgPool3d:function(){return i.uR5},backend:function(){return i.y3$},backend_util:function(){return i.Wap},basicLSTMCell:function(){return i.zEQ},batchNorm:function(){return i.tgs},batchNorm2d:function(){return i.Dxk},batchNorm3d:function(){return i.JY5},batchNorm4d:function(){return i.p3b},batchNormalization:function(){return i.F08},batchNormalization2d:function(){return i.JHc},batchNormalization3d:function(){return i.csF},batchNormalization4d:function(){return i.bVb},batchToSpaceND:function(){return i.E4h},booleanMaskAsync:function(){return i.anm},browser:function(){return i.Xhn},buffer:function(){return i.f3b},callbacks:function(){return o.ZC},cast:function(){return i.pju},ceil:function(){return i.mDi},clipByValue:function(){return i.iUl},clone:function(){return i.d9v},complex:function(){return i.PYB},concat:function(){return i.zoF},concat1d:function(){return i.gME},concat2d:function(){return i.Izb},concat3d:function(){return i.MNy},concat4d:function(){return i.ZaL},constraints:function(){return o.Cb},conv1d:function(){return i.PAt},conv2d:function(){return i.Tek},conv2dTranspose:function(){return i.bc},conv3d:function(){return i.pdZ},conv3dTranspose:function(){return i.$QV},cos:function(){return i.mCk},cosh:function(){return i.f9Y},cumsum:function(){return i.zbp},customGrad:function(){return i.cbc},data:function(){return n},deprecationWarn:function(){return i.MXe},depthToSpace:function(){return i.nTT},depthwiseConv2d:function(){return i.B10},deregisterOp:function(){return a.Ue},diag:function(){return i.Ka3},disableDeprecationWarnings:function(){return i.cFr},dispose:function(){return i.B90},disposeVariables:function(){return i.N8o},div:function(){return i.hiC},divStrict:function(){return i.sz_},dot:function(){return i.AKD},dropout:function(){return i.rvX},elu:function(){return i.pyx},enableDebugMode:function(){return i.Ra$},enableProdMode:function(){return i.G48},engine:function(){return i.SRH},env:function(){return i.OBj},equal:function(){return i.DgJ},equalStrict:function(){return i.zVC},erf:function(){return i.qNN},exp:function(){return i.Qqt},expandDims:function(){return i.dt4},expm1:function(){return i.t$B},eye:function(){return i.iyy},fft:function(){return i.kp_},fill:function(){return i.hlL},findBackend:function(){return i.x3e},findBackendFactory:function(){return i.zel},floor:function(){return i.GWj},floorDiv:function(){return i.qPi},frame:function(){return i.Wiy},fused:function(){return i.imm},gather:function(){return i.Iqj},gatherND:function(){return i.dbB},getBackend:function(){return i.N_N},getKernel:function(){return i.pIF},getKernelsForBackend:function(){return i.trD},grad:function(){return i.UQy},grads:function(){return i.tiA},greater:function(){return i.pjt},greaterEqual:function(){return i.brS},greaterEqualStrict:function(){return i.bZ8},greaterStrict:function(){return i.g1k},hammingWindow:function(){return i.fbF},hannWindow:function(){return i.lFE},ifft:function(){return i.Sxn},imag:function(){return i.asL},image:function(){return i.BHj},inTopKAsync:function(){return i.V3u},initializers:function(){return o.t1},input:function(){return o.qH},io:function(){return i.io},irfft:function(){return i.wx0},isFinite:function(){return i.xVT},isInf:function(){return i.UWc},isNaN:function(){return i.i2d},keep:function(){return i.CnY},layers:function(){return o.ug},leakyRelu:function(){return i.hi7},less:function(){return i.d9m},lessEqual:function(){return i.zN1},lessEqualStrict:function(){return i.SFm},lessStrict:function(){return i.O_u},linalg:function(){return i.$r2},linspace:function(){return i.SX3},loadGraphModel:function(){return a.YL},loadLayersModel:function(){return o.FB},localResponseNormalization:function(){return i.G9k},log:function(){return i.cM7},log1p:function(){return i.Krr},logSigmoid:function(){return i.e_t},logSoftmax:function(){return i.CmS},logSumExp:function(){return i.l_t},logicalAnd:function(){return i.HvI},logicalNot:function(){return i.hJK},logicalOr:function(){return i.K5V},logicalXor:function(){return i.egP},losses:function(){return i.MB5},matMul:function(){return i.OI3},math:function(){return i.mAU},max:function(){return i.Fp7},maxPool:function(){return i._sB},maxPool3d:function(){return i.YQQ},maximum:function(){return i.gWQ},maximumStrict:function(){return i._jk},mean:function(){return i.J69},memory:function(){return i.sq6},metrics:function(){return o.qI},min:function(){return i.VV$},minimum:function(){return i.LTh},minimumStrict:function(){return i.Wzl},mod:function(){return i.wQq},modStrict:function(){return i.IrJ},model:function(){return o.o4},models:function(){return o.Cq},moments:function(){return i.Gi7},movingAverage:function(){return i.p_},mul:function(){return i.dC7},mulStrict:function(){return i.NT4},multiRNNCell:function(){return i.rq4},multinomial:function(){return i.SJ_},neg:function(){return i.W76},nextFrame:function(){return i.glt},norm:function(){return i.KOy},notEqual:function(){return i.Quu},notEqualStrict:function(){return i.FGK},oneHot:function(){return i.lfX},ones:function(){return i.iUs},onesLike:function(){return i.JpU},op:function(){return i.op},outerProduct:function(){return i.N2O},pad:function(){return i.vku},pad1d:function(){return i.pNR},pad2d:function(){return i.koy},pad3d:function(){return i.t1L},pad4d:function(){return i.lGY},pool:function(){return i.d_R},pow:function(){return i.sQ3},powStrict:function(){return i.Lfl},prelu:function(){return i.AL3},print:function(){return i.S0v},prod:function(){return i.WVs},profile:function(){return i.N5s},rand:function(){return i.TN_},randomGamma:function(){return i.wzB},randomNormal:function(){return i.nGf},randomUniform:function(){return i.LGj},range:function(){return i.w6H},ready:function(){return i.Cd_},real:function(){return i.kwC},reciprocal:function(){return i.M25},registerBackend:function(){return i.jqO},registerCallbackConstructor:function(){return o.gl},registerKernel:function(){return i.wCN},registerOp:function(){return a.iw},regularizers:function(){return o.zQ},relu:function(){return i.UYe},relu6:function(){return i.btT},removeBackend:function(){return i.cjG},reshape:function(){return i.XLQ},reverse:function(){return i.GYS},reverse1d:function(){return i.SDf},reverse2d:function(){return i.diP},reverse3d:function(){return i.sx7},reverse4d:function(){return i.mG2},rfft:function(){return i.QEs},round:function(){return i.NMM},rsqrt:function(){return i.bp0},scalar:function(){return i.iD$},scatterND:function(){return i.snQ},selu:function(){return i.U8D},separableConv2d:function(){return i.U_I},sequential:function(){return o.Pe},serialization:function(){return i.m7h},setBackend:function(){return i.CQI},setPlatform:function(){return i.VYu},setdiff1dAsync:function(){return i.ODp},sigmoid:function(){return i.XD2},sign:function(){return i.Xxe},signal:function(){return i.tdS},sin:function(){return i.O$l},sinh:function(){return i.R_K},slice:function(){return i.tPi},slice1d:function(){return i.jZU},slice2d:function(){return i.SmN},slice3d:function(){return i.CnO},slice4d:function(){return i.p0P},slice_util:function(){return i.kuN},softmax:function(){return i.XAC},softplus:function(){return i.Wvh},spaceToBatchND:function(){return i.fBT},sparseToDense:function(){return i.ers},spectral:function(){return i.uN7},split:function(){return i.Vl2},sqrt:function(){return i._b3},square:function(){return i.h62},squaredDifference:function(){return i.$i},squaredDifferenceStrict:function(){return i.r7z},squeeze:function(){return i.L9e},stack:function(){return i.knu},step:function(){return i.Nbs},stft:function(){return i.Z3H},stridedSlice:function(){return i.NXj},sub:function(){return i.luU},subStrict:function(){return i.ULw},sum:function(){return i.Smz},tan:function(){return i.ORZ},tanh:function(){return i.AEp},tensor:function(){return i.XeE},tensor1d:function(){return i.RRF},tensor2d:function(){return i.odF},tensor3d:function(){return i.wOQ},tensor4d:function(){return i.yXz},tensor5d:function(){return i.Bfx},tensor6d:function(){return i.xZs},tensor_util:function(){return i.piX},test_util:function(){return i.p3L},tidy:function(){return i.lub},tile:function(){return i.Gg6},time:function(){return i.XVJ},topk:function(){return i.hg7},train:function(){return i.p_j},transpose:function(){return i.p4s},truncatedNormal:function(){return i.Xu6},unregisterKernel:function(){return i.nEe},unsortedSegmentSum:function(){return i.pUJ},unstack:function(){return i.HHK},util:function(){return i.D5U},valueAndGrad:function(){return i.h76},valueAndGrads:function(){return i.fNQ},variable:function(){return i.VD$},variableGrads:function(){return i.pnJ},version:function(){return tN},version_converter:function(){return a.gJ},version_core:function(){return i.jTM},version_layers:function(){return o.H6},webgl:function(){return i.yOA},where:function(){return i.arb},whereAsync:function(){return i.itS},zeros:function(){return i.lls},zerosLike:function(){return i.P84}});var n={};r.r(n),r.d(n,{CSVDataset:function(){return tm},Dataset:function(){return tr},FileDataSource:function(){return tP},TextLineDataset:function(){return th},URLDataSource:function(){return tC},array:function(){return ti},csv:function(){return tI},func:function(){return tT},generator:function(){return tB},microphone:function(){return tU},version_data:function(){return tL},webcam:function(){return tR},zip:function(){return to}});var i=r(2037),o=r(6669),a=r(6778),s=r(8620).Buffer,h=function(t,e){return(h=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function l(t,e){function r(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function u(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{h(n.next(t))}catch(t){o(t)}}function s(t){try{h(n.throw(t))}catch(t){o(t)}}function h(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(a,s)}h((n=n.apply(t,e||[])).next())})}function c(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function f(t,e){return t(e={exports:{}},e.exports),e.exports}window;var d=f(function(t){!function(t,e,r){function n(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var r=new function(t){var e,r=this,n=(e=4022871197,function(t){t=t.toString();for(var r=0;r<t.length;r++){var n=.02519603282416938*(e+=t.charCodeAt(r));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 23283064365386963e-26*(e>>>0)});r.next=function(){var t=2091639*r.s0+23283064365386963e-26*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=t-(r.c=0|t)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(t),r.s0<0&&(r.s0+=1),r.s1-=n(t),r.s1<0&&(r.s1+=1),r.s2-=n(t),r.s2<0&&(r.s2+=1),n=null}(t),i=e&&e.state,o=r.next;return o.int32=function(){return 4294967296*r.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.alea=i}(0,t,!1)}),p=f(function(t){!function(t,e,r){function n(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var r=new function(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152;while(0===t);return t},o.int32=r.next,o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xor128=i}(0,t,!1)}),m=f(function(t){!function(t,e,r){function n(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var r=new function(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152;while(0===t);return t},o.int32=r.next,o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xorwow=i}(0,t,!1)}),g=f(function(t){!function(t,e,r){function n(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var r=new function(t){var e=this;e.next=function(){var t,r,n=e.x,i=e.i;return t=n[i],r=(t^=t>>>7)^t<<24^((t=n[i+1&7])^t>>>10)^((t=n[i+3&7])^t>>>3)^((t=n[i+4&7])^t<<7),t=n[i+7&7],r^=(t^=t<<13)^t<<9,n[i]=r,e.i=i+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,r=0;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152;while(0===t);return t},o.int32=r.next,o.quick=o,i&&(i.x&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xorshift7=i}(0,t,!1)}),v=f(function(t){!function(t,e,r){function n(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var r=new function(t){var e=this;e.next=function(){var t,r,n=e.w,i=e.X,o=e.i;return e.w=n=n+1640531527|0,r=i[o+34&127],t=i[o=o+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=i[o]=r^t,e.i=o,r+(n^n>>>16)|0},function(t,e){var r,n,i,o,a,s=[],h=128;for(e===(0|e)?(n=e,e=null):(e+="\x00",n=0,h=Math.max(h,e.length)),i=0,o=-32;o<h;++o)e&&(n^=e.charCodeAt((o+32)%e.length)),0===o&&(a=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,o>=0&&(a=a+1640531527|0,i=0==(r=s[127&o]^=n+a)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)n=s[i+34&127],r=s[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,s[i]=n^r;t.w=a,t.X=s,t.i=i}(e,t)}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152;while(0===t);return t},o.int32=r.next,o.quick=o,i&&(i.X&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.xor4096=i}(0,t,!1)}),y=f(function(t){!function(t,e,r){function n(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var r=new function(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,i=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}(t),i=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152;while(0===t);return t},o.int32=r.next,o.quick=o,i&&("object"==typeof i&&n(i,r),o.state=function(){return n(r,{})}),o}e&&e.exports?e.exports=i:r&&r.amd?r(function(){return i}):this.tychei=i}(0,t,!1)}),b=f(function(t){!function(e,n){var i,o=this,a=256,s=6,h="random",l=n.pow(a,s),u=n.pow(2,52),c=2*u,f=a-1;function d(t,r,d){var v=[],y=m(function t(e,r){var n,i=[],o=typeof e;if(r&&"object"==o)for(n in e)try{i.push(t(e[n],r-1))}catch(t){}return i.length?i:"string"==o?e:e+"\x00"}((r=1==r?{entropy:!0}:r||{}).entropy?[t,g(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(a):(t=new Uint8Array(a),(o.crypto||o.msCrypto).getRandomValues(t)),g(t)}catch(t){var r=o.navigator,n=r&&r.plugins;return[+new Date,o,n,o.screen,g(e)]}}():t,3),v),b=new function(t){var e,r=t.length,n=this,i=0,o=n.i=n.j=0,s=n.S=[];for(r||(t=[r++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=f&o+t[i%r]+(e=s[i])],s[o]=e;(n.g=function(t){for(var e,r=0,i=n.i,o=n.j,s=n.S;t--;)e=s[i=f&i+1],r=r*a+s[f&(s[i]=s[o=f&o+e])+(s[o]=e)];return n.i=i,n.j=o,r})(a)}(v),w=function(){for(var t=b.g(s),e=l,r=0;t<u;)t=(t+r)*a,e*=a,r=b.g(1);for(;t>=c;)t/=2,e/=2,r>>>=1;return(t+r)/e};return w.int32=function(){return 0|b.g(4)},w.quick=function(){return b.g(4)/4294967296},w.double=w,m(g(b.S),e),(r.pass||d||function(t,e,r,i){return i&&(i.S&&p(i,b),t.state=function(){return p(b,{})}),r?(n[h]=t,e):t})(w,y,"global"in r?r.global:this==n,r.state)}function p(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){for(var r,n=t+"",i=0;i<n.length;)e[f&i]=f&(r^=19*e[f&i])+n.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(n["seed"+h]=d,m(n.random(),e),t.exports){t.exports=d;try{i=r(802)}catch(t){}}}([],Math)});b.alea=d,b.xor128=p,b.xorwow=m,b.xorshift7=g,b.xor4096=v,b.tychei=y;var w=b.alea;function x(t,e){return M(t,e)}function M(t,e,r,n){if(void 0===r&&(r=new Map),void 0===n&&(n=new Set),null==t)return null;if(n.has(t))throw Error("Circular references are not supported.");if(r.has(t))return r.get(t);var i=e(t);if(i.recurse&&null!==i.value)throw Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(S(t)){var o=Array.isArray(t)?[]:{};for(var a in n.add(t),t){var s=M(t[a],e,r,n);o[a]=s}return n.delete(t),o}throw Error("Can't recurse into non-iterable type: "+t)}return r.set(t,i.value),i.value}function k(t,e){return void 0===e&&(e=A),E(t,e)}function E(t,e,r){void 0===r&&(r=new Set);var n=t[0];if(r.has(n))throw Error("Circular references are not supported.");var i=e(t);if(i.recurse&&null!==i.value)throw Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(S(n)){var o=Array.isArray(n)?[]:{};r.add(n);var a=function(n){var i=E(t.map(function(t){return t[n]}),e,r);o[n]=i};for(var s in n)a(s);return r.delete(n),o}throw Error("Can't recurse into non-iterable type: "+n)}return i.value}function A(t){return null===t?null:S(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function _(t,e){return u(this,void 0,void 0,function(){var r,n,i,o,a,s;return c(this,function(h){switch(h.label){case 0:M(t,e,r=new Map),n=0,i=Array.from(r.keys()),h.label=1;case 1:return n<i.length?(o=i[n],(a=r.get(o))instanceof Promise?[4,a]:[3,3]):[3,4];case 2:s=h.sent(),r.set(o,s),h.label=3;case 3:return n++,[3,1];case 4:return[2,M(t,e,r)]}})})}function S(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof i.esB))}function D(t){return null==t||P(t)||Array.isArray(t)||"object"==typeof t&&t instanceof i.esB||i.D5U.isTypedArray(t)}function P(t){return null===t||"object"!=typeof t&&"function"!=typeof t}function C(t){return x(t,I)}function I(t){return t instanceof i.esB?{value:t.clone(),recurse:!1}:S(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}var T=function(){function t(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw RangeError("Can't create ring buffer of capacity < 1.");this.data=Array(t),this.doubledCapacity=2*t}return t.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},t.prototype.get=function(t){if(t<0)throw RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},t.prototype.set=function(t,e){if(t<0)throw RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e},t.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},t.prototype.isFull=function(){return this.length()===this.capacity},t.prototype.isEmpty=function(){return 0===this.length()},t.prototype.push=function(t){if(this.isFull())throw RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},t.prototype.pushAll=function(t){for(var e=0,r=t;e<r.length;e++){var n=r[e];this.push(n)}},t.prototype.pop=function(){if(this.isEmpty())throw RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},t.prototype.unshift=function(t){if(this.isFull())throw RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},t.prototype.shift=function(){if(this.isEmpty())throw RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},t.prototype.shuffleExcise=function(t){if(this.isEmpty())throw RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+t),r=this.get(e);return this.set(e,this.pop()),r},t}(),B=function(t){function e(){return t.call(this,e.INITIAL_CAPACITY)||this}return l(e,t),e.prototype.isFull=function(){return!1},e.prototype.push=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.push.call(this,e)},e.prototype.unshift=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.unshift.call(this,e)},e.prototype.expand=function(){for(var t=2*this.capacity,e=Array(t),r=this.length(),n=0;n<r;n++)e[n]=this.get(this.wrap(this.begin+n));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=r},e.INITIAL_CAPACITY=32,e}(T);function R(t){return new z(t)}function U(t){return new Y(t)}function L(t,e){return new Z(t,e)}function O(t,e){return void 0===e&&(e=N.FAIL),new $(t,e)}var N,F=function(){function t(){}return t.prototype.toArray=function(){return u(this,void 0,void 0,function(){var t,e;return c(this,function(r){switch(r.label){case 0:return t=[],[4,this.next()];case 1:e=r.sent(),r.label=2;case 2:return e.done?[3,4]:(t.push(e.value),[4,this.next()]);case 3:return e=r.sent(),[3,2];case 4:return[2,t]}})})},t.prototype.toArrayForTest=function(){return u(this,void 0,void 0,function(){var t,e,r;return c(this,function(n){switch(n.label){case 0:return t=this.prefetch(100),e=[],[4,t.next()];case 1:r=n.sent(),n.label=2;case 2:return r.done?[3,4]:(e.push(r.value),[4,t.next()]);case 3:return r=n.sent(),[3,2];case 4:return[2,e]}})})},t.prototype.resolveFully=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return[4,this.next()];case 1:t=e.sent(),e.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=e.sent(),[3,2];case 4:return[2]}})})},t.prototype.resolveWhile=function(t){return u(this,void 0,void 0,function(){var e,r;return c(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:r=t((e=n.sent()).value),n.label=2;case 2:return e.done||!r?[3,4]:[4,this.next()];case 3:return r=t((e=n.sent()).value),[3,2];case 4:return[2]}})})},t.prototype.handleErrors=function(t){return new W(this,t)},t.prototype.filter=function(t){return new q(this,t)},t.prototype.map=function(t){return new H(this,t)},t.prototype.mapAsync=function(t){return new K(this,t)},t.prototype.serialMapAsync=function(t){return new K(this,t).serial()},t.prototype.flatmap=function(t){return new Q(this,t)},t.prototype.forEachAsync=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){return[2,this.map(t).resolveFully()]})})},t.prototype.serialForEach=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){return[2,this.serialMapAsync(t).resolveWhile(function(t){return!0===t})]})})},t.prototype.rowMajorBatch=function(t,e){return void 0===e&&(e=!0),new G(this,t,e)},t.prototype.columnMajorBatch=function(t,e,r){return void 0===e&&(e=!0),void 0===r&&(r=A),this.rowMajorBatch(t,e).map(function(t){return k(t,r)})},t.prototype.concatenate=function(t,e){return new Z(R([this,t]),e)},t.prototype.take=function(t){return t<0||null==t?this:new j(this,t)},t.prototype.skip=function(t){return t<0||null==t?this:new V(this,t)},t.prototype.prefetch=function(t){return new tt(this,t)},t.prototype.shuffle=function(t,e){return new te(this,t,e)},t.prototype.serial=function(){return new X(this)},t}(),z=function(t){function e(e){var r=t.call(this)||this;return r.items=e,r.trav=0,r}return l(e,t),e.prototype.summary=function(){return"Array of "+this.items.length+" items"},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(t=this.items[this.trav],this.trav++,[2,{value:C(t),done:!1}])})})},e}(F),Y=function(t){function e(e){var r=t.call(this)||this;return r.nextFn=e,r}return l(e,t),e.prototype.summary=function(){return"Function call"},e.prototype.next=function(){return u(this,void 0,void 0,function(){return c(this,function(t){try{return[2,this.nextFn()]}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}return[2]})})},e}(F),X=function(t){function e(e){var r=t.call(this)||this;return r.upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t=this;return c(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return[2,this.upstream.next()]})})},e}(F),V=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.maxCount=r,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t=this;return c(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(t=e.sent()).done?[2,t]:((0,i.B90)(t.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},e}(F),j=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.maxCount=r,n.count=0,n}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Take"},e.prototype.next=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},e}(F),G=function(t){function e(e,r,n){void 0===n&&(n=!0);var i=t.call(this)||this;return i.upstream=e,i.batchSize=r,i.enableSmallLastBatch=n,i.lastRead=Promise.resolve({value:null,done:!1}),i}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t=this;return c(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return u(this,void 0,void 0,function(){var t,e;return c(this,function(r){switch(r.label){case 0:t=[],r.label=1;case 1:return t.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(e=r.sent()).done?this.enableSmallLastBatch&&t.length>0?[2,{value:t,done:!1}]:[2,{value:null,done:!0}]:(t.push(e.value),[3,1]);case 3:return[2,{value:t,done:!1}]}})})},e}(F),q=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.predicate=r,n.lastRead=Promise.resolve({value:null,done:!1}),n}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t=this;return c(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return[4,this.upstream.next()];case 1:return(t=e.sent()).done||this.predicate(t.value)?[2,t]:((0,i.B90)(t.value),[3,0]);case 2:return[2]}})})},e}(F),H=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.transform=r,n}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Map"},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t,e,r,n,o,a,s;return c(this,function(h){switch(h.label){case 0:return[4,this.upstream.next()];case 1:if((t=h.sent()).done)return[2,{value:null,done:!0}];for(e=i.piX.getTensorsInContainer(t.value),r=this.transform(t.value),n=i.piX.getTensorsInContainer(r),o=0,a=e;o<a.length;o++)s=a[o],i.piX.isTensorInList(s,n)||s.dispose();return[2,{value:r,done:!1}]}})})},e}(F),W=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.handler=r,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t=this;return c(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,e.sent()];case 3:return t=e.sent(),this.handler(t)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},e}(F),K=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.transform=r,n}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t,e,r,n,o,a,s;return c(this,function(h){switch(h.label){case 0:return[4,this.upstream.next()];case 1:return(t=h.sent()).done?[2,{value:null,done:!0}]:(e=i.piX.getTensorsInContainer(t.value),[4,this.transform(t.value)]);case 2:for(r=h.sent(),n=i.piX.getTensorsInContainer(r),o=0,a=e;o<a.length;o++)s=a[o],i.piX.isTensorInList(s,n)||s.dispose();return[2,{value:r,done:!1}]}})})},e}(F),J=function(t){function e(){var e=t.call(this)||this;return e.outputQueue=new B,e.lastRead=Promise.resolve({value:null,done:!1}),e}return l(e,t),e.prototype.next=function(){return u(this,void 0,void 0,function(){var t=this;return c(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.serialNext=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return t.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},e}(F),Q=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.transform=r,n}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},e.prototype.pump=function(){return u(this,void 0,void 0,function(){var t,e,r,n,o,a,s;return c(this,function(h){switch(h.label){case 0:return[4,this.upstream.next()];case 1:if((t=h.sent()).done)return[2,!1];for(e=i.piX.getTensorsInContainer(t.value),r=this.transform(t.value),n=i.piX.getTensorsInContainer(r),this.outputQueue.pushAll(r),o=0,a=e;o<a.length;o++)s=a[o],i.piX.isTensorInList(s,n)||s.dispose();return[2,!0]}})})},e}(J),Z=function(t){function e(e,r){var n=t.call(this)||this;return n.baseErrorHandler=r,n.lastRead=null,n.iterator=null,n.moreIterators=e,n}return l(e,t),e.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},e.prototype.next=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},e.prototype.readFromChain=function(t){return u(this,void 0,void 0,function(){var e,r;return c(this,function(n){switch(n.label){case 0:return[4,t];case 1:return n.sent(),null!=this.iterator?[3,3]:[4,this.moreIterators.next()];case 2:if((e=n.sent()).done)return[2,{value:null,done:!0}];this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),n.label=3;case 3:return[4,this.iterator.next()];case 4:return(r=n.sent()).done?(this.iterator=null,[2,this.readFromChain(t)]):[2,r]}})})},e}(F);!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(N||(N={}));var $=function(t){function e(e,r){void 0===r&&(r=N.FAIL);var n=t.call(this)||this;return n.iterators=e,n.mismatchMode=r,n.count=0,n.currentPromise=null,n}return l(e,t),e.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},e.prototype.nextState=function(t){return u(this,void 0,void 0,function(){var e,r,n;function i(t){return t instanceof F?{value:t.next().then(function(t){return e++,t.done&&r++,t.value}),recurse:!1}:{value:null,recurse:!0}}return c(this,function(o){switch(o.label){case 0:return[4,t];case 1:return o.sent(),e=0,r=0,[4,_(this.iterators,i)];case 2:if(n=o.sent(),e===r)return[2,{value:null,done:!0}];if(r>0)switch(this.mismatchMode){case N.FAIL:throw Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case N.SHORTEST:return[2,{value:null,done:!0}];case N.LONGEST:}return this.count++,[2,{value:n,done:!1}]}})})},e.prototype.next=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},e}(F),tt=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.bufferSize=r,n.buffer=new T(r),n}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},e.prototype.refill=function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}},e.prototype.next=function(){return this.refill(),this.buffer.shift()},e}(F),te=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.upstream=e,o.windowSize=r,o.upstreamExhausted=!1,o.random=w(n||i.D5U.now().toString()),o.lastRead=Promise.resolve({value:null,done:!1}),o}return l(e,t),e.prototype.next=function(){return u(this,void 0,void 0,function(){var t=this;return c(this,function(e){return this.lastRead=this.lastRead.then(function(){return t.serialNext()}),[2,this.lastRead]})})},e.prototype.randomInt=function(t){return Math.floor(this.random()*t)},e.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},e.prototype.serialNext=function(){return u(this,void 0,void 0,function(){var t,e;return c(this,function(r){switch(r.label){case 0:this.upstreamExhausted||this.refill(),r.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(t=this.chooseIndex(),[4,this.buffer.shuffleExcise(t)]);case 2:return(e=r.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,e]);case 3:return[2,{value:null,done:!0}]}})})},e}(tt),tr=function(){function t(){this.size=null}return t.prototype.batch=function(t,e){var r=this;void 0===e&&(e=!0);var n=this;return i.D5U.assert(t>0,function(){return"batchSize needs to be positive, but it is\n      "+t}),tn(function(){return u(r,void 0,void 0,function(){return c(this,function(r){switch(r.label){case 0:return[4,n.iterator()];case 1:return[2,r.sent().columnMajorBatch(t,e,ta)]}})})},this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t))},t.prototype.concatenate=function(t){var e=this,r=this;return tn(function(){return u(e,void 0,void 0,function(){var e,n;return c(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return n=(e=i.sent()).concatenate,[4,t.iterator()];case 2:return[2,n.apply(e,[i.sent()])]}})})},this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null)},t.prototype.filter=function(t){var e=this,r=this;return tn(function(){return u(e,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().filter(function(e){return(0,i.lub)(function(){return t(e)})})]}})})},this.size===1/0?1/0:null)},t.prototype.forEachAsync=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().forEachAsync(t)]}})})},t.prototype.forEach=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){return(0,i.MXe)("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]})})},t.prototype.map=function(t){var e=this,r=this;return tn(function(){return u(e,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().map(function(e){return(0,i.lub)(function(){return t(e)})})]}})})},this.size)},t.prototype.mapAsync=function(t){var e=this,r=this;return tn(function(){return u(e,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().mapAsync(t)]}})})},this.size)},t.prototype.prefetch=function(t){var e=this;if(null==t)throw RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var r=this;return tn(function(){return u(e,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().prefetch(t)]}})})},this.size)},t.prototype.repeat=function(t){var e=this,r=this;return tn(function(){return u(e,void 0,void 0,function(){var e=this;return c(this,function(n){return[2,L(U(function(){return u(e,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return t={},[4,r.iterator()];case 1:return[2,(t.value=e.sent(),t.done=!1,t)]}})})}).take(t))]})})},null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null)},t.prototype.skip=function(t){var e=this,r=this;return tn(function(){return u(e,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().skip(t)]}})})},null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null)},t.prototype.shuffle=function(t,e,r){var n=this;if(void 0===r&&(r=!0),null==t||t<0)throw null==this.size?RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var o=this,a=w(e||i.D5U.now().toString());return tn(function(){return u(n,void 0,void 0,function(){var e;return c(this,function(n){switch(n.label){case 0:return e=a.int32(),r&&(e+=a.int32()),[4,o.iterator()];case 1:return[2,n.sent().shuffle(t,e.toString())]}})})},this.size)},t.prototype.take=function(t){var e=this,r=this;return tn(function(){return u(e,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,r.iterator()];case 1:return[2,e.sent().take(t)]}})})},null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null)},t.prototype.toArray=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}})})},t.prototype.toArrayForTest=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}})})},t.MAX_BUFFER_SIZE=1e4,t}();function tn(t,e){return void 0===e&&(e=null),new(function(r){function n(){var t=null!==r&&r.apply(this,arguments)||this;return t.size=e,t}return l(n,r),n.prototype.iterator=function(){return u(this,void 0,void 0,function(){return c(this,function(e){return[2,t()]})})},n}(tr))}function ti(t){var e=this;return tn(function(){return u(e,void 0,void 0,function(){return c(this,function(e){return[2,R(t)]})})},t.length)}function to(t){var e,r=this;if(!S(t))throw Error("The argument to zip() must be an object or array.");if(Array.isArray(t))for(var n=0;n<t.length;n++)e=null==e?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(var i in t)e=null==e?t[i].size:Math.min(e,t[i].size);return tn(function(){return u(r,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,_(t,function(t){if(t instanceof tr)return{value:t.iterator(),recurse:!1};if(S(t))return{value:null,recurse:!0};throw Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})];case 1:return[2,O(e.sent(),N.SHORTEST)]}})})},e)}function ta(t){return null===t?null:D(t[0])?{value:ts(t),recurse:!1}:{value:null,recurse:!0}}function ts(t){if(0===t.length)throw Error("Can't make a batch of zero elements.");return t[0]instanceof i.esB?(0,i.knu)(t):(0,i.XeE)(t)}var th=function(t){function e(e){var r=t.call(this)||this;return r.input=e,r}return l(e,t),e.prototype.iterator=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.input.iterator()];case 1:return[2,t.sent().decodeUTF8().split("\n").map(function(t){return t.endsWith("\r")&&(t=t.slice(0,-1)),t})]}})})},e}(tr),tl='"',tu=Symbol("out"),tc=Symbol("field"),tf=Symbol("quote"),td=Symbol("quoteafterquote"),tp=Symbol("quoteinquote"),tm=function(t){function e(e,r){var n=t.call(this)||this;return n.input=e,n.hasHeader=!0,n.fullColumnNames=null,n.columnNamesValidated=!1,n.columnConfigs=null,n.configuredColumnsOnly=!1,n.delimiter=",",n.delimWhitespace=!1,n.base=new th(e),r||(r={}),n.hasHeader=!1!==r.hasHeader,n.fullColumnNames=r.columnNames,n.columnConfigs=r.columnConfigs,n.configuredColumnsOnly=r.configuredColumnsOnly,r.delimWhitespace?(i.D5U.assert(null==r.delimiter,function(){return"Delimiter should not be provided when delimWhitespace is true."}),n.delimWhitespace=!0,n.delimiter=" "):n.delimiter=r.delimiter?r.delimiter:",",n}return l(e,t),e.prototype.columnNames=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:t.sent(),t.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},e.prototype.setColumnNames=function(){return u(this,void 0,void 0,function(){var t,e,r,n,o,a,s=this;return c(this,function(h){switch(h.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(t=h.sent(),!this.fullColumnNames&&!t)throw Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&t&&i.D5U.assert(t.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+s.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=t),r=Object.keys(e=this.fullColumnNames.reduce(function(t,e){return t[e]=t[e]+1||1,t},{})).filter(function(t){return e[t]>1}),i.D5U.assert(0===r.length,function(){return"Duplicate column names found: "+r.toString()}),this.columnConfigs){for(n=0,o=Object.keys(this.columnConfigs);n<o.length;n++)if(a=o[n],-1===this.fullColumnNames.indexOf(a))throw Error('The key "'+a+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},e.prototype.maybeReadHeaderLine=function(){return u(this,void 0,void 0,function(){var t,e;return c(this,function(r){switch(r.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,r.sent().next()];case 2:if((t=r.sent()).done)throw Error("No data was found for CSV parsing.");return e=t.value,[2,this.parseRow(e,!1)];case 3:return[2,null]}})})},e.prototype.iterator=function(){return u(this,void 0,void 0,function(){var t,e=this;return c(this,function(r){switch(r.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:r.sent(),r.label=2;case 2:return[4,this.base.iterator()];case 3:return t=r.sent(),this.hasHeader&&(t=t.skip(1)),[2,t.map(function(t){return e.makeDataElement(t)})]}})})},e.prototype.makeDataElement=function(t){for(var e=this.parseRow(t),r={},n={},i=0;i<this.fullColumnNames.length;i++){var o=this.fullColumnNames[i],a=this.columnConfigs?this.columnConfigs[o]:null;if(!this.configuredColumnsOnly||a){var s=e[i],h=null;if(""===s){if(a&&void 0!==a.default)h=a.default;else{if(a&&(a.required||a.isLabel))throw Error("Required column "+o+" is empty in this line: "+t);h=void 0}}else{var l=Number(s);if(isNaN(l))h=a&&"bool"===a.dtype?this.getBoolean(s):s;else if(a&&a.dtype)switch(a.dtype){case"float32":default:h=l;break;case"int32":h=Math.floor(l);break;case"bool":h=this.getBoolean(s)}else h=l}a&&a.isLabel?n[o]=h:r[o]=h}}return 0===Object.keys(n).length?r:{xs:r,ys:n}},e.prototype.getBoolean=function(t){return"1"===t||"true"===t.toLowerCase()?1:0},e.prototype.parseRow=function(t,e){void 0===e&&(e=!0);for(var r=[],n=0,i=t.length,o=tu,a=0;a<i;a++)switch(o){case tu:switch(t.charAt(a)){case tl:n=a+1,o=tf;break;case this.delimiter:if(n=a+1," "===this.delimiter&&this.delimWhitespace)break;r.push(""),o=tu;break;default:o=tc,n=a}break;case tc:t.charAt(a)===this.delimiter&&(r.push(t.substring(n,a)),o=tu,n=a+1);break;case tf:t.charAt(a)===tl&&(o=td);break;case td:switch(t.charAt(a)){case this.delimiter:r.push(t.substring(n,a-1)),o=tu,n=a+1;break;case tl:o=tf;break;default:o=tp}break;case tp:t.charAt(a)===tl&&(o=tf)}if(o===td?r.push(t.substring(n,i-1)):r.push(t.substring(n)),e&&r.length!==this.fullColumnNames.length)throw Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+r);return r},e}(tr),tg=function(t){function e(e){var r=t.call(this)||this;r.microphoneConfig=e,r.isClosed=!1,r.fftSize=e.fftSize||1024;var n=Math.log2(r.fftSize);if(r.fftSize<0||n<4||n>14||!Number.isInteger(n))throw Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+r.fftSize);if(r.numFrames=e.numFramesPerSpectrogram||43,r.sampleRateHz=e.sampleRateHz,r.columnTruncateLength=e.columnTruncateLength||r.fftSize,r.audioTrackConstraints=e.audioTrackConstraints,r.smoothingTimeConstant=e.smoothingTimeConstant||0,r.includeSpectrogram=!1!==e.includeSpectrogram,r.includeWaveform=!0===e.includeWaveform,!r.includeSpectrogram&&!r.includeWaveform)throw Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return r}return l(e,t),e.prototype.summary=function(){return"microphone"},e.create=function(t){return void 0===t&&(t={}),u(this,void 0,void 0,function(){var r;return c(this,function(n){switch(n.label){case 0:if((0,i.OBj)().get("IS_NODE"))throw Error("microphone API is only supported in browser environment.");return[4,(r=new e(t)).start()];case 1:return n.sent(),[2,r]}})})},e.prototype.start=function(){return u(this,void 0,void 0,function(){var t,e,r;return c(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})];case 1:return t.stream=n.sent(),[3,3];case 2:throw Error("Error thrown while initializing video stream: "+n.sent().message);case 3:if(!this.stream)throw Error("Could not obtain audio from microphone.");if(e=window.AudioContext||window.webkitAudioContext,this.audioContext=new e,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return r=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,r.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t,e,r,n,i;return c(this,function(o){switch(o.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return r=o.sent(),this.includeSpectrogram&&(n=this.flattenQueue(r.freqDataQueue),t=this.getTensorFromAudioDataArray(n,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(i=this.flattenQueue(r.timeDataQueue),e=this.getTensorFromAudioDataArray(i,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:t,waveform:e},done:!1}]}})})},e.prototype.capture=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}})})},e.prototype.getAudioData=function(){return u(this,void 0,void 0,function(){var t,e,r,n=this;return c(this,function(i){return t=[],e=[],r=0,[2,new Promise(function(i){var o=setInterval(function(){n.includeSpectrogram&&(n.analyser.getFloatFrequencyData(n.freqData),n.freqData[0]===-1/0&&i({freqDataQueue:t,timeDataQueue:e}),t.push(n.freqData.slice(0,n.columnTruncateLength))),n.includeWaveform&&(n.analyser.getFloatTimeDomainData(n.timeData),e.push(n.timeData.slice())),++r===n.numFrames&&(clearInterval(o),i({freqDataQueue:t,timeDataQueue:e}))},n.fftSize/n.sampleRateHz*1e3)})]})})},e.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},e.prototype.toArray=function(){throw Error("Can not convert infinite audio stream to array.")},e.prototype.getSampleRate=function(){return this.sampleRateHz},e.prototype.flattenQueue=function(t){var e=t[0].length,r=new Float32Array(t.length*e);return t.forEach(function(t,n){return r.set(t,n*e)}),r},e.prototype.getTensorFromAudioDataArray=function(t,e){var r=new Float32Array(i.D5U.sizeFromShape(e));return r.set(t,r.length-t.length),(0,i.XeE)(r,e)},e}(F),tv=function(t){function e(e,r){var n=t.call(this)||this;if(n.webcamVideoElement=e,n.webcamConfig=r,n.isClosed=!0,n.resize=!1,n.needToResize()){if(n.resize=!0,n.cropSize=[n.webcamConfig.resizeHeight,n.webcamConfig.resizeWidth],n.cropBoxInd=(0,i.RRF)([0],"int32"),n.webcamConfig.centerCrop){var o=1*n.webcamConfig.resizeWidth/n.webcamVideoElement.width,a=1*n.webcamConfig.resizeHeight/n.webcamVideoElement.height,s=(1-o)/2,h=(1-a)/2,l=s+o,u=a+h;n.cropBox=(0,i.odF)([h,s,u,l],[1,4])}else n.cropBox=(0,i.odF)([0,0,1,1],[1,4])}return n}return l(e,t),e.prototype.summary=function(){return"webcam"},e.create=function(t,r){return void 0===r&&(r={}),u(this,void 0,void 0,function(){var n;return c(this,function(o){switch(o.label){case 0:if((0,i.OBj)().get("IS_NODE"))throw Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!r.resizeWidth||!r.resizeHeight)throw Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=r.resizeWidth,t.height=r.resizeHeight}return[4,(n=new e(t,r)).start()];case 1:return o.sent(),[2,n]}})})},e.prototype.start=function(){return u(this,void 0,void 0,function(){var t,e,r=this;return c(this,function(n){switch(n.label){case 0:this.webcamConfig.facingMode&&i.D5U.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,function(){return"Invalid webcam facing mode: "+r.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),n.label=1;case 1:return n.trys.push([1,3,,4]),t=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return t.stream=n.sent(),[3,4];case 3:throw(e=n.sent()).message="Error thrown while initializing video stream: "+e.message,e;case 4:if(!this.stream)throw Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(t){r.webcamVideoElement.onloadedmetadata=function(){t()}})]}})})},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){if(this.isClosed)return[2,{value:null,done:!0}];try{t=i.Xhn.fromPixels(this.webcamVideoElement)}catch(t){throw Error("Error thrown converting video to pixels: "+JSON.stringify(t))}if(!this.resize)return[2,{value:t,done:!1}];try{return[2,{value:this.cropAndResizeFrame(t),done:!1}]}catch(t){throw Error("Error thrown cropping the video: "+t.message)}finally{t.dispose()}return[2]})})},e.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},e.prototype.cropAndResizeFrame=function(t){var e=this;return(0,i.lub)(function(){var r,n=t.toFloat().expandDims(0),o=(r=i.BHj.cropAndResize(n,e.cropBox,e.cropBoxInd,e.cropSize,"bilinear")).shape;return r.reshape(o.slice(1))})},e.prototype.capture=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}})})},e.prototype.stop=function(){this.stream.getTracks().forEach(function(t){return t.stop()});try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0},e.prototype.toArray=function(){throw Error("Can not convert infinite video stream to array.")},e}(F),ty=function(){return function(){}}(),tb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.split=function(t){return new tw(this,t)},e}(F),tw=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.impl=new tx(e,r),n}return l(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return[2,this.impl.next()]})})},e}(tb),tx=function(t){function e(e,r){var n=t.call(this)||this;return n.upstream=e,n.separator=r,n.carryover="",n}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},e.prototype.pump=function(){return u(this,void 0,void 0,function(){var t,e,r,n,i;return c(this,function(o){switch(o.label){case 0:return[4,this.upstream.next()];case 1:if((t=o.sent()).done)return""===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((e=t.value.split(this.separator))[0]=this.carryover+e[0],r=0,n=e.slice(0,-1);r<n.length;r++)i=n[r],this.outputQueue.push(i);return this.carryover=e[e.length-1],[2,!0]}})})},e}(J),tM=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.decodeUTF8=function(){return new tk(this)},e}(F),tk=function(t){function e(e){var r=t.call(this)||this;return r.upstream=e,r.impl=new tE(e),r}return l(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return[2,this.impl.next()]})})},e}(tb),tE=function(t){function e(e){var n=t.call(this)||this;if(n.upstream=e,(0,i.OBj)().get("IS_BROWSER"))n.decoder=new TextDecoder("utf-8");else{var o=r(5688).StringDecoder;n.decoder=new o("utf8")}return n}return l(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},e.prototype.pump=function(){return u(this,void 0,void 0,function(){var t,e,r;return c(this,function(n){switch(n.label){case 0:return[4,this.upstream.next()];case 1:return(t=n.sent()).done?[2,!1]:(e=t.value,r=(0,i.OBj)().get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(s.from(e.buffer)),this.outputQueue.push(r),[2,!0])}})})},e}(J),tA=function(t){function e(e,r){void 0===r&&(r={});var n=t.call(this)||this;return n.file=e,n.options=r,i.D5U.assert(e instanceof Uint8Array||!!(0,i.OBj)().get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),n.offset=r.offset||0,n.chunkSize=r.chunkSize||1048576,n}return l(e,t),e.prototype.summary=function(){return"FileChunks "+this.file},e.prototype.next=function(){return u(this,void 0,void 0,function(){var t,e,r=this;return c(this,function(n){switch(n.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(t=new Promise(function(t,e){var n=r.offset+r.chunkSize;if(r.file instanceof Uint8Array)t(new Uint8Array(r.file.slice(r.offset,n)));else{var i=new FileReader;i.onload=function(r){var n=i.result;if(n instanceof ArrayBuffer&&(n=new Uint8Array(n)),!(n instanceof Uint8Array))return e(TypeError("FileReader returned unknown type."));t(n)},i.onabort=function(t){return e(Error("Aborted"))},i.onerror=function(t){return e(Error(t.type))};var o=r.file.slice(r.offset,n);i.readAsArrayBuffer(o)}r.offset=n}),e={},[4,t]);case 1:return[2,(e.value=n.sent(),e.done=!1,e)]}})})},e}(tM);function t_(t,e){return void 0===e&&(e={}),u(this,void 0,void 0,function(){var r,n,o,a;return c(this,function(s){switch(s.label){case 0:return"string"==typeof t?r=t:(r=t.url,n=tS(t)),[4,i.D5U.fetch(r,n)];case 1:return(o=s.sent()).ok?(a=Uint8Array.bind,[4,o.arrayBuffer()]):[3,3];case 2:return[2,new tA(new(a.apply(Uint8Array,[void 0,s.sent()])),e)];case 3:throw Error(o.statusText)}})})}var tS=function(t){return{method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity}};function tD(t){return"string"==typeof t&&"file://"===t.substr(0,7)}var tP=function(t){function e(e,r){void 0===r&&(r={});var n=t.call(this)||this;return n.input=e,n.options=r,n}return l(e,t),e.prototype.iterator=function(){return u(this,void 0,void 0,function(){var t;return c(this,function(e){return tD(this.input)&&(0,i.OBj)().get("IS_NODE")&&(t=r(4633),this.input=t.readFileSync(this.input.substr(7))),[2,new tA(this.input,this.options)]})})},e}(ty),tC=function(t){function e(e,r){void 0===r&&(r={});var n=t.call(this)||this;return n.url=e,n.fileOptions=r,n}return l(e,t),e.prototype.iterator=function(){return u(this,void 0,void 0,function(){return c(this,function(t){return tD(this.url)?[2,new tP(this.url,this.fileOptions).iterator()]:[2,t_(this.url,this.fileOptions)]})})},e}(ty);function tI(t,e){return void 0===e&&(e={}),new tm(new tC(t),e)}function tT(t){var e=this,r=U(t);return tn(function(){return u(e,void 0,void 0,function(){return c(this,function(t){return[2,r]})})})}function tB(t){var e=this;return tn(function(){return u(e,void 0,void 0,function(){var e;return c(this,function(r){switch(r.label){case 0:return[4,t()];case 1:return e=r.sent(),[2,U(function(){return e.next()})]}})})})}function tR(t,e){return u(this,void 0,void 0,function(){return c(this,function(r){return[2,tv.create(t,e)]})})}function tU(t){return u(this,void 0,void 0,function(){return c(this,function(e){return[2,tg.create(t)]})})}var tL="1.3.1",tO="1.3.1",tN={"tfjs-core":i.jTM,"tfjs-data":tL,"tfjs-layers":o.H6,"tfjs-converter":a.gJ,tfjs:tO}},3261:function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,r){var i=r.value;if("function"!=typeof i)throw TypeError("@boundMethod decorator can only be applied to methods not: ".concat(n(i)));var o=!1;return{configurable:!0,get:function(){if(o||this===t.prototype||this.hasOwnProperty(e)||"function"!=typeof i)return i;var r=i.bind(this);return o=!0,Object.defineProperty(this,e,{configurable:!0,get:function(){return r},set:function(t){i=t,delete this[e]}}),o=!1,r},set:function(t){i=t}}}function o(t){var e;return"undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys?e=Reflect.ownKeys(t.prototype):(e=Object.getOwnPropertyNames(t.prototype),"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(t.prototype)))),e.forEach(function(e){if("constructor"!==e){var r=Object.getOwnPropertyDescriptor(t.prototype,e);"function"==typeof r.value&&Object.defineProperty(t.prototype,e,i(t,e,r))}}),t}function a(){return 1==arguments.length?o.apply(void 0,arguments):i.apply(void 0,arguments)}r.r(e),r.d(e,{boundClass:function(){return o},boundMethod:function(){return i},default:function(){return a}})},6790:function(t,e,r){"use strict";let{IOBuffer:n}=r(714),i=r(6427),o=[];for(let t=0;t<=8;t++)o.push(255<<t);class a extends n{encode(){this.encoded=new n,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();let t=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(t),this.encoded.toArray()}writePixelArray(){let t,e,r=this.encoded,n=4*Math.floor((this.bitDepth*this.width+31)/32),i=Math.ceil(this.bitDepth*this.width/8),a=n-i,s=this.bitDepth*this.width%8,h=0===s?0:8-s,l=n*this.height,u=0,c=0,f=8;r.mark(),e=this.readUint8();for(let l=this.height-1;l>=0;l--){let d=0===l;r.reset(),r.skip(l*n);for(let n=0;n<i;n++){let l=n===i-1;c<=h&&l?(r.writeByte(e<<c),0!==h&&h!==c||d||(t=e,e=this.readByte())):0===c?(t=e,e=this.readUint8(),r.writeByte(t)):(t=e,e=this.readUint8(),r.writeByte(t<<c&o[c]|e>>f)),l&&(u+=s||0,r.skip(a),f=8-(c=u%8))}}n>i&&(r.reset(),r.skip(l-1),r.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(t){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(t)}writeBitmapV5Header(){let t=4*Math.floor((this.bitDepth*this.width+31)/32)*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(i.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(t).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(i.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(i.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}constructor(t){if(1!==t.bitDepth)throw Error("Only bitDepth of 1 is supported");if(!t.height||!t.width)throw Error("ImageData width and height are required");super(t.data),this.width=t.width,this.height=t.height,this.bitDepth=t.bitDepth,this.channels=t.channels,this.components=t.components}}t.exports=a},6427:function(t){"use strict";t.exports={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}},3691:function(t,e,r){"use strict";let n=r(6790);e.c=function(t){return new n(t).encode()}},9509:function(t){"use strict";let e=8192,r=[];class n{available(t){return void 0===t&&(t=1),this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(t){void 0===t&&(t=1),this.offset+=t}seek(t){this.offset=t}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(t){if(void 0===t&&(t=1),!this.available(t)){let t=this._increment+this._increment;this._increment=t;let e=this.length+t,r=new Uint8Array(e);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=e,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t){void 0===t&&(t=1);for(var e=new Uint8Array(t),r=0;r<t;r++)e[r]=this.readByte();return e}readInt16(){var t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){var t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){var t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){var t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){var t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){var t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t){void 0===t&&(t=1),r.length=t;for(var e=0;e<t;e++)r[e]=this.readChar();return r.join("")}writeBoolean(t){this.writeUint8(t?255:0)}writeInt8(t){this.ensureAvailable(1),this._data.setInt8(this.offset++,t)}writeUint8(t){this.ensureAvailable(1),this._data.setUint8(this.offset++,t)}writeByte(t){this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(var e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e])}writeInt16(t){this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2}writeUint16(t){this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2}writeInt32(t){this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4}writeUint32(t){this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat32(t){this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat64(t){this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8}writeChar(t){this.writeUint8(t.charCodeAt(0))}writeChars(t){for(var e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}constructor(t,r){r=r||{},void 0===t&&(t=e),"number"==typeof t&&(t=new ArrayBuffer(t));let n=t.byteLength,i=r.offset?r.offset>>>0:0;t.buffer&&(n=t.byteLength-i,t=t.byteLength!==t.buffer.byteLength?t.buffer.slice(t.byteOffset+i,t.byteOffset+t.byteLength):i?t.buffer.slice(i):t.buffer),this.buffer=t,this.length=n,this.byteLength=n,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=n||e,this._mark=0}}t.exports=n},4530:function(t,e,r){"use strict";let n=r(5090);t.exports=function(t,e){return new n(t,e).decode(e)}},5833:function(t,e,r){"use strict";let n={standard:r(2255),exif:r(201),gps:r(1761)};class i{get(t){if("number"==typeof t)return this.fields.get(t);if("string"==typeof t)return this.fields.get(n[this.kind].tagsByName[t]);throw Error("expected a number or string")}get map(){if(!this._map){this._map={};let e=n[this.kind].tagsById;for(var t of this.fields.keys())e[t]&&(this._map[e[t]]=this.fields.get(t))}return this._map}constructor(t){if(!t)throw Error("missing kind");this.data=null,this.fields=new Map,this.kind=t,this._map=null}}t.exports=i},3256:function(t,e){"use strict";var r=new Map([[1,[1,n]],[2,[1,i]],[3,[2,o]],[4,[4,a]],[5,[8,s]],[6,[1,h]],[7,[1,n]],[8,[2,l]],[9,[4,u]],[10,[8,c]],[11,[4,f]],[12,[8,d]]]);function n(t,e){if(1===e)return t.readUint8();for(var r=new Uint8Array(e),n=0;n<e;n++)r[n]=t.readUint8();return r}function i(t,e){for(var r=[],n="",i=0;i<e;i++){var o=String.fromCharCode(t.readUint8());"\x00"===o?(r.push(n),n=""):n+=o}return 1===r.length?r[0]:r}function o(t,e){if(1===e)return t.readUint16();for(var r=new Uint16Array(e),n=0;n<e;n++)r[n]=t.readUint16();return r}function a(t,e){if(1===e)return t.readUint32();for(var r=new Uint32Array(e),n=0;n<e;n++)r[n]=t.readUint32();return r}function s(t,e){if(1===e)return t.readUint32()/t.readUint32();for(var r=Array(e),n=0;n<e;n++)r[n]=t.readUint32()/t.readUint32();return r}function h(t,e){if(1===e)return t.readInt8();for(var r=new Int8Array(e),n=0;n<e;n++)r[n]=t.readInt8();return r}function l(t,e){if(1===e)return t.readInt16();for(var r=new Int16Array(e),n=0;n<e;n++)r[n]=t.readInt16();return r}function u(t,e){if(1===e)return t.readInt32();for(var r=new Int32Array(e),n=0;n<e;n++)r[n]=t.readInt32();return r}function c(t,e){if(1===e)return t.readInt32()/t.readInt32();for(var r=Array(e),n=0;n<e;n++)r[n]=t.readInt32()/t.readInt32();return r}function f(t,e){if(1===e)return t.readFloat32();for(var r=new Float32Array(e),n=0;n<e;n++)r[n]=t.readFloat32();return r}function d(t,e){if(1===e)return t.readFloat64();for(var r=new Float64Array(e),n=0;n<e;n++)r[n]=t.readFloat64();return r}e.getByteLength=function(t,e){return r.get(t)[0]*e},e.readData=function(t,e,n){return r.get(e)[1](t,n)}},9162:function(t,e,r){"use strict";e.decode=r(4530)},201:function(t){"use strict";let e={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},r={};for(var n in e)r[e[n]]=n;t.exports={tagsById:e,tagsByName:r}},1761:function(t){"use strict";let e={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},r={};for(var n in e)r[e[n]]=n;t.exports={tagsById:e,tagsByName:r}},2255:function(t){"use strict";let e={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},r={};for(var n in e)r[e[n]]=n;t.exports={tagsById:e,tagsByName:r}},5090:function(t,e,r){"use strict";let n=r(9509),i=r(5833),o=r(8100),a=r(3256),s={ignoreImageData:!1,onlyFirst:!1};class h extends n{decode(t){t=Object.assign({},s,t);let e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t)),t.onlyFirst)return e[0];return e}decodeHeader(){let t=this.readUint16();if(18761===t)this.setLittleEndian();else if(19789===t)this.setBigEndian();else throw Error("invalid byte order: 0x"+t.toString(16));if(42!==(t=this.readUint16()))throw Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t){this.seek(this._nextIFD),r=t.kind?new i(t.kind):new o;let e=this.readUint16();for(var r,n=0;n<e;n++)this.decodeIFDEntry(r);return t.ignoreImageData||this.decodeImageData(r),this._nextIFD=this.readUint32(),r}decodeIFDEntry(t){let e=this.offset,r=this.readUint16(),n=this.readUint16(),i=this.readUint32();if(n<1||n>12){this.skip(4);return}a.getByteLength(n,i)>4&&this.seek(this.readUint32());let o=a.readData(this,n,i);if(t.fields.set(r,o),34665===r||34853===r){let e,n=this.offset;34665===r?e="exif":34853===r&&(e="gps"),this._nextIFD=o,t[e]=this.decodeIFD({kind:e,ignoreImageData:!0}),this.offset=n}this.seek(e),this.skip(12)}decodeImageData(t){let e=t.orientation;switch(e&&1!==e&&d("orientation",e),t.type){case 1:case 2:this.readStripData(t);break;default:d("image type",t.type)}}readStripData(t){let e=t.width,r=t.height,n=p(t.bitsPerSample),i=t.sampleFormat,o=e*r,a=l(o,1,n,i),s=t.compression,h=t.rowsPerStrip*e,m=t.stripOffsets,g=t.stripByteCounts;for(var v=0,y=0;y<m.length;y++){var b=this.getStripData(s,m[y],g[y]),w=o>h?h:o;o-=w,8===n?v=u(a,b,v,w):16===n?v=c(a,b,v,w,this.isLittleEndian()):32===n&&3===i?v=f(a,b,v,w,this.isLittleEndian()):d("bitDepth",n)}t.data=a}getStripData(t,e,r){switch(t){case 1:return new DataView(this.buffer,e,r);case 2:case 32773:return d("Compression",t);default:throw Error("invalid compression: "+t)}}constructor(t,e){super(t,e),this._nextIFD=0}}function l(t,e,r,n){return 8===r?new Uint8Array(t*e):16===r?new Uint16Array(t*e):32===r&&3===n?new Float32Array(t*e):d("bit depth / sample format",r+" / "+n)}function u(t,e,r,n){for(var i=0;i<n;i++)t[r++]=e.getUint8(i);return r}function c(t,e,r,n,i){for(var o=0;o<2*n;o+=2)t[r++]=e.getUint16(o,i);return r}function f(t,e,r,n,i){for(var o=0;o<4*n;o+=4)t[r++]=e.getFloat32(o,i);return r}function d(t,e){throw Error("Unsupported "+t+": "+e)}function p(t){if(t.length){let r=t;t=r[0];for(var e=0;e<r.length;e++)r[e]!==t&&d("bit depth",r)}return t}t.exports=h},8100:function(t,e,r){"use strict";let n=r(5833),i=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class o extends n{get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var t=new Date,e=i.exec(this.dateTime);return t.setFullYear(e[1],e[2]-1,e[3]),t.setHours(e[4],e[5],e[6]),t}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return a(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return a(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}constructor(){super("standard")}}function a(t){return"number"==typeof t?[t]:t}t.exports=o},5363:function(t,e,r){"use strict";let n=r(9509),i=r(9162);function o(t){let e=new n(t),r={};if(e.setBigEndian(),65496!==e.readUint16())throw Error("SOI marker not found. Not a valid JPEG file");if(65505===e.readUint16()){e.readUint16();let t=e.readBytes(6);if(69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]&&0===t[4]&&0===t[5]){let t=i.decode(e,{onlyFirst:!0,ignoreImageData:!0,offset:e.offset});r.exif=t}}return r}t.exports=o},7411:function(t,e,r){"use strict";e.decode=r(5363)},446:function(t){"use strict";!function(){function e(t,e,r){this.next=r,r&&(r.prev=this),this.prev=e,e&&(e.next=this),this.data=t}function r(){if(!(this instanceof r))return new r;this._head=null,this._tail=null,this.length=0}r.prototype={push:function(t){this._tail=new e(t,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(0!==this.length){var t=this._tail;return this._tail=t.prev,t.prev&&(t.prev=this._tail.next=null),this.length--,1===this.length?this._head=this._tail:0===this.length&&(this._head=this._tail=null),t.data}},unshift:function(t){this._head=new e(t,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(0!==this.length){var t=this._head;return this._head=t.next,t.next&&(t.next=this._head.prev=null),this.length--,1===this.length?this._tail=this._head:0===this.length&&(this._head=this._tail=null),t.data}},item:function(t){t<0&&(t=this.length+t);for(var e=this._head;t-- >0&&e;)e=e.next;return e?e.data:void 0},slice:function(t,e){if(t||(t=0),e||(e=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t),e===t)return[];if(e<t)throw Error("invalid offset: "+t+","+e+" (length="+this.length+")");for(var r=e-t,n=Array(r),i=0,o=this._head;t-- >0&&o;)o=o.next;for(;i<r&&o;)n[i++]=o.data,o=o.next;return n},drop:function(){r.call(this)},forEach:function(t,e){for(var r=this._head,n=0,i=this.length;n<i&&r;)t.call(e||this,r.data,n,this),r=r.next,n++},map:function(t,e){var n=new r;return this.forEach(function(r,i,o){n.push(t.call(e||o,r,i,o))}),n},filter:function(t,e){var n=new r;return this.forEach(function(r,i,o){t.call(e||o,r,i,o)&&n.push(r)}),n},reduce:function(t,e,r){var n=0,i=this._head,o=this.length;for(e||(n=1,e=i&&i.data,i=i&&i.next);n<o&&i;)e=t.call(r||this,e,i.data,this),n++,i=i.next;return e}},t.exports=r}()},7769:function(t){"use strict";function e(t){if(this.size=0|t,this.size<=1||(this.size&this.size-1)!=0)throw Error("FFT size must be a power of two and bigger than 1");this._csize=t<<1;for(var e=Array(2*this.size),r=0;r<e.length;r+=2){let t=Math.PI*r/this.size;e[r]=Math.cos(t),e[r+1]=-Math.sin(t)}this.table=e;for(var n=0,i=1;this.size>i;i<<=1)n++;this._width=n%2==0?n-1:n,this._bitrev=Array(1<<this._width);for(var o=0;o<this._bitrev.length;o++){this._bitrev[o]=0;for(var a=0;a<this._width;a+=2){var s=this._width-a-2;this._bitrev[o]|=(o>>>a&3)<<s}}this._out=null,this._data=null,this._inv=0}t.exports=e,e.prototype.fromComplexArray=function(t,e){for(var r=e||Array(t.length>>>1),n=0;n<t.length;n+=2)r[n>>>1]=t[n];return r},e.prototype.createComplexArray=function(){let t=Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t},e.prototype.toComplexArray=function(t,e){for(var r=e||this.createComplexArray(),n=0;n<r.length;n+=2)r[n]=t[n>>>1],r[n+1]=0;return r},e.prototype.completeSpectrum=function(t){for(var e=this._csize,r=e>>>1,n=2;n<r;n+=2)t[e-n]=t[n],t[e-n+1]=-t[n+1]},e.prototype.transform=function(t,e){if(t===e)throw Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null},e.prototype.realTransform=function(t,e){if(t===e)throw Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null},e.prototype.inverseTransform=function(t,e){if(t===e)throw Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var r=0;r<t.length;r++)t[r]/=this.size;this._out=null,this._data=null},e.prototype._transform4=function(){var t,e,r=this._out,n=this._csize,i=1<<this._width,o=n/i<<1,a=this._bitrev;if(4===o)for(t=0,e=0;t<n;t+=o,e++){let r=a[e];this._singleTransform2(t,r,i)}else for(t=0,e=0;t<n;t+=o,e++){let r=a[e];this._singleTransform4(t,r,i)}var s=this._inv?-1:1,h=this.table;for(i>>=2;i>=2;i>>=2){var l=(o=n/i<<1)>>>2;for(t=0;t<n;t+=o)for(var u=t+l,c=t,f=0;c<u;c+=2,f+=i){let t=c,e=t+l,n=e+l,i=n+l,o=r[t],a=r[t+1],u=r[e],d=r[e+1],p=r[n],m=r[n+1],g=r[i],v=r[i+1],y=o,b=a,w=h[f],x=s*h[f+1],M=u*w-d*x,k=u*x+d*w,E=h[2*f],A=s*h[2*f+1],_=p*E-m*A,S=p*A+m*E,D=h[3*f],P=s*h[3*f+1],C=g*D-v*P,I=g*P+v*D,T=y+_,B=b+S,R=y-_,U=b-S,L=M+C,O=k+I,N=s*(M-C),F=s*(k-I),z=T+L,Y=B+O,X=T-L,V=B-O,j=R+F,G=U-N,q=R-F,H=U+N;r[t]=z,r[t+1]=Y,r[e]=j,r[e+1]=G,r[n]=X,r[n+1]=V,r[i]=q,r[i+1]=H}}},e.prototype._singleTransform2=function(t,e,r){let n=this._out,i=this._data,o=i[e],a=i[e+1],s=i[e+r],h=i[e+r+1],l=o+s,u=a+h,c=o-s,f=a-h;n[t]=l,n[t+1]=u,n[t+2]=c,n[t+3]=f},e.prototype._singleTransform4=function(t,e,r){let n=this._out,i=this._data,o=this._inv?-1:1,a=2*r,s=3*r,h=i[e],l=i[e+1],u=i[e+r],c=i[e+r+1],f=i[e+a],d=i[e+a+1],p=i[e+s],m=i[e+s+1],g=h+f,v=l+d,y=h-f,b=l-d,w=u+p,x=c+m,M=o*(u-p),k=o*(c-m),E=g+w,A=v+x,_=y+k,S=b-M,D=g-w,P=v-x,C=y-k,I=b+M;n[t]=E,n[t+1]=A,n[t+2]=_,n[t+3]=S,n[t+4]=D,n[t+5]=P,n[t+6]=C,n[t+7]=I},e.prototype._realTransform4=function(){var t,e,r=this._out,n=this._csize,i=1<<this._width,o=n/i<<1,a=this._bitrev;if(4===o)for(t=0,e=0;t<n;t+=o,e++){let r=a[e];this._singleRealTransform2(t,r>>>1,i>>>1)}else for(t=0,e=0;t<n;t+=o,e++){let r=a[e];this._singleRealTransform4(t,r>>>1,i>>>1)}var s=this._inv?-1:1,h=this.table;for(i>>=2;i>=2;i>>=2){var l=(o=n/i<<1)>>>1,u=l>>>1,c=u>>>1;for(t=0;t<n;t+=o)for(var f=0,d=0;f<=c;f+=2,d+=i){var p=t+f,m=p+u,g=m+u,v=g+u,y=r[p],b=r[p+1],w=r[m],x=r[m+1],M=r[g],k=r[g+1],E=r[v],A=r[v+1],_=y,S=b,D=h[d],P=s*h[d+1],C=w*D-x*P,I=w*P+x*D,T=h[2*d],B=s*h[2*d+1],R=M*T-k*B,U=M*B+k*T,L=h[3*d],O=s*h[3*d+1],N=E*L-A*O,F=E*O+A*L,z=_+R,Y=S+U,X=_-R,V=S-U,j=C+N,G=I+F,q=s*(C-N),H=s*(I-F),W=z+j,K=Y+G,J=X+H,Q=V-q;if(r[p]=W,r[p+1]=K,r[m]=J,r[m+1]=Q,0===f){var Z=z-j,$=Y-G;r[g]=Z,r[g+1]=$;continue}if(f!==c){var tt=X,te=-V,tr=z,tn=-Y,ti=-s*H,to=-s*q,ta=-s*G,ts=-s*j,th=tt+ti,tl=te+to,tu=tr+ts,tc=tn-ta,tf=t+u-f,td=t+l-f;r[tf]=th,r[tf+1]=tl,r[td]=tu,r[td+1]=tc}}}},e.prototype._singleRealTransform2=function(t,e,r){let n=this._out,i=this._data,o=i[e],a=i[e+r],s=o+a,h=o-a;n[t]=s,n[t+1]=0,n[t+2]=h,n[t+3]=0},e.prototype._singleRealTransform4=function(t,e,r){let n=this._out,i=this._data,o=this._inv?-1:1,a=2*r,s=3*r,h=i[e],l=i[e+r],u=i[e+a],c=i[e+s],f=h+u,d=h-u,p=l+c,m=o*(l-c),g=f+p,v=d,y=-m,b=f-p,w=d,x=m;n[t]=g,n[t+1]=0,n[t+2]=v,n[t+3]=y,n[t+4]=b,n[t+5]=0,n[t+6]=w,n[t+7]=x}},3991:function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty;t.exports=e=function(t,e){return n.call(e,t)},e.version=r(8365).version},3442:function(t,e,r){"use strict";r.d(e,{Ee:function(){return am}});var n,i,o,a,s,h={};r.r(h),r.d(h,{CMYK:function(){return tM},GREY:function(){return ty},HSL:function(){return tw},HSV:function(){return tx},RGB:function(){return tb}});var l={};r.r(l),r.d(l,{tagsById:function(){return tJ},tagsByName:function(){return tQ}});var u={};r.r(u),r.d(u,{tagsById:function(){return tZ},tagsByName:function(){return t$}});var c={};r.r(c),r.d(c,{tagsById:function(){return t0},tagsByName:function(){return t1}});let f={getBit(t){return this.data[d(t)]&1<<p(t)?1:0},setBit(t){this.data[d(t)]|=1<<p(t)},clearBit(t){this.data[d(t)]&=~(1<<p(t))},toggleBit(t){this.data[d(t)]^=1<<p(t)},getBitXY(t,e){return t>=this.width||e>=this.height?0:this.getBit(e*this.width+t)},setBitXY(t,e){this.setBit(e*this.width+t)},clearBitXY(t,e){this.clearBit(e*this.width+t)},toggleBitXY(t,e){this.toggleBit(e*this.width+t)}};function d(t){return t>>3}function p(t){return 7-(7&t)}function m(t){for(let e in f)t.prototype[e]=f[e]}function g(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{bitDepth:r,alpha:n,colorModel:i,components:o,channels:a}=e;if("string"!=typeof t||0===t.length)throw TypeError("processName must be a string");if(r&&(Array.isArray(r)||(r=[r]),!r.includes(this.bitDepth)))throw TypeError("The process: ".concat(t," can only be applied if bit depth is in: ").concat(r));if(n&&(Array.isArray(n)||(n=[n]),!n.includes(this.alpha)))throw TypeError("The process: ".concat(t," can only be applied if alpha is in: ").concat(n));if(i&&(Array.isArray(i)||(i=[i]),!i.includes(this.colorModel)))throw TypeError("The process: ".concat(t," can only be applied if color model is in: ").concat(i));if(o&&(Array.isArray(o)||(o=[o]),!o.includes(this.components))){let e="The process: ".concat(t," can only be applied if the number of components is in: ").concat(o);if(1===o.length&&1===o[0])throw TypeError("".concat(e,'.\rYou should transform your image using "image.grey()" before applying the algorithm.'));throw TypeError(e)}if(a&&(Array.isArray(a)||(a=[a]),!a.includes(this.channels)))throw TypeError("The process: ".concat(t," can only be applied if the number of channels is in: ").concat(a))}function v(t,e){t=t||[],"string"==typeof(e=e||{})&&(e={type:e});try{return new Blob(t,e)}catch(i){if("TypeError"!==i.name)throw i;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<t.length;n+=1)r.append(t[n]);return r.getBlob(e.type)}}function y(t){var e=t.match(/data:([^;]+)/)[1];return v([w(atob(t.replace(/^[^,]+,/,"")))],{type:e})}function b(t,e,r){return"function"==typeof t.toBlob?new Promise(function(n){t.toBlob(n,e,r)}):Promise.resolve(y(t.toDataURL(e,r)))}function w(t){for(var e=t.length,r=new ArrayBuffer(e),n=new Uint8Array(r),i=-1;++i<e;)n[i]=t.charCodeAt(i);return r}var x=r(3691),M=r(714),k=r(4355);let E=[137,80,78,71,13,10,26,10],A=[];for(let t=0;t<256;t++){let e=t;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;A[t]=e}let _=4294967295;function S(t,e,r){let n=t;for(let t=0;t<r;t++)n=A[(n^e[t])&255]^n>>>8;return n}function D(t,e){return(S(_,t,e)^_)>>>0}!function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.GREYSCALE=0]="GREYSCALE",t[t.TRUECOLOUR=2]="TRUECOLOUR",t[t.INDEXED_COLOUR=3]="INDEXED_COLOUR",t[t.GREYSCALE_ALPHA=4]="GREYSCALE_ALPHA",t[t.TRUECOLOUR_ALPHA=6]="TRUECOLOUR_ALPHA"}(n||(n={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.DEFLATE=0]="DEFLATE"}(i||(i={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.ADAPTIVE=0]="ADAPTIVE"}(o||(o={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.NO_INTERLACE=0]="NO_INTERLACE",t[t.ADAM7=1]="ADAM7"}(a||(a={}));let P=new Uint8Array(0),C="\x00",I=new Uint16Array([255]),T=255===new Uint8Array(I.buffer)[0];class B extends M.IOBuffer{decode(){for(this.decodeSignature();!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let t=0;t<E.length;t++)if(this.readUint8()!==E[t])throw Error("wrong PNG signature. Byte at ".concat(t," should be ").concat(E[t],"."))}decodeChunk(){let t=this.readUint32(),e=this.readChars(4),r=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case"tEXt":this.decodetEXt(t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t)}if(this.offset-r!==t)throw Error("Length mismatch while decoding chunk ".concat(e));if(this._checkCrc){let r=this.readUint32(),n=t+4,i=D(new Uint8Array(this.buffer,this.byteOffset+this.offset-n-4,n),n);if(i!==r)throw Error("CRC mismatch for chunk ".concat(e,". Expected ").concat(r,", found ").concat(i))}else this.skip(4)}decodeIHDR(){let t;let e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=Y(this.readUint8());let r=this.readUint8();switch(this._colorType=r,r){case n.GREYSCALE:t=1;break;case n.TRUECOLOUR:t=3;break;case n.INDEXED_COLOUR:t=1;break;case n.GREYSCALE_ALPHA:t=2;break;case n.TRUECOLOUR_ALPHA:t=4;break;default:throw Error("Unknown color type: ".concat(r))}if(this._png.channels=t,this._compressionMethod=this.readUint8(),this._compressionMethod!==i.DEFLATE)throw Error("Unsupported compression method: ".concat(this._compressionMethod));this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(t){if(t%3!=0)throw RangeError("PLTE field length must be a multiple of 3. Got ".concat(t));let e=t/3;this._hasPalette=!0;let r=[];this._palette=r;for(let t=0;t<e;t++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,t)),this.skip(t)}decodetRNS(t){switch(this._colorType){case n.GREYSCALE:case n.TRUECOLOUR:if(t%2!=0)throw RangeError("tRNS chunk length must be a multiple of 2. Got ".concat(t));if(t/2>this._png.width*this._png.height)throw Error("tRNS chunk contains more alpha values than there are pixels (".concat(t/2," vs ").concat(this._png.width*this._png.height,")"));this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break;case n.INDEXED_COLOUR:{if(t>this._palette.length)throw Error("tRNS chunk contains more alpha values than there are palette colors (".concat(t," vs ").concat(this._palette.length,")"));let e=0;for(;e<t;e++){let t=this.readByte();this._palette[e].push(t)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}default:throw Error("tRNS chunk is not supported for color type ".concat(this._colorType))}}decodeiCCP(t){let e,r="";for(;(e=this.readChar())!==C;)r+=e;let n=this.readUint8();if(n!==i.DEFLATE)throw Error("Unsupported iCCP compression method: ".concat(n));let o=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:(0,k.rr)(o)}}decodetEXt(t){let e,r="";for(;(e=this.readChar())!==C;)r+=e;this._png.text[r]=this.readChars(t-r.length-1)}decodepHYs(){let t=this.readUint32(),e=this.readUint32(),r=this.readByte();this._png.resolution={x:t,y:e,unit:r}}decodeImage(){if(this._inflator.err)throw Error("Error while decompressing the data: ".concat(this._inflator.err));let t=this._inflator.result;if(this._filterMethod!==o.ADAPTIVE)throw Error("Filter method ".concat(this._filterMethod," not supported"));if(this._interlaceMethod===a.NO_INTERLACE)this.decodeInterlaceNull(t);else throw Error("Interlace method ".concat(this._interlaceMethod," not supported"))}decodeInterlaceNull(t){let e,r;let n=this._png.height,i=this._png.channels*this._png.depth/8,o=this._png.width*i,a=new Uint8Array(this._png.height*o),s=P,h=0;for(let l=0;l<n;l++){switch(e=t.subarray(h+1,h+1+o),r=a.subarray(l*o,(l+1)*o),t[h]){case 0:R(e,r,o);break;case 1:U(e,r,o,i);break;case 2:L(e,r,s,o);break;case 3:O(e,r,s,o,i);break;case 4:N(e,r,s,o,i);break;default:throw Error("Unsupported filter: ".concat(t[h]))}s=r,h+=o+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),16===this._png.depth){let t=new Uint16Array(a.buffer);if(T)for(let e=0;e<t.length;e++)t[e]=z(t[e]);this._png.data=t}else this._png.data=a}constructor(t,e={}){super(t);let{checkCrc:r=!1}=e;this._checkCrc=r,this._inflator=new k.T_,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=i.UNKNOWN,this._filterMethod=o.UNKNOWN,this._interlaceMethod=a.UNKNOWN,this._colorType=n.UNKNOWN,this.setBigEndian()}}function R(t,e,r){for(let n=0;n<r;n++)e[n]=t[n]}function U(t,e,r,n){let i=0;for(;i<n;i++)e[i]=t[i];for(;i<r;i++)e[i]=t[i]+e[i-n]&255}function L(t,e,r,n){let i=0;if(0===r.length)for(;i<n;i++)e[i]=t[i];else for(;i<n;i++)e[i]=t[i]+r[i]&255}function O(t,e,r,n,i){let o=0;if(0===r.length){for(;o<i;o++)e[o]=t[o];for(;o<n;o++)e[o]=t[o]+(e[o-i]>>1)&255}else{for(;o<i;o++)e[o]=t[o]+(r[o]>>1)&255;for(;o<n;o++)e[o]=t[o]+(e[o-i]+r[o]>>1)&255}}function N(t,e,r,n,i){let o=0;if(0===r.length){for(;o<i;o++)e[o]=t[o];for(;o<n;o++)e[o]=t[o]+e[o-i]&255}else{for(;o<i;o++)e[o]=t[o]+r[o]&255;for(;o<n;o++)e[o]=t[o]+F(e[o-i],r[o],r[o-i])&255}}function F(t,e,r){let n=t+e-r,i=Math.abs(n-t),o=Math.abs(n-e),a=Math.abs(n-r);return i<=o&&i<=a?t:o<=a?e:r}function z(t){return(255&t)<<8|t>>8&255}function Y(t){if(1!==t&&2!==t&&4!==t&&8!==t&&16!==t)throw Error("invalid bit depth: ".concat(t));return t}let X={level:3};class V extends M.IOBuffer{encode(){return this.encodeSignature(),this.encodeIHDR(),this.encodeData(),this.encodeIEND(),this.toArray()}encodeSignature(){this.writeBytes(E)}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(i.DEFLATE),this.writeByte(o.ADAPTIVE),this.writeByte(a.NO_INTERLACE),this.writeCrc(17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),this.writeCrc(4)}encodeIDAT(t){this.writeUint32(t.length),this.writeChars("IDAT"),this.writeBytes(t),this.writeCrc(t.length+4)}encodeData(){let{width:t,height:e,channels:r,depth:n,data:i}=this._png,o=r*t,a=new M.IOBuffer().setBigEndian(),s=0;for(let t=0;t<e;t++)if(a.writeByte(0),8===n)s=q(i,a,o,s);else if(16===n)s=H(i,a,o,s);else throw Error("unreachable");let h=a.toArray(),l=(0,k.Wt)(h,this._zlibOptions);this.encodeIDAT(l)}_checkData(t){let{colorType:e,channels:r,depth:n}=G(t),i={width:j(t.width,"width"),height:j(t.height,"height"),channels:r,data:t.data,depth:n,text:{}};this._colorType=e;let o=i.width*i.height*r;if(i.data.length!==o)throw RangeError("wrong data size. Found ".concat(i.data.length,", expected ").concat(o));return i}writeCrc(t){this.writeUint32(D(new Uint8Array(this.buffer,this.byteOffset+this.offset-t,t),t))}constructor(t,e={}){super(),this._colorType=n.UNKNOWN,this._zlibOptions={...X,...e.zlib},this._png=this._checkData(t),this.setBigEndian()}}function j(t,e){if(Number.isInteger(t)&&t>0)return t;throw TypeError("".concat(e," must be a positive integer"))}function G(t){let{channels:e=4,depth:r=8}=t;if(4!==e&&3!==e&&2!==e&&1!==e)throw RangeError("unsupported number of channels: ".concat(e));if(8!==r&&16!==r)throw RangeError("unsupported bit depth: ".concat(r));let i={channels:e,depth:r,colorType:n.UNKNOWN};switch(e){case 4:i.colorType=n.TRUECOLOUR_ALPHA;break;case 3:i.colorType=n.TRUECOLOUR;break;case 1:i.colorType=n.GREYSCALE;break;case 2:i.colorType=n.GREYSCALE_ALPHA;break;default:throw Error("unsupported number of channels")}return i}function q(t,e,r,n){for(let i=0;i<r;i++)e.writeByte(t[n++]);return n}function H(t,e,r,n){for(let i=0;i<r;i++)e.writeUint16(t[n++]);return n}function W(t,e){return new B(t,e).decode()}function K(t,e){return new V(t,e).encode()}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"}(s||(s={}));var J=r(9786);let Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Z=new Uint8Array(256);for(let t=0;t<Q.length;t++)Z[Q.charCodeAt(t)]=t;function $(t){let e;let r=t.length,n="";for(e=0;e<r;e+=3)n+=Q[t[e]>>2]+Q[(3&t[e])<<4|t[e+1]>>4]+Q[(15&t[e+1])<<2|t[e+2]>>6]+Q[63&t[e+2]];return r%3==2?n="".concat(n.substring(0,n.length-1),"="):r%3==1&&(n="".concat(n.substring(0,n.length-2),"==")),n}function tt(t){let e,r,n,i,o=.75*t.length,a=t.length,s=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);let h=new Uint8Array(o);for(let o=0;o<a;o+=4)e=Z[t.charCodeAt(o)],r=Z[t.charCodeAt(o+1)],n=Z[t.charCodeAt(o+2)],i=Z[t.charCodeAt(o+3)],h[s++]=e<<2|r>>4,h[s++]=(15&r)<<4|n>>2,h[s++]=(3&n)<<6|63&i;return h}function te(t,e){let r=$(t);return"data:".concat(e,";base64,").concat(r)}let tr=self.ImageData,tn=self.Image;function ti(t,e){let r=self.document.createElement("canvas");return r.width=t,r.height=e,r}function to(t){let{withCredentials:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(r,n){let i=new self.XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.withCredentials=e,i.onload=function(t){200!==this.status?n(t):r(this.response)},i.onerror=n,i.send()})}function ta(){throw Error("createWriteStream does not exist in the browser")}function ts(){throw Error("writeFile does not exist in the browser")}function th(t){return t.includes("/")||(t="image/".concat(t)),t}function tl(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={width:t.width,height:t.height,data:t.getRGBAData()};return(0,J.encode)(r,e.quality).data}function tu(t,e){let r={width:t.width,height:t.height,channels:t.channels,depth:t.bitDepth,data:t.data};return(1===r.depth||32===r.depth)&&(r.depth=8,r.channels=4,r.data=t.getRGBAData()),K(r,e)}let tc={save(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{useCanvas:r=!1,encoder:n}=e,{format:i}=e;if(!i){let e=RegExp("\\.(?<format>[a-zA-Z]+)$").exec(t);e&&(i=e.groups.format.toLowerCase())}if(!i)throw Error("file format not provided");return new Promise((e,o)=>{let a,s;switch(i.toLowerCase()){case"png":r?a=this.getCanvas().pngStream():s=tu(this,n);break;case"jpg":case"jpeg":r?a=this.getCanvas().jpegStream():s=tl(this,n);break;case"bmp":s=(0,x.c)(this,n);break;default:throw RangeError("invalid output format: ".concat(i))}if(a){let r=ta(t);r.on("finish",e),r.on("error",o),a.pipe(r)}else s&&ts(t,s,t=>{if(t){o(t);return}e()})})},toDataURL(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"==typeof t&&(e=t,t="image/png");let{useCanvas:r=!1,encoder:n}=e;function i(e,r){return te(e(r,n),t)}return"image/bmp"===(t=th(t))?i(x.c,this):"image/png"!==t||r?"image/jpeg"!==t||r?this.getCanvas().toDataURL(t):i(tl,this):i(tu,this)},toBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{format:e="png",encoder:r}=t;switch(e.toLowerCase()){case"png":return tu(this,r);case"jpeg":case"jpg":return tl(this,r);case"bmp":return(0,x.c)(this,r);default:throw RangeError("invalid output format: ".concat(e))}},toBase64(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.async)return this.toDataURL(t,e).then(function(t){return t.substring(t.indexOf(",")+1)});{let r=this.toDataURL(t,e);return r.substring(r.indexOf(",")+1)}},toBlob(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8;return b(this.getCanvas(),t,e)},getCanvas(){let t=new tr(this.getRGBAData({clamped:!0}),this.width,this.height),e=ti(this.width,this.height);return e.getContext("2d").putImageData(t,0,0),e}};function tf(t){for(let e in tc)t.prototype[e]=tc[e]}var td=r(3991),tp=r.n(td);let tm={configurable:!0,enumerable:!1,get:void 0};function tg(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{inPlace:n=!1,returnThis:i=!0,partialArgs:o=[]}=r;return n?am.prototype[t]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];this.computed=null;let a=e.apply(this,[...o,...r]);return i?this:a}:am.prototype[t]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(this,[...o,...r])},am}function tv(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{partialArgs:n=[]}=r;return tm.get=function(){if(null===this.computed)this.computed={};else if(tp()(t,this.computed))return this.computed[t];let r=e.apply(this,n);return this.computed[t]=r,r},Object.defineProperty(am.prototype,t,tm),am}let ty="GREY",tb="RGB",tw="HSL",tx="HSV",tM="CMYK";function tk(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{clamped:e}=t;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});let r=this.width*this.height*4,n=e?new Uint8ClampedArray(r):new Uint8Array(r);return 1===this.bitDepth?tE(this,n):32===this.bitDepth?(this.checkProcessable("getRGBAData",{alpha:0}),1===this.components?tA(this,n):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[tb]}),t_(this,n))):1===this.components?tS(this,n):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[tb]}),tD(this,n)),1===this.alpha?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),tP(this,n)):tC(this,n),n}function tE(t,e){for(let r=0;r<t.size;r++){let n=t.getBit(r);e[4*r]=255*n,e[4*r+1]=255*n,e[4*r+2]=255*n}}function tA(t,e){let r=t.min[0],n=t.max[0]-r;for(let i=0;i<t.size;i++){let o=Math.floor(255*(t.data[i]-r)/n);e[4*i]=o,e[4*i+1]=o,e[4*i+2]=o}}function t_(t,e){let r=Math.min(...t.min),n=Math.max(...t.max)-r;for(let i=0;i<t.size;i++){let o=Math.floor(255*(t.data[3*i]-r)/n),a=Math.floor(255*(t.data[3*i+1]-r)/n),s=Math.floor(255*(t.data[3*i+2]-r)/n);e[4*i]=o,e[4*i+1]=a,e[4*i+2]=s}}function tS(t,e){for(let r=0;r<t.size;r++)e[4*r]=t.data[r*t.channels]>>>t.bitDepth-8,e[4*r+1]=t.data[r*t.channels]>>>t.bitDepth-8,e[4*r+2]=t.data[r*t.channels]>>>t.bitDepth-8}function tD(t,e){for(let r=0;r<t.size;r++)e[4*r]=t.data[r*t.channels]>>>t.bitDepth-8,e[4*r+1]=t.data[r*t.channels+1]>>>t.bitDepth-8,e[4*r+2]=t.data[r*t.channels+2]>>>t.bitDepth-8}function tP(t,e){for(let r=0;r<t.size;r++)e[4*r+3]=t.data[r*t.channels+t.components]>>t.bitDepth-8}function tC(t,e){for(let r=0;r<t.size;r++)e[4*r+3]=255}let tI="BINARY",tT="GREY",tB="GREYA",tR="RGB",tU="RGBA",tL="CMYK",tO="CMYKA",tN={};function tF(t){let e=tN[t];if(!e)throw RangeError("invalid image kind: ".concat(t));return e}tN[tI]={components:1,alpha:0,bitDepth:1,colorModel:ty},tN[tB]={components:1,alpha:1,bitDepth:8,colorModel:ty},tN[tT]={components:1,alpha:0,bitDepth:8,colorModel:ty},tN[tU]={components:3,alpha:1,bitDepth:8,colorModel:tb},tN[tR]={components:3,alpha:0,bitDepth:8,colorModel:tb},tN[tL]={components:4,alpha:0,bitDepth:8,colorModel:tM},tN[tO]={components:4,alpha:1,bitDepth:8,colorModel:tM};let tz=[1,8,16,32];function tY(t){let{components:e,alpha:r,bitDepth:n,colorModel:i}=t;if(!Number.isInteger(e)||e<=0)throw RangeError("invalid components: ".concat(e,". Must be a positive integer"));if(0!==r&&1!==r&&"boolean"!=typeof r)throw TypeError("invalid alpha: ".concat(r,": must be a boolean, 0 or 1"));if(!tz.includes(n))throw RangeError("invalid bitDepth: ".concat(n,". Must be one of ").concat(tz.join(", ")));if(!h[i])throw RangeError("invalid colorModel: ".concat(i,". Must be one of ").concat(Object.keys(h).join(", ")))}function tX(t,e,r){let n=e*t;return 1===r&&(n=Math.ceil(n/8)),n}function tV(t,e,r,n,i,o){let a;let s=n*t;switch(i){case 1:a=new Uint8Array(Math.ceil(s/8));break;case 8:a=new Uint8Array(s);break;case 16:a=new Uint16Array(s);break;case 32:a=new Float32Array(s);break;default:throw Error("Cannot create pixel array for bit depth ".concat(i))}if(r)for(let t=e;t<a.length;t+=n)a[t]=o;return a}var tj=r(7411),tG=r(820),tq=r.n(tG);function tH(t){if(1!==t.compression)throw Error("missing mandatory StripByteCounts field in compressed image");let e=t.rowsPerStrip*t.width*t.samplesPerPixel*(t.bitsPerSample/8);return Array(t.stripOffsets.length).fill(e)}function tW(t,e,r){let n=0;for(;n<t.length;){for(let i=r;i<e*r;i+=r)for(let e=0;e<r;e++)t[n+i+e]=t[n+i+e]+t[n+i-(r-e)]&255;n+=e*r}}function tK(t,e,r){let n=0;for(;n<t.length;){for(let i=r;i<e*r;i+=r)for(let e=0;e<r;e++)t[n+i+e]=t[n+i+e]+t[n+i-(r-e)]&65535;n+=e*r}}let tJ={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},tQ={};for(let t in tJ)tQ[tJ[t]]=Number(t);let tZ={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},t$={};for(let t in tZ)t$[tZ[t]]=Number(t);let t0={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},t1={};for(let t in t0)t1[t0[t]]=Number(t);let t2={standard:c,exif:l,gps:u};class t3{get(t){if("number"==typeof t)return this.fields.get(t);if("string"==typeof t)return this.fields.get(t2[this.kind].tagsByName[t]);throw Error("expected a number or string")}get map(){if(!this._hasMap){let t=t2[this.kind].tagsById;for(let e of this.fields.keys())t[e]&&(this._map[t[e]]=this.fields.get(e));this._hasMap=!0}return this._map}constructor(t){if(!t)throw Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=t,this._hasMap=!1,this._map={}}}let t5=new Map([[1,[1,t8]],[2,[1,t7]],[3,[2,t9]],[4,[4,et]],[5,[8,ee]],[6,[1,er]],[7,[1,t8]],[8,[2,en]],[9,[4,ei]],[10,[8,eo]],[11,[4,ea]],[12,[8,es]]]);function t4(t,e){let r=t5.get(t);if(!r)throw Error("type not found: ".concat(t));return r[0]*e}function t6(t,e,r){let n=t5.get(e);if(!n)throw Error("type not found: ".concat(e));return n[1](t,r)}function t8(t,e){if(1===e)return t.readUint8();let r=new Uint8Array(e);for(let n=0;n<e;n++)r[n]=t.readUint8();return r}function t7(t,e){let r=[],n="";for(let i=0;i<e;i++){let e=String.fromCharCode(t.readUint8());"\x00"===e?(r.push(n),n=""):n+=e}return 1===r.length?r[0]:r}function t9(t,e){if(1===e)return t.readUint16();let r=new Uint16Array(e);for(let n=0;n<e;n++)r[n]=t.readUint16();return r}function et(t,e){if(1===e)return t.readUint32();let r=new Uint32Array(e);for(let n=0;n<e;n++)r[n]=t.readUint32();return r}function ee(t,e){if(1===e)return t.readUint32()/t.readUint32();let r=Array(e);for(let n=0;n<e;n++)r[n]=t.readUint32()/t.readUint32();return r}function er(t,e){if(1===e)return t.readInt8();let r=new Int8Array(e);for(let n=0;n<e;n++)r[n]=t.readInt8();return r}function en(t,e){if(1===e)return t.readInt16();let r=new Int16Array(e);for(let n=0;n<e;n++)r[n]=t.readInt16();return r}function ei(t,e){if(1===e)return t.readInt32();let r=new Int32Array(e);for(let n=0;n<e;n++)r[n]=t.readInt32();return r}function eo(t,e){if(1===e)return t.readInt32()/t.readInt32();let r=Array(e);for(let n=0;n<e;n++)r[n]=t.readInt32()/t.readInt32();return r}function ea(t,e){if(1===e)return t.readFloat32();let r=new Float32Array(e);for(let n=0;n<e;n++)r[n]=t.readFloat32();return r}function es(t,e){if(1===e)return t.readFloat64();let r=new Float64Array(e);for(let n=0;n<e;n++)r[n]=t.readFloat64();return r}let eh=256,el=257,eu=258,ec=9,ef=[];function ed(){if(0===ef.length){for(let t=0;t<256;t++)ef.push([t]);let t=[];for(let e=256;e<4096;e++)ef.push(t)}}let ep=[511,1023,2047,4095],em=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class eg{decode(){let t=0,e=0;for(;(t=this.getNextCode())!==el;)if(t===eh){if(this.initializeTable(),(t=this.getNextCode())===el)break;this.writeString(this.stringFromCode(t)),e=t}else if(this.isInTable(t))this.writeString(this.stringFromCode(t)),this.addStringToTable(this.stringFromCode(e).concat(this.stringFromCode(t)[0])),e=t;else{let r=this.stringFromCode(e).concat(this.stringFromCode(e)[0]);this.writeString(r),this.addStringToTable(r),e=t}let r=this.outData.toArray();return new DataView(r.buffer,r.byteOffset,r.byteLength)}initializeTable(){ed(),this.tableLength=eu,this.currentBitLength=ec}writeString(t){this.outData.writeBytes(t)}stringFromCode(t){return ef[t]}isInTable(t){return t<this.tableLength}addStringToTable(t){if(ef[this.tableLength++]=t,ef.length>4096)throw ef=[],Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===em[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8);let t=this.nextData>>this.nextBits-this.currentBitLength&ep[this.currentBitLength-9];return(this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length)?257:t}constructor(t){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=eu,this.currentBitLength=ec,this.stripArray=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),this.outData=new M.IOBuffer(t.byteLength),this.initializeTable()}}function ev(t){return new eg(t).decode()}let ey=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class eb extends t3{get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let t=new Date,e=ey.exec(this.dateTime);if(null===e)throw Error("invalid dateTime: ".concat(this.dateTime));return t.setFullYear(Number(e[1]),Number(e[2])-1,Number(e[3])),t.setHours(Number(e[4]),Number(e[5]),Number(e[6])),t}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){let t=this.get("BitsPerSample");return t&&"number"!=typeof t?t[0]:t}get alpha(){let t=this.extraSamples;return!!t&&0!==t[0]}get associatedAlpha(){let t=this.extraSamples;return!!t&&1===t[0]}get extraSamples(){return ew(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return ew(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return ew(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){let t=2**this.bitsPerSample,e=this.get("ColorMap");if(!e)return;if(e.length!==3*t)throw Error("ColorMap size must be ".concat(t));let r=[];for(let n=0;n<t;n++)r.push([e[n],e[n+t],e[n+2*t]]);return r}constructor(){super("standard")}}function ew(t){return"number"==typeof t?[t]:t}var ex=r(8330);function eM(t){let e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),r=(0,ex.rr)(e);return new DataView(r.buffer,r.byteOffset,r.byteLength)}let ek={ignoreImageData:!1,onlyFirst:!1};class eE extends M.IOBuffer{get isMultiPage(){let t=0;for(this.decodeHeader();this._nextIFD;)if(t++,this.decodeIFD({ignoreImageData:!0},!0),2===t)return!0;if(1===t)return!1;throw eP("ifdCount",t)}get pageCount(){let t=0;for(this.decodeHeader();this._nextIFD;)t++,this.decodeIFD({ignoreImageData:!0},!0);if(t>0)return t;throw eP("ifdCount",t)}decode(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=Object.assign({},ek,t);let e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t,!0)),t.onlyFirst)return[e[0]];return e}decodeHeader(){let t=this.readUint16();if(18761===t)this.setLittleEndian();else if(19789===t)this.setBigEndian();else throw Error("invalid byte order: 0x".concat(t.toString(16)));if(42!==this.readUint16())throw Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t,e){let r;if(this.seek(this._nextIFD),e)r=new eb;else{if(!t.kind)throw Error("kind is missing");r=new t3(t.kind)}let n=this.readUint16();for(let t=0;t<n;t++)this.decodeIFDEntry(r);if(!t.ignoreImageData){if(!(r instanceof eb))throw Error("must be a tiff ifd");this.decodeImageData(r)}return this._nextIFD=this.readUint32(),r}decodeIFDEntry(t){let e=this.offset,r=this.readUint16(),n=this.readUint16(),i=this.readUint32();if(n<1||n>12){this.skip(4);return}t4(n,i)>4&&this.seek(this.readUint32());let o=t6(this,n,i);if(t.fields.set(r,o),34665===r||34853===r){let e=this.offset,n="exif";34665===r?n="exif":34853===r&&(n="gps"),this._nextIFD=o,t[n]=this.decodeIFD({kind:n,ignoreImageData:!0},!1),this.offset=e}this.seek(e),this.skip(12)}decodeImageData(t){let e=t.orientation;if(e&&1!==e)throw eP("orientation",e);switch(t.type){case 0:case 1:case 2:case 3:this.readStripData(t);break;default:throw eP("image type",t.type)}if(this.applyPredictor(t),this.convertAlpha(t),0===t.type){let e=Math.pow(2,t.bitsPerSample)-1;for(let r=0;r<t.data.length;r++)t.data[r]=e-t.data[r]}}readStripData(t){let e=t.width,r=t.height,n=t.bitsPerSample,i=t.sampleFormat,o=e*r*t.samplesPerPixel,a=eA(o,n,i),s=t.rowsPerStrip*e*t.samplesPerPixel,h=t.stripOffsets,l=t.stripByteCounts||tH(t),u=o,c=0;for(let e=0;e<h.length;e++){let r=new DataView(this.buffer,this.byteOffset+h[e],l[e]),o=u>s?s:u;u-=o;let f=r;switch(t.compression){case 1:break;case 5:f=ev(r);break;case 8:f=eM(r);break;case 2:throw eP("Compression","CCITT Group 3");case 32773:throw eP("Compression","PackBits");default:throw eP("Compression",t.compression)}c=this.fillUncompressed(n,i,a,f,c,o)}t.data=a}fillUncompressed(t,e,r,n,i,o){if(8===t)return e_(r,n,i,o);if(16===t)return eS(r,n,i,o,this.isLittleEndian());if(32===t&&3===e)return eD(r,n,i,o,this.isLittleEndian());throw eP("bitDepth",t)}applyPredictor(t){let e=t.bitsPerSample;switch(t.predictor){case 1:break;case 2:if(8===e)tW(t.data,t.width,t.components);else if(16===e)tK(t.data,t.width,t.components);else throw Error("Horizontal differencing is only supported for images with a bit depth of ".concat(e));break;default:throw Error("invalid predictor: ".concat(t.predictor))}}convertAlpha(t){if(t.alpha&&t.associatedAlpha){let{data:e,components:r,maxSampleValue:n}=t;for(let t=0;t<e.length;t+=r){let i=e[t+r-1];for(let o=0;o<r-1;o++)e[t+o]=Math.round(e[t+o]*n/i)}}}constructor(t){super(t),this._nextIFD=0}}function eA(t,e,r){if(8===e)return new Uint8Array(t);if(16===e)return new Uint16Array(t);if(32===e&&3===r)return new Float32Array(t);throw eP("bit depth / sample format","".concat(e," / ").concat(r))}function e_(t,e,r,n){for(let i=0;i<n;i++)t[r++]=e.getUint8(i);return r}function eS(t,e,r,n,i){for(let o=0;o<2*n;o+=2)t[r++]=e.getUint16(o,i);return r}function eD(t,e,r,n,i){for(let o=0;o<4*n;o+=4)t[r++]=e.getFloat32(o,i);return r}function eP(t,e){return Error("Unsupported ".concat(t,": ").concat(e))}function eC(t,e){return new eE(t).decode(e)}function eI(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:e="matchToPrevious",ignoreBorder:r=[0,0]}=t;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let n="matchToPrevious"===e,i=this[0],o=[];o[0]={position:[0,0],image:this[0]};let a=[0,0];for(let t=1;t<this.length;t++){let e=i.getBestMatch(this[t],{border:r});o[t]={position:[e[0]+a[0],e[1]+a[1]],image:this[t]},n&&(a[0]+=e[0],a[1]+=e[1],i=this[t])}let s=0,h=0,l=0,u=0;for(let t=0;t<o.length;t++){let e=o[t];e.position[0]>s&&(s=e.position[0]),e.position[0]<h&&(h=e.position[0]),e.position[1]>l&&(l=e.position[1]),e.position[1]<u&&(u=e.position[1])}h=0-h,u=0-u;for(let t=0;t<o.length;t++){let e=o[t];e.crop=e.image.crop({x:s-e.position[0],y:l-e.position[1],width:i.width-h-s,height:i.height-u-l})}let c=[];for(let t=0;t<o.length;t++)c[t]=o[t].crop;return new ej(c)}function eT(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].min;for(let e=1;e<this.length;e++)for(let r=0;r<t.length;r++)t[r]=Math.min(t[r],this[e].min[r]);return t}function eB(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].max;for(let e=1;e<this.length;e++)for(let r=0;r<t.length;r++)t[r]=Math.max(t[r],this[e].max[r]);return t}function eR(t){let e,r=t.reduce((t,e)=>t+e);if(0===r)throw Error("unreachable");let n=0,i=0,o=r/2;for(;;){if(t[n]>0){if(void 0!==e)return(e+n)/2;if((i+=t[n])>o)return n;i===o&&(e=n)}n++}}function eU(t){let e=0,r=0;for(let n=0;n<t.length;n++)e+=t[n],r+=t[n]*n;return 0===e?0:r/e}function eL(){this.checkProcessable("median",{bitDepth:[8,16]});let t=this.getHistograms({maxSlots:this[0].maxValue+1}),e=Array(t.length);for(let r=0;r<t.length;r++){let n=t[r];e[r]=eR(n)}return e}function eO(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistogram(t);for(let r=1;r<this.length;r++){let n=this[r].getHistogram(t);for(let t=0;t<e.length;t++)e[t]+=n[t]}return e}function eN(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistograms(t),r=e[0].length;for(let n=1;n<this.length;n++){let i=this[n].getHistograms(t);for(let t=0;t<e.length;t++)for(let n=0;n<r;n++)e[t][n]+=i[t][n]}return e}function eF(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let t=new Uint32Array(this[0].data.length);for(let e=0;e<this.length;e++){let r=this[e];for(let e=0;e<this[0].data.length;e++)t[e]+=r.data[e]}let e=am.createFrom(this[0]),r=e.data;for(let e=0;e<this[0].data.length;e++)r[e]=t[e]/this.length;return e}function ez(){this.checkProcessable("max",{bitDepth:[8,16]});let t=am.createFrom(this[0]);for(let e of(t.data.fill(0),this))for(let r=0;r<t.data.length;r++)t.data[r]=Math.max(e.data[r],t.data[r]);return t}function eY(){this.checkProcessable("max",{bitDepth:[8,16]});let t=am.createFrom(this[0]);for(let e of(t.data.fill(t.maxValue),this))for(let r=0;r<t.data.length;r++)t.data[r]=Math.min(e.data[r],t.data[r]);return t}function eX(t){t.extendMethod("matchAndCrop",eI),t.extendMethod("getMin",eT),t.extendMethod("getMax",eB),t.extendMethod("getMedian",eL),t.extendMethod("getHistogram",eO),t.extendMethod("getHistograms",eN),t.extendMethod("getAverage",eF),t.extendMethod("getAverageImage",eF),t.extendMethod("getMaxImage",ez),t.extendMethod("getMinImage",eY)}let eV={configurable:!0,enumerable:!1,get:void 0};class ej extends Array{static load(t){return Promise.all(t.map(am.load)).then(t=>new ej(t))}static extendMethod(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{inPlace:n=!1,returnThis:i=!0,partialArgs:o=[]}=r;return n?ej.prototype[t]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];this.computed=null;let a=e.apply(this,[...o,...r]);return i?this:a}:ej.prototype[t]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(this,[...o,...r])},ej}static extendProperty(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{partialArgs:n=[]}=r;return eV.get=function(){if(null===this.computed)this.computed={};else if(tp()(t,this.computed))return this.computed[t];let r=e.apply(this,n);return this.computed[t]=r,r},Object.defineProperty(ej.prototype,t,eV),ej}checkProcessable(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof t)throw TypeError("checkProcessable requires as first parameter the processName (a string)");if(0===this.size)throw TypeError("The process: ".concat(t," can not be applied on an empty stack"));this[0].checkProcessable(t,e);for(let r=1;r<this.length;r++){if((void 0===e.sameSize||e.sameSize)&&this[0].width!==this[r].width)throw TypeError("The process: ".concat(t," can not be applied if width is not identical in all images"));if((void 0===e.sameSize||e.sameSize)&&this[0].height!==this[r].height)throw TypeError("The process: ".concat(t," can not be applied if height is not identical in all images"));if((void 0===e.sameAlpha||e.sameAlpha)&&this[0].alpha!==this[r].alpha)throw TypeError("The process: ".concat(t," can not be applied if alpha is not identical in all images"));if((void 0===e.sameBitDepth||e.sameBitDepth)&&this[0].bitDepth!==this[r].bitDepth)throw TypeError("The process: ".concat(t," can not be applied if bitDepth is not identical in all images"));if((void 0===e.sameColorModel||e.sameColorModel)&&this[0].colorModel!==this[r].colorModel)throw TypeError("The process: ".concat(t," can not be applied if colorModel is not identical in all images"));if((void 0===e.sameNumberChannels||e.sameNumberChannels)&&this[0].channels!==this[r].channels)throw TypeError("The process: ".concat(t," can not be applied if channels is not identical in all images"))}}constructor(t){if(Array.isArray(t)){super(t.length);for(let e=0;e<t.length;e++)this[e]=t[e]}else"number"==typeof t?super(t):super();this.computed=null}}Array[Symbol.species]||(ej.prototype.map=function(t,e){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));let r=new ej(this.length);for(let n=0;n<this.length;n++)r[n]=t.call(e,this[n],n,this);return r}),eX(ej);let eG=/^data:[a-z]+\/(?:[a-z]+);base64,/;function eq(t,e){if("string"==typeof t)return eW(t,e);if(t instanceof ArrayBuffer)return Promise.resolve(eH(new Uint8Array(t),void 0,e&&e.ignorePalette));if(t.buffer)return Promise.resolve(eH(t,void 0,e&&e.ignorePalette));throw Error('argument to "load" must be a string or buffer.')}function eH(t,e,r){let n=tq()(t);if(n)switch(n.mime){case"image/png":return eK(t);case"image/jpeg":return eQ(t);case"image/tiff":return eZ(t,r);default:return e1(i(n.mime))}return e1(i("application/octet-stream"));function i(r){return e||te(t,r)}}function eW(t,e){let r;let n=t.slice(0,64).match(eG);return(r=null!==n?Promise.resolve(tt(t.slice(n[0].length))):to(t,e)).then(r=>eH(new Uint8Array(r),n?t:void 0,e&&e.ignorePalette))}function eK(t){let e;let r=W(t),n=r.channels,i=0;return(2===n||4===n?(e=n-1,i=1):e=n,r.palette)?eJ(r):new am(r.width,r.height,r.data,{components:e,alpha:i,bitDepth:r.depth})}function eJ(t){let e=t.width*t.height,r=t.palette[0].length,n=new Uint8Array(e*r),i=8/t.depth,o=t.depth<8?i:1,a=parseInt("1".repeat(t.depth),2),s=4===r,h=0;for(let r=0;r<e;r++){let e=Math.floor(r/o),l=t.data[e];t.depth<8&&(l=l>>>t.depth*(i-1-r%i)&a);let u=t.palette[l];n[h++]=u[0],n[h++]=u[1],n[h++]=u[2],s&&(n[h++]=u[3])}return new am(t.width,t.height,n,{components:3,alpha:s,bitDepth:8})}function eQ(t){let e;let r=(0,tj.decode)(t);r.exif&&(e=e$(r.exif));let n=(0,J.decode)(t,{useTArray:!0,maxMemoryUsageInMB:1024}),i=new am(n.width,n.height,n.data,{meta:e});if(e&&e.tiff.tags.Orientation){let t=e.tiff.tags.Orientation;t>2&&(i=i.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[t])),[2,4,5,7].includes(t)&&(i=i.flipX())}return i}function eZ(t,e){let r=eC(t);return 1===r.length?e0(r[0],e):new ej(r.map(function(t){return e0(t,e)}))}function e$(t){let e={tiff:{fields:t.fields,tags:t.map}};return t.exif&&(e.exif=t.exif),t.gps&&(e.gps=t.gps),e}function e0(t,e){if(e||3!==t.type)return new am(t.width,t.height,t.data,{components:2===t.type?3:1,alpha:t.alpha,colorModel:2===t.type?tb:ty,bitDepth:t.bitsPerSample.length?t.bitsPerSample[0]:t.bitsPerSample,meta:e$(t)});{let e=new Uint16Array(3*t.width*t.height),r=t.palette,n=0;for(let i=0;i<t.data.length;i++){let o=r[t.data[i]];e[n++]=o[0],e[n++]=o[1],e[n++]=o[2]}return new am(t.width,t.height,e,{components:3,alpha:t.alpha,colorModel:tb,bitDepth:16,meta:e$(t)})}}function e1(t,e){return e=e||{},new Promise(function(r,n){let i=new tn;i.onload=function(){let t=i.width,n=i.height,o=ti(t,n).getContext("2d");o.drawImage(i,0,0,t,n);let a=o.getImageData(0,0,t,n).data;r(new am(t,n,a,e))},i.onerror=function(){n(Error("Could not load ".concat(t)))},i.src=t})}let e2={getValueXY(t,e,r){return this.data[(e*this.width+t)*this.channels+r]},setValueXY(t,e,r,n){return this.data[(e*this.width+t)*this.channels+r]=n,this.computed=null,this},getValue(t,e){return this.data[t*this.channels+e]},setValue(t,e,r){return this.data[t*this.channels+e]=r,this.computed=null,this},getPixelXY(t,e){return this.getPixel(e*this.width+t)},setPixelXY(t,e,r){return this.setPixel(e*this.width+t,r)},getPixel(t){let e=Array(this.channels),r=t*this.channels;for(let t=0;t<this.channels;t++)e[t]=this.data[r+t];return e},setPixel(t,e){let r=t*this.channels;for(let t=0;t<e.length;t++)this.data[r+t]=e[t];return this.computed=null,this}};function e3(t){for(let e in e2)t.prototype[e]=e2[e]}function e5(t){return{width:t.width,height:t.height,components:t.components,alpha:t.alpha,colorModel:t.colorModel,bitDepth:t.bitDepth}}function e4(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{out:i}=e;if(void 0===i)return n.copy?t.clone():am.createFrom(t,r);{if(!am.isImage(i))throw TypeError("out must be an Image object");let e=Object.assign(e5(t),r);for(let t in e)if(i[t]!==e[t])throw RangeError("cannot use out. Its ".concat(t,' must be "').concat(e[t],'" (found "').concat(i[t],'")'));return i}}function e6(t,e,r){if(void 0!==e.inPlace&&"boolean"!=typeof e.inPlace)throw TypeError("inPlace option must be a boolean");if(e.inPlace){if(void 0!==e.out)throw TypeError("out option must not be set if inPlace option is true");return t}return e4(t,e,null,r)}function e8(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.checkProcessable("abs",{bitDepth:[32]});let e=e6(this,t);return e7(this,e),e}function e7(t,e){for(let r=0;r<t.data.length;r++)e.data[r]=Math.abs(t.data[r])}function e9(t,e){if(1===t.alpha&&1===e.alpha)for(let r=0;r<t.size;r++)e.data[r*e.channels+e.components]=t.data[r*t.channels+t.components]}function rt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.checkProcessable("invert",{bitDepth:[1,8,16]});let e=e6(this,t);return 1===this.bitDepth?re(this,e):(rr(this,e),this!==e&&e9(this,e)),e}function re(t,e){for(let r=0;r<t.data.length;r++)e.data[r]=~t.data[r]}function rr(t,e){for(let r=0;r<t.data.length;r+=t.channels)for(let n=0;n<t.components;n++)e.data[r+n]=t.maxValue-t.data[r+n]}function rn(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let t=0;t<this.height;t++){let e=t*this.width*this.channels;for(let t=0;t<Math.floor(this.width/2);t++){let r=t*this.channels+e,n=(this.width-t-1)*this.channels+e;for(let t=0;t<this.channels;t++){let e=this.data[r+t];this.data[r+t]=this.data[n+t],this.data[n+t]=e}}}return this}function ri(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let t=0;t<Math.floor(this.height/2);t++)for(let e=0;e<this.width;e++){let r=e*this.channels+t*this.width*this.channels,n=e*this.channels+(this.height-1-t)*this.channels*this.width;for(let t=0;t<this.channels;t++){let e=this.data[r+t];this.data[r+t]=this.data[n+t],this.data[n+t]=e}}return this}function ro(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{radius:e=1}=t;if(e<1)throw Error("radius must be greater than 1");let r=2*e+1,n=Array(r);for(let t=0;t<r;t++){n[t]=Array(r);for(let e=0;e<r;e++)n[t][e]=1/(r*r)}return this.convolution(n)}var ra=r(586),rs=r.n(ra);function rh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:r,allowAlpha:n,defaultAlpha:i}=e;return("boolean"!=typeof n&&(n=!0),void 0===r)?rl(t,i):ru(t,r,n)}function rl(t,e){let r=e?t.channels:t.components,n=Array(r);for(let t=0;t<r;t++)n[t]=t;return n}function ru(t,e,r){Array.isArray(e)||(e=[e]);for(let n=0;n<e.length;n++)e[n]=rc(t,e[n],r);return e}function rc(t,e){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(void 0===e)throw RangeError("validateChannel : the channel has to be >=0 and <".concat(t.channels));if("string"==typeof e){switch(t.colorModel){case ty:break;case tb:if("rgb".includes(e))switch(e){case"r":e=0;break;case"g":e=1;break;case"b":e=2}break;case tw:if("hsl".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"l":e=2}break;case tx:if("hsv".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"v":e=2}break;case tM:if("cmyk".includes(e))switch(e){case"c":e=0;break;case"m":e=1;break;case"y":e=2;break;case"k":e=3}break;default:throw Error("Unexpected color model: ".concat(t.colorModel))}if("a"===e){if(!t.alpha)throw Error("validateChannel : the image does not contain alpha channel");e=t.components}if("string"==typeof e)throw Error("validateChannel : undefined channel: ".concat(e))}if(e>=t.channels)throw RangeError("validateChannel : the channel has to be >=0 and <".concat(t.channels));if(!r&&e>=t.components)throw RangeError("validateChannel : alpha channel may not be selected");return e}function rf(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{radius:e=1,border:r="copy",channels:n}=t;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),e<1)throw Error("radius must be greater than 0");n=rh(this,n,!0);let i=e,o=e,a=am.createFrom(this),s=Array((2*i+1)*(2*o+1));for(let t=0;t<n.length;t++){let e=n[t];for(let t=o;t<this.height-o;t++)for(let r=i;r<this.width-i;r++){let n=0;for(let a=-o;a<=o;a++)for(let o=-i;o<=i;o++){let i=((t+a)*this.width+r+o)*this.channels+e;s[n++]=this.data[i]}let h=(t*this.width+r)*this.channels+e;a.data[h]=rs()(s)}}if(this.alpha&&!n.includes(this.channels))for(let t=this.components;t<this.data.length;t+=this.channels)a.data[t]=this.data[t];return a.setBorder({size:[i,o],algorithm:r}),a}function rd(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{radius:e=1,sigma:r,channels:n,border:i="copy"}=t;this.checkProcessable("gaussian",{bitDepth:[8,16]});let o=rp(e,r);return this.convolution([o,o],{border:i,channels:n,algorithm:"separable"})}function rp(t,e){let r=2*t+1,n=Array(r),i=e||((r-1)*.5-1)*.3+.8,o=-.5/(i*i),a=0;for(let e=0;e<r;e++){let r=e-t,i=Math.exp(o*r*r);n[e]=i,a+=i}for(let t=0;t<r;t++)n[t]/=a;return n}let rm=[[-1,0,1],[-2,0,2],[-1,0,1]],rg=[[-1,-2,-1],[0,0,0],[1,2,1]],rv=[[3,0,-3],[10,0,-10],[3,0,-3]],ry=[[3,10,3],[0,0,0],[-3,-10,-3]];var rb=r(8466),rw=r(7364),rx=r.n(rw);function rM(t){let e,r;if(Array.isArray(t)){if(Array.isArray(t[0])){if((1&t.length)==0||(1&t[0].length)==0)throw RangeError("validateKernel: Kernel rows and columns should be odd numbers");e=Math.floor(t.length/2),r=Math.floor(t[0].length/2)}else{let n=Math.sqrt(t.length);if(rx()(n))r=e=Math.floor(Math.sqrt(t.length)/2);else throw RangeError("validateKernel: Kernel array should be a square");let i=Array(n);for(let e=0;e<n;e++){i[e]=Array(n);for(let r=0;r<n;r++)i[e][r]=t[e*n+r]}t=i}}else throw Error("validateKernel: Invalid Kernel: ".concat(t));return{kernel:t,kWidth:r,kHeight:e}}function rk(t,e){return Math.round(Math.min(Math.max(t,0),e.maxValue))}function rE(t,e,r){void 0===r&&(r=Array(t.length+e.length-1)),rA(r);for(var n=0;n<t.length;n++)for(var i=0;i<e.length;i++)r[n+i]+=t[n]*e[i];return r}function rA(t){for(var e=0;e<t.length;e++)t[e]=0}function r_(t,e,r,n){let i,o,a,s;let h=Array(t.length);a=((s=e[1]).length-1)/2,o=Array(r+s.length-1),i=Array(r);for(let e=0;e<n;e++){for(let n=0;n<r;n++)i[n]=t[e*r+n];rE(i,s,o);for(let t=0;t<r;t++)h[e*r+t]=o[a+t]}a=((s=e[0]).length-1)/2,o=Array(n+s.length-1),i=Array(n);for(let t=0;t<r;t++){for(let e=0;e<n;e++)i[e]=h[e*r+t];rE(i,s,o);for(let e=0;e<n;e++)h[e*r+t]=o[a+e]}return h}r(7769),r(1846);var rS=r(3719);rS.AbstractMatrix,rS.CHO,rS.CholeskyDecomposition,rS.DistanceMatrix,rS.EVD,rS.EigenvalueDecomposition,rS.LU,rS.LuDecomposition;let rD=rS.Matrix;rS.MatrixColumnSelectionView,rS.MatrixColumnView,rS.MatrixFlipColumnView,rS.MatrixFlipRowView,rS.MatrixRowSelectionView,rS.MatrixRowView,rS.MatrixSelectionView,rS.MatrixSubView,rS.MatrixTransposeView,rS.NIPALS,rS.Nipals,rS.QR,rS.QrDecomposition;let rP=rS.SVD,rC=rS.SingularValueDecomposition;rS.SymmetricMatrix,rS.WrapperMatrix1D,rS.WrapperMatrix2D,rS.correlation,rS.covariance,rS.Matrix,rS.Matrix,rS.determinant;let rI=rS.inverse;rS.linearDependencies,rS.pseudoInverse;let rT=rS.solve;function rB(t){let e=new rP(t,{autoTranspose:!0});if(1!==e.rank)return null;let r=Math.sqrt(e.s[0]);return[e.U.to2DArray().map(t=>t[0]*r),e.V.to2DArray().map(t=>t[0]*r)]}function rR(t){let e,r,n,i,o,a,s,h,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:u,bitDepth:c,normalize:f=!1,divisor:d=1,border:p="copy",algorithm:m="auto"}=l,g={};c&&(g.bitDepth=c);let v=am.createFrom(this,g);if(u=rh(this,u,!0),"separable"!==m)({kernel:t}=rM(t));else if(!Array.isArray(t)||2!==t.length)throw RangeError("separable convolution requires two arrays of numbers to represent the kernel");if("auto"===m){let e=rB(t);null!==e?(m="separable",t=e):m=(t.length>9||t[0].length>9)&&this.width<=4096&&this.height<=4096?"fft":"direct"}"separable"===m?(e=Math.floor(t[0].length/2),r=Math.floor(t[1].length/2)):(e=Math.floor(t.length/2),r=Math.floor(t[0].length/2));let y=v.isClamped,b=Array(this.height*this.width);for(a=0;a<u.length;a++){for(o=0,s=u[a];o<this.height;o++)for(i=0;i<this.width;i++)b[n=o*this.width+i]=this.data[n*this.channels+s];if("direct"===m)h=(0,rb.direct)(b,t,{rows:this.height,cols:this.width,normalize:f,divisor:d});else if("separable"===m){if(h=r_(b,t,this.width,this.height),f){d=0;for(let e=0;e<t[0].length;e++)for(let r=0;r<t[1].length;r++)d+=t[0][e]*t[1][r]}if(1!==d)for(let t=0;t<h.length;t++)h[t]/=d}else h=(0,rb.fft)(b,t,{rows:this.height,cols:this.width,normalize:f,divisor:d});for(o=0;o<this.height;o++)for(i=0;i<this.width;i++)n=o*this.width+i,y?v.data[n*this.channels+s]=rk(h[n],v):v.data[n*this.channels+s]=h[n]}if(this.alpha&&!u.includes(this.channels))for(i=this.components;i<this.data.length;i+=this.channels)v.data[i]=this.data[i];return"periodic"!==p&&v.setBorder({size:[r,e],algorithm:p}),v}function rU(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{direction:e="xy",border:r="copy",kernelX:n,kernelY:i,channels:o,bitDepth:a=this.bitDepth}=t;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),e){case"x":if(!n)throw Error("kernelX option is missing");return rR.call(this,n,{channels:o,border:r,bitDepth:a});case"y":if(!i)throw Error("kernelY option is missing");return rR.call(this,i,{channels:o,border:r,bitDepth:a});case"xy":{if(!n)throw Error("kernelX option is missing");if(!i)throw Error("kernelY option is missing");let t=rR.call(this,n,{channels:o,border:r,bitDepth:32}),e=rR.call(this,i,{channels:o,border:r,bitDepth:32});return t.hypotenuse(e,{bitDepth:a,channels:o})}default:throw Error("Unknown parameter direction: ".concat(e))}}function rL(t){return rU.call(this,Object.assign({},t,{kernelX:rm,kernelY:rg}))}function rO(t){return rU.call(this,Object.assign({},t,{kernelX:rv,kernelY:ry}))}rS.wrap;var rN=r(9361),rF=r.n(rN);function rz(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:e="range",channels:r,min:n=this.min,max:i=this.max}=t;if(this.checkProcessable("level",{bitDepth:[8,16,32]}),(r=rh(this,{channels:r})).length!==this.channel&&(Array.isArray(n)&&n.length===this.channels&&(n=n.filter((t,e)=>r.includes(e))),Array.isArray(i)&&i.length===this.channels&&(i=i.filter((t,e)=>r.includes(e)))),"range"===e)n<0&&(n=0),i>this.maxValue&&(i=this.maxValue),Array.isArray(n)||(n=rF()(r.length,n)),Array.isArray(i)||(i=rF()(r.length,i)),rY(this,n,i,r);else throw Error("level: algorithm not implement: ".concat(e));return this}function rY(t,e,r,n){let i=1e-5,o=Array(n.length);for(let a=0;a<n.length;a++)0===e[a]&&r[a]===t.maxValue?o[a]=0:r[a]===e[a]?o[a]=0:o[a]=(t.maxValue+1-i)/(r[a]-e[a]),e[a]+=(.5-i/2)/o[a];for(let r=0;r<n.length;r++){let i=n[r];if(0!==o[r])for(let n=0;n<t.data.length;n+=t.channels)t.data[n+i]=Math.min(Math.max(0,(t.data[n+i]-e[r])*o[r]+.5|0),t.maxValue)}}var rX=r(6209),rV=r.n(rX);function rj(t){if(isNaN(t)){if(t instanceof am)return t.data;if(!rV()(t))throw Error("checkNumberArray: the value should be either a number, array or Image");return t}if(t<=0)throw Error("checkNumberArray: the value must be greater than 0");return t}function rG(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:r}=e;if(this.checkProcessable("add",{bitDepth:[8,16]}),r=rh(this,{channels:r}),isNaN(t=rj(t))){if(this.data.length!==t.length)throw Error("add: the data size is different");for(let e=0;e<r.length;e++){let n=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]+t[e+n]>>0))}}else for(let e=0;e<r.length;e++){let n=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.min(this.maxValue,this.data[e+n]+t>>0)}return this}function rq(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:r}=e;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),r=rh(this,{channels:r}),isNaN(t=rj(t))){if(this.data.length!==t.length)throw Error("subtract: the data size is different");for(let e=0;e<r.length;e++){let n=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]-t[e+n]>>0))}}else for(let e=0;e<r.length;e++){let n=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,this.data[e+n]-t>>0)}return this}function rH(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:r,absolute:n=!1}=e;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==t.width||this.height!==t.height)throw Error("subtractImage: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw Error("subtractImage: both images must have the same number of channels");let i=this.clone();r=rh(this,{channels:r});for(let e=0;e<r.length;e++){let o=r[e];for(let e=o;e<this.data.length;e+=this.channels){let r=this.data[e]-t.data[e];n?i.data[e]=Math.abs(r):i.data[e]=Math.max(r,0)}}return i}function rW(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{bitDepth:r=this.bitDepth,channels:n}=e;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==t.width||this.height!==t.height)throw Error("hypotenuse: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw Error("hypotenuse: both images must have the same number of channels");let i=am.createFrom(this,{bitDepth:r});n=rh(this,{channels:n});let o=i.isClamped;for(let e=0;e<n.length;e++){let r=n[e];for(let e=r;e<this.data.length;e+=this.channels){let r=Math.hypot(this.data[e],t.data[e]);o?i.data[e]=Math.min(Math.max(Math.round(r),0),i.maxValue):i.data[e]=r}}return i}function rK(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:r}=e;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),t<=0)throw Error("multiply: the value must be greater than 0");if(r=rh(this,{channels:r}),isNaN(t=rj(t))){if(this.data.length!==t.length)throw Error("multiply: the data size is different");for(let e=0;e<r.length;e++){let n=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]*t[e+n]>>0))}}else for(let e=0;e<r.length;e++){let n=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.min(this.maxValue,this.data[e+n]*t>>0)}return this}function rJ(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{channels:r}=e;if(this.checkProcessable("divide",{bitDepth:[8,16]}),r=rh(this,{channels:r}),isNaN(t=rj(t))){if(this.data.length!==t.length)throw Error("divide: the: the data size is different");for(let e=0;e<r.length;e++){let n=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]/t[e+n]>>0))}}else for(let e=0;e<r.length;e++){let n=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.min(this.maxValue,this.data[e+n]/t>>0)}return this}var rQ=r(9900);class rZ{predict(t){if("number"==typeof t)return this._predict(t);if((0,rQ.isAnyArray)(t)){let e=[];for(let r=0;r<t.length;r++)e.push(this._predict(t[r]));return e}throw TypeError("x must be a number or array")}_predict(){throw Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(t,e){if(!(0,rQ.isAnyArray)(t)||!(0,rQ.isAnyArray)(e)||t.length!==e.length)throw Error("x and y must be arrays of the same length");let r=t.length,n=Array(r);for(let e=0;e<r;e++)n[e]=this._predict(t[e]);let i=0,o=0,a=0,s=0,h=0,l=0,u=0;for(let t=0;t<r;t++)i+=n[t],o+=e[t],h+=n[t]*n[t],l+=e[t]*e[t],u+=n[t]*e[t],0!==e[t]&&(a+=(e[t]-n[t])*(e[t]-n[t])/e[t]),s+=(e[t]-n[t])*(e[t]-n[t]);let c=(r*u-i*o)/Math.sqrt((r*h-i*i)*(r*l-o*o));return{r:c,r2:c*c,chi2:a,rmsd:Math.sqrt(s/r)}}constructor(){if(new.target===rZ)throw Error("BaseRegression must be subclassed")}}var r$=r(7876),r0=r.n(r$);let r1={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class r2 extends rZ{_predict(t){return this.kernel.compute([t],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(t){if("kernelRidgeRegression"!==t.name)throw TypeError("not a KRR model");return new r2(!0,t)}constructor(t,e,r){if(super(),!0===t)this.alpha=e.alpha,this.inputs=e.inputs,this.kernelType=e.kernelType,this.kernelOptions=e.kernelOptions,this.kernel=new(r0())(e.kernelType,e.kernelOptions);else{t=rD.checkMatrix(t),r=Object.assign({},r1,r);let n=new(r0())(r.kernelType,r.kernelOptions),i=n.compute(t),o=t.rows;i.add(rD.eye(o,o).mul(r.lambda)),this.alpha=rT(i,e),this.inputs=t,this.kernelType=r.kernelType,this.kernelOptions=r.kernelOptions,this.kernel=n}}}function r3(t,e,r){let n=new r2(t,e,r),i=Array(this.size);for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)i[e*this.width+t]=[t,e];let o=n.predict(i),a=am.createFrom(this);for(let t=0;t<this.size;t++)a.data[t]=Math.min(this.maxValue,Math.max(0,o[t][0]));return a}function r5(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw TypeError("dilate: The number of rows and columns of the kernel must be odd");let n=!0;t:for(let t of e)for(let e of t)if(1!==e){n=!1;break t}let i=this;for(let t=0;t<r;t++)if(1===this.bitDepth){if(n){let t=i.clone();i=r7(i,t,e.length,e[0].length)}else{let t=am.createFrom(i);i=r8(i,t,e)}}else if(n){let t=am.createFrom(i);i=r6(i,t,e.length,e[0].length)}else{let t=am.createFrom(i);i=r4(i,t,e)}return i}function r4(t,e,r){let n=r.length,i=r[0].length,o=(n-1)/2,a=(i-1)/2;for(let s=0;s<t.height;s++)for(let h=0;h<t.width;h++){let l=0;for(let e=0;e<i;e++)for(let i=0;i<n;i++){if(1!==r[i][e])continue;let n=i-o+h,u=e-a+s;if(n<0||u<0||n>=t.width||u>=t.height)continue;let c=t.getValueXY(n,u,0);c>l&&(l=c)}e.setValueXY(h,s,0,l)}return e}function r6(t,e,r,n){let i=(r-1)/2,o=(n-1)/2,a=[];for(let e=0;e<t.width;e++)a.push(0);for(let r=0;r<t.height;r++){for(let e=0;e<t.width;e++){let n=0;for(let i=Math.max(0,r-o);i<Math.min(t.height,r+o+1);i++){let r=t.getValueXY(e,i,0);r>n&&(n=r)}a[e]=n}for(let n=0;n<t.width;n++){let o=0;for(let e=Math.max(0,n-i);e<Math.min(t.width,n+i+1);e++)a[e]>o&&(o=a[e]);e.setValueXY(n,r,0,o)}}return e}function r8(t,e,r){let n=r.length,i=r[0].length,o=(n-1)/2,a=(i-1)/2;for(let s=0;s<t.height;s++)for(let h=0;h<t.width;h++){let l=0;e:for(let e=0;e<i;e++)for(let i=0;i<n;i++){if(1!==r[i][e])continue;let n=i-o+h,u=e-a+s;if(!(u<0)&&!(n<0)&&!(n>=t.width)&&!(u>=t.height)&&1===t.getBitXY(n,u)){l=1;break e}}1===l&&e.setBitXY(h,s)}return e}function r7(t,e,r,n){let i=(r-1)/2,o=(n-1)/2,a=[];for(let e=0;e<t.width;e++)a.push(1);for(let r=0;r<t.height;r++){for(let e=0;e<t.width;e++){a[e]=0;for(let n=Math.max(0,r-o);n<Math.min(t.height,r+o+1);n++)if(1===t.getBitXY(e,n)){a[e]=1;break}}for(let n=0;n<t.width;n++)if(1!==e.getBitXY(n,r)){for(let o=Math.max(0,n-i);o<Math.min(t.width,n+i+1);o++)if(1===a[o]){e.setBitXY(n,r);break}}}return e}function r9(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw TypeError("erode: The number of rows and columns of the kernel must be odd");let n=!0;t:for(let t of e)for(let e of t)if(1!==e){n=!1;break t}let i=this;for(let t=0;t<r;t++)if(1===this.bitDepth){if(n){let t=i.clone();i=nn(i,t,e.length,e[0].length)}else{let t=am.createFrom(i);i=nr(i,t,e)}}else if(n){let t=am.createFrom(i);i=ne(i,t,e.length,e[0].length)}else{let t=am.createFrom(i);i=nt(i,t,e)}return i}function nt(t,e,r){let n=r.length,i=r[0].length,o=(n-1)/2,a=(i-1)/2;for(let s=0;s<t.height;s++)for(let h=0;h<t.width;h++){let l=t.maxValue;for(let e=0;e<i;e++)for(let i=0;i<n;i++){if(1!==r[i][e])continue;let n=i-o+h,u=e-a+s;if(n<0||u<0||n>=t.width||u>=t.height)continue;let c=t.getValueXY(n,u,0);c<l&&(l=c)}e.setValueXY(h,s,0,l)}return e}function ne(t,e,r,n){let i=(r-1)/2,o=(n-1)/2,a=[];for(let e=0;e<t.width;e++)a.push(0);for(let r=0;r<t.height;r++){for(let e=0;e<t.width;e++){let n=t.maxValue;for(let i=Math.max(0,r-o);i<Math.min(t.height,r+o+1);i++){let r=t.getValueXY(e,i,0);r<n&&(n=r)}a[e]=n}for(let n=0;n<t.width;n++){let o=t.maxValue;for(let e=Math.max(0,n-i);e<Math.min(t.width,n+i+1);e++)a[e]<o&&(o=a[e]);e.setValueXY(n,r,0,o)}}return e}function nr(t,e,r){let n=r.length,i=r[0].length,o=(n-1)/2,a=(i-1)/2;for(let s=0;s<t.height;s++)for(let h=0;h<t.width;h++){let l=1;e:for(let e=0;e<i;e++)for(let i=0;i<n;i++){if(1!==r[i][e])continue;let n=i-o+h,u=e-a+s;if(!(u<0)&&!(n<0)&&!(n>=t.width)&&!(u>=t.height)&&0===t.getBitXY(n,u)){l=0;break e}}1===l&&e.setBitXY(h,s)}return e}function nn(t,e,r,n){let i=(r-1)/2,o=(n-1)/2,a=[];for(let e=0;e<t.width;e++)a.push(0);for(let r=0;r<t.height;r++){for(let e=0;e<t.width;e++){a[e]=1;for(let n=Math.max(0,r-o);n<Math.min(t.height,r+o+1);n++)if(0===t.getBitXY(e,n)){a[e]=0;break}}for(let n=0;n<t.width;n++)if(0!==e.getBitXY(n,r)){for(let o=Math.max(0,n-i);o<Math.min(t.width,n+i+1);o++)if(0===a[o]){e.clearBitXY(n,r);break}}}return e}function ni(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw TypeError("open: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<r;t++)n=(n=n.erode({kernel:e})).dilate({kernel:e});return n}function no(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw TypeError("close: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<r;t++)n=n.dilate({kernel:e}).erode({kernel:e});return n}function na(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),e.length%2==0||e[0].length%2==0)throw TypeError("topHat: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<r;t++)n=n.open({kernel:e}).subtractImage(n,{absolute:!0});return n}function ns(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw TypeError("blackHat: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<r;t++)n=n.close({kernel:e}).subtractImage(n,{absolute:!0});return n}function nh(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<r;t++){let t=n.dilate({kernel:e}),r=n.erode({kernel:e});n=t.subtractImage(r,{absolute:!0})}return n}function nl(t){let e=0,r=0,n=0,i=0,o=t[0][0],a=0;for(let e=1;e<t.length;e++)t[e][0]<o&&(o=t[e][0],a=e);let s=t[(a+1)%t.length][0],h=(a+1)%t.length;for(let e=1;e<t.length;e++)t[e][0]<s&&e!==a&&(s=t[e][0],h=e);return t[h][1]<t[a][1]?(e=t[h],i=t[a],a!==(h+1)%4?(r=t[(h+1)%4],n=t[(h+2)%4]):(r=t[(h+2)%4],n=t[(h+3)%4])):(i=t[h],e=t[a],h!==(a+1)%4?(r=t[(a+1)%4],n=t[(a+2)%4]):(r=t[(a+2)%4],n=t[(a+3)%4])),[e,r,n,i]}function nu(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function nc(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function nf(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function nd(t,e,r,n,i,o){let a=Math.max(nu(t,e),nu(n,r)),s=Math.max(nu(t,n),nu(e,r)),h=0,l=0,u=Math.ceil(i/2),c=Math.ceil(o/2),f=a/s,d=[t[0],t[1],1],p=[e[0],e[1],1],m=[n[0],n[1],1],g=[r[0],r[1],1],v=nf(nc(d,g),m)/nf(nc(p,g),m),y=nf(nc(d,g),p)/nf(nc(m,g),p),b=[v*p[0]-d[0],v*p[1]-d[1],v*p[2]-d[2]],w=[y*m[0]-d[0],y*m[1]-d[1],y*m[2]-d[2]],x=b[0],M=b[1],k=b[2],E=w[0],A=w[1],_=w[2],S=1/(k*_)*(x*E-(x*_+k*E)*u+k*_*u*u+(M*A-(M*_+k*A)*c+k*_*c*c)),D=new rD([[S=S>=0?Math.sqrt(S):Math.sqrt(-S),0,u],[0,S,c],[0,0,1]]),P=rI(D.transpose()),C=rI(D),I=rD.rowVector(b),T=rD.rowVector(w),B=Math.sqrt(nf(I.mmul(P).mmul(C).to1DArray(),b)/nf(T.mmul(P).mmul(C).to1DArray(),w));return 0===B||0===f?(h=Math.ceil(a),l=Math.ceil(s)):B<f?l=Math.ceil((h=Math.ceil(a))/B):h=Math.ceil(B*(l=Math.ceil(s))),[h,l]}function np(t,e,r,n,i,o,a,s,h,l,u,c){let[f,d]=[(r*t+n*e+i)/(h*t+l*e+1),(o*t+a*e+s)/(h*t+l*e+1)];return u.getValueXY(Math.floor(f),Math.floor(d),c)}function nm(t){let e,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{calculateRatio:i=!0}=n;if(4!==t.length)throw Error("The array pts must have four elements, which are the four corners. Currently, pts have ".concat(t.length," elements"));let[o,a,s,h]=t,[l,u,c,f]=nl([o,a,s,h]);i?[e,r]=nd(l,u,c,f,this.width,this.height):(e=Math.ceil(Math.max(nu(l,u),nu(f,c))),r=Math.ceil(Math.max(nu(l,f),nu(u,c))));let d=am.createFrom(this,{width:e,height:r}),[p,m]=l,[g,v]=u,[y,b]=c,[w,x]=f,[M,k]=[0,0],[E,A]=[0,e-1],[_,S]=[r-1,e-1],[D,P]=[r-1,0],C=new rD([[M,k,1,0,0,0,-M*p,-k*p],[E,A,1,0,0,0,-E*g,-A*g],[_,S,1,0,0,0,-_*y,-k*y],[D,P,1,0,0,0,-D*w,-P*w],[0,0,0,M,k,1,-M*m,-k*m],[0,0,0,E,A,1,-E*v,-A*v],[0,0,0,_,S,1,-_*b,-S*b],[0,0,0,D,P,1,-D*x,-P*x]]),I=rD.columnVector([p,g,y,w,m,v,b,x]),[T,B,R,U,L,O,N,F]=new rC(C).solve(I).to1DArray(),z=new rD(r,e);for(let t=0;t<this.channels;t++){for(let n=0;n<r;n++)for(let r=0;r<e;r++)z.set(n,r,np(n,r,T,B,R,U,L,O,N,F,this,t));d.setMatrix(z,{channel:t})}return d}function ng(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{x:e=0,y:r=0,width:n=this.width-e,height:i=this.height-r}=t;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),e=Math.round(e),r=Math.round(r),n=Math.round(n),i=Math.round(i),e>this.width-1||r>this.height-1)throw RangeError("crop: origin (x:".concat(e,", y:").concat(r,") out of range (").concat(this.width-1,"; ").concat(this.height-1,")"));if(n<=0||i<=0)throw RangeError("crop: width and height (width:".concat(n,"; height:").concat(i,") must be positive numbers"));if(e<0||r<0)throw RangeError("crop: x and y (x:".concat(e,", y:").concat(r,") must be positive numbers"));if(n>this.width-e||i>this.height-r)throw RangeError("crop: (x: ".concat(e,", y:").concat(r,", width:").concat(n,", height:").concat(i,") size is out of range"));return 1===this.bitDepth?ny(this,new am(n,i,{kind:"BINARY",parent:this}),e,r,n,i):nv(this,am.createFrom(this,{width:n,height:i,position:[e,r]}),e,r,n,i)}function nv(t,e,r,n,i,o){let a=i*t.channels,s=n+o,h=0,l=r*t.channels;for(let r=n;r<s;r++){let n=r*t.width*t.channels+l,i=n+a;for(;n<i;n++)e.data[h++]=t.data[n]}return e}function ny(t,e,r,n,i,o){let a=i*t.channels,s=n+o,h=0,l=r*t.channels;for(let r=n;r<s;r++){let n=r*t.width*t.channels+l,i=n+a;for(;n<i;n++)t.getBit(n)&&e.setBit(h),++h}return e}function nb(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.checkProcessable("cropAlpha",{alpha:1});let{threshold:e=this.maxValue}=t,r=nw(this,e,this.components);if(-1===r)throw Error("Could not find new dimensions. Threshold may be too high.");let n=nx(this,e,this.components,r),i=nM(this,e,this.components,r),o=nk(this,e,this.components,r,n,i);return this.crop({x:r,y:n,width:o-r+1,height:i-n+1})}function nw(t,e,r){for(let n=0;n<t.width;n++)for(let i=0;i<t.height;i++)if(t.getValueXY(n,i,r)>=e)return n;return -1}function nx(t,e,r,n){for(let i=0;i<t.height;i++)for(let o=n;o<t.width;o++)if(t.getValueXY(o,i,r)>=e)return i;return -1}function nM(t,e,r,n){for(let i=t.height-1;i>=0;i--)for(let o=n;o<t.width;o++)if(t.getValueXY(o,i,r)>=e)return i;return -1}function nk(t,e,r,n,i,o){for(let a=t.width-1;a>=n;a--)for(let n=i;n<=o;n++)if(t.getValueXY(a,n,r)>=e)return a;return -1}function nE(t){if("string"==typeof t){let e=t[t.length-1];t=parseFloat(t),"%"===e&&(t/=100)}return t}function nA(t,e){if(!e)throw Error("getThreshold : the maxValue should be specified");if("string"==typeof t){if("%"!==t[t.length-1])throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(t)/100*e}if("number"==typeof t)return t<1?t*e:t;throw Error("getThreshold : the value is not valid")}function n_(t,e,r){let n=Math.round((t=nE(t))*e),i=Math.round(t*r);return n<=0&&(n=1),i<=0&&(i=1),{width:n,height:i}}function nS(t,e){if(e<0||e>=t.height)throw RangeError("row must be included between 0 and ".concat(t.height-1,". Current value: ").concat(e))}function nD(t,e){if(e<0||e>=t.width)throw RangeError("column must be included between 0 and ".concat(t.width-1,". Current value: ").concat(e))}function nP(t,e){if(e<0||e>=t.channels)throw RangeError("channel must be included between 0 and ".concat(t.channels-1,". Current value: ").concat(e))}let nC={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function nI(t){if("string"!=typeof t)throw TypeError("interpolation must be a string");if(!nC[t=t.toLowerCase()])throw RangeError("invalid interpolation algorithm: ".concat(t));return nC[t]}function nT(t,e,r){let n=this.width/e,i=this.height/r;if(this.bitDepth>1)for(let o=0;o<e;o++){let e=Math.floor((o+.5)*n);for(let n=0;n<r;n++){let r=Math.floor((n+.5)*i);for(let i=0;i<this.channels;i++)t.setValueXY(o,n,i,this.getValueXY(e,r,i))}}else for(let o=0;o<e;o++){let e=Math.floor((o+.5)*n);for(let n=0;n<r;n++){let r=Math.floor((n+.5)*i);this.getBitXY(e,r)&&t.setBitXY(o,n)}}}function nB(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{factor:e=1,interpolation:r=nC.nearestneighbor,preserveAspectRatio:n=!0}=t,i=nI(r),o=t.width,a=t.height;if(o||(o=a&&n?Math.round(this.width/this.height*a):this.width),a||(a=n?Math.round(this.height/this.width*o):this.height),{width:o,height:a}=n_(e,o,a),o===this.width&&a===this.height){let t=this.clone();return t.position=[0,0],t}let s=Math.round((this.width-o)/2),h=Math.round((this.height-a)/2),l=am.createFrom(this,{width:o,height:a,position:[s,h]});if(i===nC.nearestneighbor)nT.call(this,l,o,a);else throw Error("unsupported resize interpolation: ".concat(i));return l}function nR(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[tb]});let t=am.createFrom(this,{colorModel:tx}),e=0,r=this.data;for(let n=0;n<r.length;n+=this.channels){let i=r[n],o=r[n+1],a=r[n+2],s=Math.min(i,o,a),h=Math.max(i,o,a),l=h-s,u=0,c=0===h?0:l/h,f=h;if(h!==s){switch(h){case i:u=(o-a)/l+(o<a?6:0);break;case o:u=(a-i)/l+2;break;case a:u=(i-o)/l+4;break;default:throw Error("unreachable")}u/=6}t.data[e++]=u*this.maxValue,t.data[e++]=c*this.maxValue,t.data[e++]=f,this.alpha&&(t.data[e++]=r[n+3])}return t}function nU(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[tb]});let t=am.createFrom(this,{colorModel:tw}),e=Math.floor(this.maxValue/2),r=0,n=this.data;for(let i=0;i<n.length;i+=this.channels){let o=n[i],a=n[i+1],s=n[i+2],h=Math.max(o,a,s),l=Math.min(o,a,s),u=0,c=0,f=(h+l)/2;if(h!==l){let t=h-l;switch(c=f>e?t/(2-h-l):t/(h+l),h){case o:u=(a-s)/t+(a<s?6:0);break;case a:u=(s-o)/t+2;break;case s:u=(o-a)/t+4;break;default:throw Error("unreachable")}u/=6}t.data[r++]=u*this.maxValue,t.data[r++]=c*this.maxValue,t.data[r++]=f,this.alpha&&(t.data[r++]=n[i+3])}return t}function nL(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[tb]});let t=am.createFrom(this,{components:4,colorModel:tM}),e=0,r=this.data;for(let n=0;n<r.length;n+=this.channels){let i=r[n],o=r[n+1],a=r[n+2],s=Math.min(this.maxValue-i,this.maxValue-o,this.maxValue-a),h=(this.maxValue-i-s)/(1-s/this.maxValue),l=(this.maxValue-o-s)/(1-s/this.maxValue),u=(this.maxValue-a-s)/(1-s/this.maxValue);t.data[e++]=Math.round(h),t.data[e++]=Math.round(l),t.data[e++]=Math.round(u),t.data[e++]=Math.round(s),this.alpha&&(t.data[e++]=r[n+3])}return t}function nO(){return new am(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}let nN={luma709:(t,e,r)=>6966*t+23436*e+2366*r>>15,luma601:(t,e,r)=>9798*t+19235*e+3735*r>>15,maximum:(t,e,r)=>Math.max(t,e,r),minimum:(t,e,r)=>Math.min(t,e,r),average:(t,e,r)=>(t+e+r)/3>>0,minmax:(t,e,r)=>(Math.max(t,e,r)+Math.min(t,e,r))/2,red:t=>t,green:(t,e)=>e,blue:(t,e,r)=>r,cyan(t,e,r,n){let i=nN.black(t,e,r,n);return(n.maxValue-t-i)/(1-i/n.maxValue)>>0},magenta(t,e,r,n){let i=nN.black(t,e,r,n);return(n.maxValue-e-i)/(1-i/n.maxValue)>>0},yellow(t,e,r,n){let i=nN.black(t,e,r,n);return(n.maxValue-r-i)/(1-i/n.maxValue)>>0},black:(t,e,r,n)=>Math.min(n.maxValue-t,n.maxValue-e,n.maxValue-r),hue(t,e,r,n){let i=nN.min(t,e,r),o=nN.max(t,e,r);if(o===i)return 0;let a=0,s=o-i;switch(o){case t:a=(e-r)/s+(e<r?6:0);break;case e:a=(r-t)/s+2;break;case r:a=(t-e)/s+4;break;default:throw Error("unreachable")}return a/6*n.maxValue>>0},saturation(t,e,r,n){let i=nN.min(t,e,r),o=nN.max(t,e,r),a=o-i;return 0===o?0:a/o*n.maxValue},lightness(t,e,r){let n=nN.min(t,e,r);return(nN.max(t,e,r)+n)/2}};Object.defineProperty(nN,"luminosity",{enumerable:!1,value:nN.lightness}),Object.defineProperty(nN,"luminance",{enumerable:!1,value:nN.lightness}),Object.defineProperty(nN,"min",{enumerable:!1,value:nN.minimum}),Object.defineProperty(nN,"max",{enumerable:!1,value:nN.maximum}),Object.defineProperty(nN,"brightness",{enumerable:!1,value:nN.maximum});let nF={};function nz(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:r="luma709",keepAlpha:n=!1,mergeAlpha:i=!0}=e;if("string"!=typeof r&&"function"!=typeof r)throw TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),1===this.components&&(r="red"),n&=this.alpha,i&=this.alpha,n&&(i=!1);let o=e4(this,e,{components:1,alpha:n,colorModel:ty});if("function"==typeof r)t=r;else if(!(t=nN[r.toLowerCase()]))throw Error("unsupported grey algorithm: ".concat(r));let a=0;for(let e=0;e<this.data.length;e+=this.channels)i?o.data[a++]=rk(t(this.data[e],this.data[e+1],this.data[e+2],this)*this.data[e+this.components]/this.maxValue,this):(o.data[a++]=rk(t(this.data[e],this.data[e+1],this.data[e+2],this),this),o.alpha&&(o.data[a++]=this.data[e+this.components]));return o}function nY(t){let e=!1,r=0;for(let e=1;e<t.length-1;e++)if(t[e-1]<t[e]&&t[e+1]<t[e]&&++r>2)return!1;return 2===r&&(e=!0),e}function nX(t,e){let r=0;for(let n=0;n<=e;n++)r+=t[n];return r}function nV(t,e){let r=0;for(let n=0;n<=e;n++)r+=n*t[n];return r}function nj(t,e){let r=0;for(let n=0;n<=e;n++)r+=n*n*t[n];return r}function nG(t){let e=Array(t.length);for(let r=1;r<t.length-1;r++)e[r]=(t[r-1]+t[r]+t[r+1])/3;return e[0]=(t[0]+t[1])/3,e[t.length-1]=(t[t.length-2]+t[t.length-1])/3,e}function nq(t,e){let r;for(let n=1;n<e;n++)if(t[n-1]>t[n]&&t[n+1]>=t[n]){r=n;break}return r}function nH(t){let e=t.length,r=!1,n=0;for(let r=1;r<e-1;r++)if(t[r-1]<t[r]&&t[r+1]<t[r]&&++n>2)return!1;return 2===n&&(r=!0),r}function nW(t,e){let r=0;for(let n=0;n<=e;n++)r+=t[n];return r}Object.keys(nN).forEach(t=>{nF[t]=t});let nK={huang:function(t){let e=0;for(let r=0;r<t.length;r++)if(0!==t[r]){e=r;break}let r=t.length-1;for(let n=t.length-1;n>=e;n--)if(0!==t[n]){r=n;break}let n=1/(r-e),i=Array(t.length),o=0,a=0;for(let r=e;r<t.length;r++)o+=r*t[r],a+=t[r],i[r]=o/a;let s=Array(t.length);o=a=0;for(let e=r;e>0;e--)o+=e*t[e],a+=t[e],s[e-1]=o/a;let h=-1,l=Number.MAX_VALUE;for(let e=0;e<t.length;e++){let r,o=0;for(let a=0;a<=e;a++)(r=1/(1+n*Math.abs(a-i[e])))<1e-6||r>.999999||(o+=t[a]*(-r*Math.log(r)-(1-r)*Math.log(1-r)));for(let i=e+1;i<t.length;i++)(r=1/(1+n*Math.abs(i-s[e])))<1e-6||r>.999999||(o+=t[i]*(-r*Math.log(r)-(1-r)*Math.log(1-r)));o<l&&(l=o,h=e)}return h},intermodes:function(t){let e=t.slice(),r=0;for(;!nY(e);){let n=0,i=0,o=e[0];for(let r=0;r<t.length-1;r++)n=i,i=o,o=e[r+1],e[r]=(n+i+o)/3;if(e[t.length-1]=(i+o)/3,++r>1e4)throw Error("Intermodes Threshold not found after 10000 iterations")}let n=0;for(let r=1;r<t.length-1;r++)e[r-1]<e[r]&&e[r+1]<e[r]&&(n+=r);return Math.floor(n/2)},isodata:function(t){let e,r,n,i;let o=0;for(let e=1;e<t.length;e++)if(t[e]>0){o=e+1;break}for(;;){e=0,n=0;for(let r=0;r<o;r++)n+=t[r],e+=t[r]*r;i=0,r=0;for(let e=o+1;e<t.length;e++)r+=t[e],i+=t[e]*e;if(n>0&&r>0&&o===Math.round(((e/=n)+(i/=r))/2))break;if(++o>t.length-2)throw Error("Threshold not found")}return o},li:function(t,e){let r,n,i,o,a,s,h,l,u,c,f,d;f=.5,c=0;for(let e=0;e<t.length;e++)c+=e*t[e];c/=e,h=c;do{r=(s=h)+.5|0,n=0,o=0;for(let e=0;e<=r;e++)n+=e*t[e],o+=t[e];l=0===o?0:n/o,i=0,a=0;for(let e=r+1;e<t.length;e++)i+=e*t[e],a+=t[e];h=(d=(l-(u=0===a?0:i/a))/(Math.log(l)-Math.log(u)))<-Number.EPSILON?d-.5|0:d+.5|0}while(Math.abs(h-s)>f);return r},maxentropy:function(t,e){let r,n,i,o=Array(t.length);for(let r=0;r<t.length;r++)o[r]=t[r]/e;let a=Array(t.length),s=Array(t.length);a[0]=o[0],s[0]=1-a[0];for(let e=1;e<t.length;e++)a[e]=a[e-1]+o[e],s[e]=1-a[e];let h=0;for(let e=0;e<t.length;e++)if(Math.abs(a[e])>=Number.EPSILON){h=e;break}let l=t.length-1;for(let e=t.length-1;e>=h;e--)if(Math.abs(s[e])>=Number.EPSILON){l=e;break}let u=-1,c=Number.MIN_VALUE;for(let e=h;e<=l;e++){n=0;for(let r=0;r<=e;r++)0!==t[r]&&(n-=o[r]/a[e]*Math.log(o[r]/a[e]));i=0;for(let r=e+1;r<t.length;r++)0!==t[r]&&(i-=o[r]/s[e]*Math.log(o[r]/s[e]));c<(r=n+i)&&(c=r,u=e)}return u},mean:function(t,e){let r=0;for(let e=0;e<t.length;e++)r+=e*t[e];return Math.floor(r/e)},minerror:function(t,e){let r,n,i,o,a,s,h,l,u,c,f;let d=-2,p=0;for(let e=0;e<t.length;e++)p+=e*t[e];for(p/=e,r=p;r!==d;){let e=nX(t,r),p=nX(t,t.length-1),m=nV(t,r),g=nV(t,t.length-1),v=nj(t,r),y=nj(t,t.length-1);if(n=m/e,i=(g-m)/(p-e),o=e/p,a=(p-e)/p,l=1/(s=v/e-n*n)-1/(h=(y-v)/(p-e)-i*i),(c=(u=n/s-i/h)*u-l*(n*n/s-i*i/h+Math.log10(a*a*s/(o*o*h))))<0)break;d=r,r=isNaN(f=(u+Math.sqrt(c))/l)?d:Math.floor(f)}return r},minimum:function(t){if(t.length<2)return 0;let e=0,r=-1,n=-1,i=Array(t.length);for(let e=0;e<t.length;e++)i[e]=t[e],t[e]>0&&(n=e);for(;!nH(i);)if(i=nG(i),++e>1e4)return r;return nq(i,n)},moments:function(t,e){let r,n,i,o,a,s,h=1,l=0,u=0,c=0,f=0,d=-1,p=t.length,m=Array(p);for(let r=0;r<p;r++)m[r]=t[r]/e;for(let t=0;t<p;t++)l+=t*m[t],u+=t*t*m[t],c+=t*t*t*m[t];n=h*u-l*l,i=(-u*u+l*c)/n,a=.5*(-(o=(-(h*c)+u*l)/n)-Math.sqrt(o*o-4*i)),r=((s=.5*(-o+Math.sqrt(o*o-4*i)))-l)/(s-a);for(let t=0;t<p;t++)if((f+=m[t])>r){d=t;break}return d},otsu:function(t,e){let r=0,n=0,i=0,o=0,a=0;for(let e=0;e<t.length;e++)a+=e*t[e];for(let s=0;s<t.length;s++){let h=e-(n+=t[s]);if(0===n||0===h)continue;let l=(a-(r+=s*t[s]))/h,u=n*h*(r/n-l)*(r/n-l);u>=i&&(o=s,i=u)}return o},percentile:function(t){let e=-1,r=.5,n=Array(t.length),i=nW(t,t.length-1),o=1;for(let a=0;a<t.length;a++)n[a]=Math.abs(nW(t,a)/i-r),n[a]<o&&(o=n[a],e=a);return e},renyientropy:function(t,e){let r,n,i;let o=Array(t.length),a=Array(t.length),s=Array(t.length),h=0,l=0,u=0,c=0,f=0,d=0,p=2,m=-1;for(let r=0;r<t.length;r++)o[r]=t[r]/e;a[0]=o[0],s[0]=1-a[0];for(let e=1;e<t.length;e++)a[e]=a[e-1]+o[e],s[e]=1-a[e];r=0;for(let e=0;e<t.length;e++)if(Math.abs(a[e])>=Number.EPSILON){r=e;break}n=t.length-1;for(let e=t.length-1;e>=r;e--)if(Math.abs(s[e])>=Number.EPSILON){n=e;break}for(let e=r;e<=n;e++){let r=0,n=0,i=0;for(let s=0;s<=e;s++)0!==t[s]&&(r-=o[s]/a[e]*Math.log(o[s]/a[e])),n+=Math.sqrt(o[s]/a[e]),i+=o[s]*o[s]/(a[e]*a[e]);let g=0,v=0,y=0;for(let r=e+1;r<t.length;r++)0!==t[r]&&(g-=o[r]/s[e]*Math.log(o[r]/s[e])),v+=Math.sqrt(o[r]/s[e]),y+=o[r]*o[r]/(s[e]*s[e]);let b=r+g,w=p*(n*v>0?Math.log(n*v):0),x=m*(i*y>0?Math.log(i*y):0);b>c&&(c=b,h=e),w>f&&(f=w,l=e),x>d&&(d=x,u=e)}let g=[h,l,u];g.sort((t,e)=>t-e),i=5>=Math.abs(g[0]-g[1])?5>=Math.abs(g[1]-g[2])?[1,2,1]:[0,1,3]:5>=Math.abs(g[1]-g[2])?[3,1,0]:[1,2,1];let v=a[g[2]]-a[g[0]];return Math.round(g[0]*(a[g[0]]+.25*v*i[0])+.25*g[1]*v*i[1]+g[2]*(s[g[2]]+.25*v*i[2]))},shanbhag:function(t,e){let r,n,i,o,a=Array(t.length);for(let r=0;r<t.length;r++)a[r]=t[r]/e;let s=Array(t.length),h=Array(t.length);s[0]=a[0],h[0]=1-s[0];for(let e=1;e<t.length;e++)s[e]=s[e-1]+a[e],h[e]=1-s[e];let l=0;for(let e=0;e<t.length;e++)if(Math.abs(s[e])>=Number.EPSILON){l=e;break}let u=t.length-1;for(let e=t.length-1;e>=l;e--)if(Math.abs(h[e])>=Number.EPSILON){u=e;break}let c=-1,f=Number.MAX_VALUE;for(let e=l;e<=u;e++){i=0,r=.5/s[e];for(let t=1;t<=e;t++)i-=a[t]*Math.log(1-r*s[t-1]);i*=r,o=0,r=.5/h[e];for(let n=e+1;n<t.length;n++)o-=a[n]*Math.log(1-r*h[n]);o*=r,(n=Math.abs(i-o))<f&&(f=n,c=e)}return c},triangle:function(t){let e,r,n,i=0,o=0,a=0,s=0;for(let e=0;e<t.length;e++)if(t[e]>0){i=e;break}i>0&&i--;for(let e=t.length-1;e>0;e--)if(t[e]>0){s=e;break}s<t.length-1&&s++;for(let e=0;e<t.length;e++)t[e]>o&&(a=e,o=t[e]);let h=!1;if(a-i<s-a){h=!0;let e=0,r=t.length-1;for(;e<r;){let n=t[e];t[e]=t[r],t[r]=n,e++,r--}i=t.length-1-s,a=t.length-1-a}if(i===a)return i;n=Math.sqrt((e=t[a])*e+(r=i-a)*r),e/=n,r/=n,n=e*i+r*t[i];let l=i,u=0;for(let o=i+1;o<=a;o++){let i=e*o+r*t[o]-n;i>u&&(l=o,u=i)}if(l--,!h)return l;{let e=0,r=t.length-1;for(;e<r;){let n=t[e];t[e]=t[r],t[r]=n,e++,r--}return t.length-1-l}},yen:function(t,e){let r,n=Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]/e;let i=Array(t.length);i[0]=n[0];for(let e=1;e<t.length;e++)i[e]=i[e-1]+n[e];let o=Array(t.length);o[0]=n[0]*n[0];for(let e=1;e<t.length;e++)o[e]=o[e-1]+n[e]*n[e];let a=Array(t.length);a[t.length-1]=0;for(let e=t.length-2;e>=0;e--)a[e]=a[e+1]+n[e+1]*n[e+1];let s=-1,h=Number.MIN_VALUE;for(let e=0;e<t.length;e++)(r=-1*(o[e]*a[e]>0?Math.log(o[e]*a[e]):0)+2*(i[e]*(1-i[e])>0?Math.log(i[e]*(1-i[e])):0))>h&&(h=r,s=e);return s}},nJ={};function nQ(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:e=nJ.otsu}=t;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let r=nK[e.toLowerCase()];if(r)return r(this.getHistogram(),this.size);throw Error("unknown thresholding algorithm: ".concat(e))}Object.keys(nK).forEach(t=>{nJ[t]=t});let nZ="threshold";function n$(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:e=nZ,threshold:r=.5,useAlpha:n=!0,invert:i=!1}=t;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),r=e===nZ?nA(r,this.maxValue):nQ.call(this,t);let o=new am(this.width,this.height,{kind:"BINARY",parent:this}),a=0;if(this.alpha&&n)for(let t=0;t<this.data.length;t+=this.channels){let e=this.data[t]+(this.maxValue-this.data[t])*(this.maxValue-this.data[t+1])/this.maxValue;(i&&e<=r||!i&&e>=r)&&o.setBit(a),a++}else for(let t=0;t<this.data.length;t+=this.channels)(i&&this.data[t]<=r||!i&&this.data[t]>=r)&&o.setBit(a),a++;return o}function n0(t,e,r,n){let i=t.width,o=t.height,a=e.width,s=t.channels;for(let h=0;h<i;h++)for(let l=0;l<o;l++)for(let o=0;o<s;o++){let u=(l*i+h)*s+o,c=((n+l)*a+r+h)*s+o;e.data[c]=t.data[u]}}function n1(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{size:e=0,algorithm:r="copy",color:n}=t;if(this.checkProcessable("pad",{bitDepth:[8,16]}),"set"===r){if(n.length!==this.channels)throw Error("pad: the color array must have the same length as the number of channels. Here: ".concat(this.channels));for(let t=0;t<n.length;t++)0===n[t]&&(n[t]=.001)}else n=rF()(this.channels,null);Array.isArray(e)||(e=[e,e]);let i=this.width+2*e[0],o=this.height+2*e[1],a=this.channels,s=am.createFrom(this,{width:i,height:o});n0(this,s,e[0],e[1]);for(let t=e[0];t<i-e[0];t++)for(let r=0;r<a;r++){let h=n[r]||s.data[(e[1]*i+t)*a+r];for(let n=0;n<e[1];n++)s.data[(n*i+t)*a+r]=h;h=n[r]||s.data[((o-e[1]-1)*i+t)*a+r];for(let n=o-e[1];n<o;n++)s.data[(n*i+t)*a+r]=h}for(let t=0;t<o;t++)for(let r=0;r<a;r++){let o=n[r]||s.data[(t*i+e[0])*a+r];for(let n=0;n<e[0];n++)s.data[(t*i+n)*a+r]=o;o=n[r]||s.data[(t*i+i-e[0]-1)*a+r];for(let n=i-e[0];n<i;n++)s.data[(t*i+n)*a+r]=o}return s}function n2(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(t))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===t)return this.clone();let e=am.createFrom(this,{bitDepth:t});switch(t){case 8:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=255);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]>>8;break;case 16:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=65535);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]<<8|this.data[t];break;default:throw Error("colorDepth conversion unexpected case")}return e}function n3(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{interpolation:r=nC.nearestneighbor,width:n=this.width,height:i=this.height}=e;if("number"!=typeof t)throw TypeError("degrees must be a number");let o=nI(r),a=t*Math.PI/180,s=Math.floor(Math.abs(n*Math.cos(a))+Math.abs(i*Math.sin(a))),h=Math.floor(Math.abs(i*Math.cos(a))+Math.abs(n*Math.sin(a))),l=Math.cos(-a),u=Math.sin(-a),c=s/2,f=h/2;s%2==0?c-=.5:c=Math.floor(c),h%2==0?f-=.5:f=Math.floor(f);let d=Math.floor(n/2-c),p=Math.floor(i/2-f);if(1===this.bitDepth){let t=new am(s,h,{kind:"BINARY",parent:this});switch(o){case nC.nearestneighbor:return n4(this,t,d,p,c,f,l,u);case nC.bilinear:return n8(this,t,d,p,c,f,l,u);default:throw Error("unsupported rotate interpolation: ".concat(o))}}else{let t=am.createFrom(this,{width:s,height:h});switch(o){case nC.nearestneighbor:return n5(this,t,d,p,c,f,l,u);case nC.bilinear:return n6(this,t,d,p,c,f,l,u);default:throw Error("unsupported rotate interpolation: ".concat(o))}}}function n5(t,e,r,n,i,o,a,s){for(let h=0;h<e.width;h+=1)for(let l=0;l<e.height;l+=1)for(let u=0;u<t.channels;u++){let c=Math.round((h-i)*a-(l-o)*s+i)+r,f=Math.round((l-o)*a+(h-i)*s+o)+n;c<0||c>=t.width||f<0||f>=t.height?1===t.alpha&&u===t.channels-1?e.setValueXY(h,l,u,0):e.setValueXY(h,l,u,t.maxValue):e.setValueXY(h,l,u,t.getValueXY(c,f,u))}return e}function n4(t,e,r,n,i,o,a,s){for(let h=0;h<e.width;h+=1)for(let l=0;l<e.height;l+=1){let u=Math.round((h-i)*a-(l-o)*s+i)+r,c=Math.round((l-o)*a+(h-i)*s+o)+n;(u<0||u>=t.width||c<0||c>=t.height||t.getBitXY(u,c))&&e.setBitXY(h,l)}return e}function n6(t,e,r,n,i,o,a,s){let h=t.width*t.channels;for(let l=0;l<e.height;l++)for(let u=0;u<e.width;u++){let c=(u-i)*a-(l-o)*s+i+r,f=(l-o)*a+(u-i)*s+o+n,d=0|c,p=0|f,m=c-d,g=f-p;for(let r=0;r<t.channels;r++)if(c<0||c>=t.width||f<0||f>=t.height)1===t.alpha&&r===t.channels-1?e.setValueXY(u,l,r,0):e.setValueXY(u,l,r,t.maxValue);else{let n=(p*t.width+d)*t.channels+r,i=t.data[n],o=t.data[n+t.channels],a=t.data[n+h],s=i+m*(o-i)+g*(a-i)+m*g*(i-o-a+t.data[n+h+t.channels])|0;e.setValueXY(u,l,r,s)}}return e}function n8(t,e,r,n,i,o,a,s){let h=t.width;for(let l=0;l<e.height;l++)for(let u=0;u<e.width;u++){let c=(u-i)*a-(l-o)*s+i+r,f=(l-o)*a+(u-i)*s+o+n,d=0|c,p=0|f,m=c-d,g=f-p;if(c<0||c>=t.width||f<0||f>=t.height)e.setBitXY(u,l);else{let r=p*t.width+d,n=t.getBit(r),i=t.getBit(r+1),o=t.getBit(r+h);(n|m&i-n|g&o-n|m&g&n-i-o+t.getBit(r+1+h))>0&&e.setBitXY(u,l)}}return e}function n7(t,e){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),"number"!=typeof t)throw TypeError("angle must be a number");switch(t<0&&(t=360*Math.ceil(-t/360)+t),t%360){case 0:return this.clone();case 90:return it.call(this);case 180:return ie.call(this);case 270:return n9.call(this);default:return n3.call(this,t,e)}}function n9(){if(1===this.bitDepth){let t=new am(this.height,this.width,{kind:"BINARY",parent:this}),e=t.height-1;for(let r=0;r<this.height;r++)for(let n=0;n<this.width;n++)this.getBitXY(n,r)&&t.setBitXY(r,e-n);return t}{let t=am.createFrom(this,{width:this.height,height:this.width}),e=t.height-1;for(let r=0;r<this.height;r++)for(let n=0;n<this.width;n++)for(let i=0;i<this.channels;i++)t.setValueXY(r,e-n,i,this.getValueXY(n,r,i));return t}}function it(){if(1===this.bitDepth){let t=new am(this.height,this.width,{kind:"BINARY",parent:this}),e=t.width-1;for(let r=0;r<this.height;r++)for(let n=0;n<this.width;n++)this.getBitXY(n,r)&&t.setBitXY(e-r,n);return t}{let t=am.createFrom(this,{width:this.height,height:this.width}),e=t.width-1;for(let r=0;r<this.height;r++)for(let n=0;n<this.width;n++)for(let i=0;i<this.channels;i++)t.setValueXY(e-r,n,i,this.getValueXY(n,r,i));return t}}function ie(){if(1===this.bitDepth){let t=new am(this.width,this.height,{kind:"BINARY",parent:this}),e=t.width-1,r=t.height-1;for(let n=0;n<this.height;n++)for(let i=0;i<this.width;i++)this.getBitXY(i,n)&&t.setBitXY(e-i,r-n);return t}{let t=am.createFrom(this),e=t.width-1,r=t.height-1;for(let n=0;n<this.height;n++)for(let i=0;i<this.width;i++)for(let o=0;o<this.channels;o++)t.setValueXY(e-i,r-n,o,this.getValueXY(i,n,o));return t}}function ir(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e5(t);this.checkProcessable("insert",r);let{x:n=0,y:i=0}=e,o=e6(this,e,{copy:!0}),a=Math.min(o.height,i+t.height),s=Math.min(o.width,n+t.width);if(1===o.bitDepth)for(let e=i;e<a;e++)for(let r=n;r<s;r++)t.getBitXY(r-n,e-i)?o.setBitXY(r,e):o.clearBitXY(r,e);else for(let e=i;e<a;e++)for(let r=n;r<s;r++)o.setPixelXY(r,e,t.getPixelXY(r-n,e-i));return o}function ii(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{size:e=0,algorithm:r="copy",color:n}=t;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),"set"===r){if(n.length!==this.channels)throw Error("setBorder: the color array must have the same length as the number of channels. Here: ".concat(this.channels));for(let t=0;t<n.length;t++)0===n[t]&&(n[t]=.001)}else n=rF()(this.channels,null);Array.isArray(e)||(e=[e,e]);let i=e[0],o=e[1],a=this.channels;for(let t=i;t<this.width-i;t++)for(let e=0;e<a;e++){let r=n[e]||this.data[(t+this.width*o)*a+e];for(let n=0;n<o;n++)this.data[(n*this.width+t)*a+e]=r;r=n[e]||this.data[(t+this.width*(this.height-o-1))*a+e];for(let n=this.height-o;n<this.height;n++)this.data[(n*this.width+t)*a+e]=r}for(let t=0;t<this.height;t++)for(let e=0;e<a;e++){let r=n[e]||this.data[(t*this.width+i)*a+e];for(let n=0;n<i;n++)this.data[(t*this.width+n)*a+e]=r;r=n[e]||this.data[(t*this.width+this.width-i-1)*a+e];for(let n=this.width-i;n<this.width;n++)this.data[(t*this.width+n)*a+e]=r}return this}function io(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{preserveAlpha:e=!0}=t;if(this.checkProcessable("split",{bitDepth:[8,16]}),1===this.components)return new ej([this.clone()]);let r=new ej,n=this.data;if(this.alpha&&e)for(let t=0;t<this.components;t++){let e=am.createFrom(this,{components:1,alpha:!0,colorModel:ty}),i=0;for(let r=0;r<n.length;r+=this.channels)e.data[i++]=n[r+t],e.data[i++]=n[r+this.components];r.push(e)}else for(let t=0;t<this.channels;t++){let e=am.createFrom(this,{components:1,alpha:!1,colorModel:ty}),i=0;for(let r=0;r<n.length;r+=this.channels)e.data[i++]=n[r+t];r.push(e)}return r}function ia(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{keepAlpha:r=!1,mergeAlpha:n=!1}=e;r&=this.alpha,n&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),t=rc(this,t);let i=am.createFrom(this,{components:1,alpha:r,colorModel:ty}),o=0;for(let e=0;e<this.data.length;e+=this.channels)n?i.data[o++]=this.data[e+t]*this.data[e+this.components]/this.maxValue:(i.data[o++]=this.data[e+t],r&&(i.data[o++]=this.data[e+this.components]));return i}function is(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ih,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{mergeAlpha:r=!1,keepAlpha:n=!1}=e;r&=this.alpha,n&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let i=am.createFrom(this,{components:1,alpha:n,colorModel:ty}),o=0;for(let e=0;e<this.size;e++){let a=t(this.getPixel(e));r?i.data[o++]=a*this.data[e*this.channels+this.components]/this.maxValue:(i.data[o++]=a,n&&(i.data[o++]=this.data[e*this.channels+this.components]))}return i}function ih(t){return(t[0]+t[1]+t[2])/3}function il(t,e){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),e.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),e.width!==this.width||e.height!==this.height)throw Error("Images must have exactly the same width and height");let r=t=rc(this,t);for(let t=0;t<e.data.length;t++)this.data[r]=e.data[t],r+=this.channels;return this}function iu(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{shift:r=[0,0],average:n,channels:i,defaultAlpha:o,normalize:a,border:s=[0,0]}=e;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(s)||(s=[s,s]),i=rh(this,{channels:i,defaultAlpha:o}),this.bitDepth!==t.bitDepth)throw Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw Error("Both images must have the same colorModel");void 0===n&&(n=!0);let h=Math.max(s[0],-r[0]),l=Math.min(this.width-s[0],this.width-r[0]),u=Math.max(s[1],-r[1]),c=Math.min(this.height-s[1],this.height-r[1]),f=rF()(i.length,0);for(let e=0;e<i.length;e++){let n=i[e],o=a?this.sum[n]:Math.max(this.sum[n],t.sum[n]),s=a?t.sum[n]:Math.max(this.sum[n],t.sum[n]);if(0!==o&&0!==s)for(let i=h;i<l;i++)for(let a=u;a<c;a++){let h=i*this.multiplierX+a*this.multiplierY+n,l=h+r[0]*this.multiplierX+r[1]*this.multiplierY;f[e]+=Math.min(this.data[h]/o,t.data[l]/s)}}return n?f.reduce((t,e)=>t+e)/f.length:f}function ic(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{sampling:e=[10,10],painted:r=!1,mask:n}=t;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(e)||(e=[e,e]);let i=e[0],o=e[1],a=[],s=[],h=this.width/i,l=this.height/o,u=Math.floor(h/2);for(let t=0;t<i;t++){let t=Math.floor(l/2);for(let e=0;e<o;e++){let e=Math.round(u),r=Math.round(t);(!n||n.getBitXY(e,r))&&(a.push([e,r]),s.push(this.getPixelXY(e,r))),t+=l}u+=h}let c={xyS:a,zS:s};return r&&(c.painted=this.rgba8().paintPoints(a)),c}function id(t,e,r){let n=Array(t);for(let r=0;r<t;r++)n[r]=Array(e);if(r)for(let i=0;i<t;i++)for(let t=0;t<e;t++)n[i][t]=r;return n.width=t,n.height=e,Object.setPrototypeOf(n,id.prototype),n}function ip(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{border:r}=e;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==t.bitDepth)throw Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw Error("Both images must have the same colorModel");let n=new id(t.width,t.height,-1/0),i=Math.floor(t.width/2),o=Math.floor(t.height/2),a=i,s=o,h=!1;for(;!h;){let e=n.localSearch(i,o,-1/0);for(let i=0;i<e.length;i++){let o=e[i],h=this.getSimilarity(t,{border:r,shift:[a-o[0],s-o[1]]});n[o[0]][o[1]]=h}let l=n.localMax(i,o);l.position[0]!==i||l.position[1]!==o?(i=l.position[0],o=l.position[1]):h=!0}return[i-a,o-s]}function im(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.checkProcessable("getRow",{bitDepth:[8,16]}),nS(this,t),nP(this,e);let r=Array(this.width),n=0,i=t*this.width*this.channels+e,o=i+this.width*this.channels;for(let t=i;t<o;t+=this.channels)r[n++]=this.data[t];return r}function ig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.checkProcessable("getColumn",{bitDepth:[8,16]}),nD(this,t),nP(this,e);let r=Array(this.height),n=0,i=this.width*this.channels;for(let o=e+t*this.channels;o<this.data.length;o+=i)r[n++]=this.data[o];return r}function iv(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{channel:e}=t;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===e){if(this.components>1)throw RangeError("You need to define the channel for an image that contains more than one channel");e=0}let r=new rD(this.height,this.width);for(let t=0;t<this.height;t++)for(let n=0;n<this.width;n++)r.set(t,n,this.getValueXY(n,t,e));return r}function iy(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=new rD(t);let{channel:r}=e;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===r){if(this.components>1)throw RangeError("You need to define the channel for an image that contains more than one channel");r=0}if(this.width!==t.columns||this.height!==t.rows)throw RangeError("The size of the matrix must be equal to the size of the image");for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++)this.setValueXY(n,e,r,t.get(e,n));return this}function ib(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let t=Array(this.size),e=0;for(let r=0;r<this.data.length;r+=this.channels){let n=Array(this.components);for(let t=0;t<this.components;t++)n[t]=this.data[r+t];t[e++]=n}return t}function iw(t){let e=this,r=e.getClosestCommonParent(t),n=e.getRelativePosition(r,{defaultFurther:!0}),i=ix(e,n),o=t.getRelativePosition(r,{defaultFurther:!0}),a=ix(t,o),s=iM(i,a),h={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let r=0;r<s.length;r++){let i=s[r],a=[i[0]-n[0],i[1]-n[1]],l=[i[0]-o[0],i[1]-o[1]],u=e.getBitXY(a[0],a[1]),c=t.getBitXY(l[0],l[1]);1===u&&1===c&&h.commonWhitePixels.push(i)}for(let t=0;t<i.length;t++){let r,n;0!==t&&(r=Math.floor(t/e.width),n=t%e.width),1===e.getBitXY(r,n)&&h.whitePixelsMask1.push(i[t])}for(let e=0;e<a.length;e++){let r=0,n=0;0!==e&&(r=Math.floor(e/t.width),n=e%t.width),1===t.getBitXY(r,n)&&h.whitePixelsMask2.push(a[e])}return h}function ix(t,e){let r=[];for(let n=0;n<t.height;n++)for(let i=0;i<t.width;i++){let t=[n,i];r.push([t[0]+e[0],t[1]+e[1]])}return r}function iM(t,e){let r=0,n=0,i=[];for(;r<t.length&&n<e.length;)t[r][0]===e[n][0]&&t[r][1]===e[n][1]?(i.push(t[r]),r++,n++):t[r][0]<e[n][0]||t[r][0]===e[n][0]&&t[r][1]<e[n][1]?r++:n++;return i}function ik(t){let e,r=iE(this),n=iE(t);if(e=r>=n?iA(this,r):iA(t,n),0===r||0===n)return e;let i=this,o=t;for(;r!==n;)if(r>n){if(null===(i=i.parent))return e;r-=1}else{if(null===(o=o.parent))return e;n-=1}for(;i!==o&&null!==i&&null!==o;)if(i=i.parent,o=o.parent,null===i||null===o)return e;return i!==o?e:i}function iE(t){let e=0,r=t;for(;null!=r.parent;)r=r.parent,e++;return e}function iA(t,e){let r=t;for(;e>0;)r=r.parent,e-=1;return r}id.prototype.localMin=function(t,e){let r=this[t][e],n=[t,e];for(let i=Math.max(0,t-1);i<Math.min(this.length,t+2);i++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[i][t]<r&&(r=this[i][t],n=[i,t]);return{position:n,value:r}},id.prototype.localMax=function(t,e){let r=this[t][e],n=[t,e];for(let i=Math.max(0,t-1);i<Math.min(this.length,t+2);i++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[i][t]>r&&(r=this[i][t],n=[i,t]);return{position:n,value:r}},id.prototype.localSearch=function(t,e,r){let n=[];for(let i=Math.max(0,t-1);i<Math.min(this.length,t+2);i++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[i][t]===r&&n.push([i,t]);return n};let i_={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},iS=[[-1,0,1],[-2,0,2],[-1,0,1]],iD=[[-1,-2,-1],[0,0,0],[1,2,1]],iP={bitDepth:32,mode:"periodic"};function iC(t,e){t.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),e=Object.assign({},i_,e);let r=t.width,n=t.height,i=t.maxValue,o={sigma:e.gaussianBlur,radius:3},a=t.gaussianFilter(o),s=a.convolution(iD,iP),h=a.convolution(iS,iP),l=h.hypotenuse(s),u=t.constructor,c=new u(r,n,{kind:"GREY",bitDepth:32}),f=new u(r,n,{kind:"GREY",bitDepth:32}),d=new u(r,n,{kind:"GREY"});for(var p=1;p<r-1;p++)for(var m=1;m<n-1;m++){var g=(Math.round(Math.atan2(h.getValueXY(p,m,0),s.getValueXY(p,m,0))*(5/Math.PI))+5)%5;0===g&&(l.getValueXY(p,m,0)<=l.getValueXY(p,m-1,0)||l.getValueXY(p,m,0)<=l.getValueXY(p,m+1,0))||1===g&&(l.getValueXY(p,m,0)<=l.getValueXY(p-1,m+1,0)||l.getValueXY(p,m,0)<=l.getValueXY(p+1,m-1,0))||2===g&&(l.getValueXY(p,m,0)<=l.getValueXY(p-1,m,0)||l.getValueXY(p,m,0)<=l.getValueXY(p+1,m,0))||3===g&&(l.getValueXY(p,m,0)<=l.getValueXY(p-1,m-1,0)||l.getValueXY(p,m,0)<=l.getValueXY(p+1,m+1,0))||c.setValueXY(p,m,0,l.getValueXY(p,m,0))}for(p=0;p<r*n;++p){var v=c.data[p],y=0;v>e.highThreshold&&(y++,d.data[p]=i),v>e.lowThreshold&&y++,f.data[p]=y}var b=[];for(p=1;p<r-1;++p)for(m=1;m<n-1;++m)if(1===f.getValueXY(p,m,0)){t:for(var w=p-1;w<p+2;++w)for(var x=m-1;x<m+2;++x)if(2===f.getValueXY(w,x,0)){b.push([p,m]),d.setValueXY(p,m,0,i);break t}}for(;b.length>0;){var M=[];for(p=0;p<b.length;++p)for(m=-1;m<2;++m)for(w=-1;w<2;++w)if(0!==m||0!==w){var k=b[p][0]+m,E=b[p][1]+w;1===f.getValueXY(k,E,0)&&0===d.getValueXY(k,E,0)&&(M.push([k,E]),d.setValueXY(k,E,0,i))}b=M}return d}function iI(t){return iC(this,t)}function iT(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{position:r}=e;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!r&&!(r=t.getRelativePosition(this)))throw Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let e=am.createFrom(this,{width:t.width,height:t.height,alpha:1,position:r,parent:this});for(let n=0;n<t.width;n++)for(let i=0;i<t.height;i++){for(let t=0;t<this.channels;t++){let o=this.getValueXY(n+r[0],i+r[1],t);e.setValueXY(n,i,t,o)}t.getBitXY(n,i)||e.setValueXY(n,i,this.components,0)}return e}{let e=am.createFrom(this,{width:t.width,height:t.height,position:r,parent:this});for(let n=0;n<t.height;n++)for(let i=0;i<t.width;i++)t.getBitXY(i,n)&&this.getBitXY(i+r[0],n+r[1])&&e.setBitXY(i,n);return e}}var iB=r(446),iR=r.n(iB);function iU(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{x:e=0,y:r=0,inPlace:n=!0}=t,i=n?this:am.createFrom(this);if(this.checkProcessable("floodFill",{bitDepth:1}),this.getBitXY(e,r))return i;let o=new(iR());for(o.push(new iL(e,r));o.length>0;){let t=o.shift();i.setBitXY(t.x,t.y);for(let e=t.x+1;e<this.width&&!(i.getBitXY(e,t.y)||this.getBitXY(e,t.y));e++)i.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&o.push(new iL(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&o.push(new iL(e,t.y-1));for(let e=t.x-1;e>=0&&!(i.getBitXY(e,t.y)||this.getBitXY(e,t.y));e++)i.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&o.push(new iL(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&o.push(new iL(e,t.y-1))}return i}function iL(t,e){this.x=t,this.y=e}function iO(){return(iO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function iN(t,e,r){var n=[],i=(r/=100)*(e/=100),o=t/60,a=i*(1-Math.abs(o%2-1)),s=r-i;return{r:Math.round(255*((n=o>=0&&o<1?[i,a,0]:o>=1&&o<2?[a,i,0]:o>=2&&o<3?[0,i,a]:t>=3&&o<4?[0,a,i]:t>=4&&o<5?[a,0,i]:t>=5&&o<=6?[i,0,a]:[0,0,0])[0]+s)),g:Math.round(255*(n[1]+s)),b:Math.round(255*(n[2]+s))}}function iF(t,e,r){return{h:t,s:2*(e*=(r<50?r:100-r)/100)/(r+e)*100,v:r+e}}function iz(t,e,r){var n=iF(t,e,r);return iN(n.h,n.s,n.v)}var iY={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function iX(t){return iV(t)||iH(t)||iq(t)||ij(t)||iG(t)||iW(t)||iK(t)}function iV(t){var e=iY[t.toLowerCase()];if(e)return{r:e[0],g:e[1],b:e[2],a:100}}function ij(t){var e=t.match(/rgb\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */).map(Number);return{r:r[0],g:r[1],b:r[2],a:100}}}function iG(t){var e=t.match(/rgba\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */).map(Number);return{r:r[0],g:r[1],b:r[2],a:100*r[3]}}}function iq(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:100}}function iH(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:100}}function iW(t){var e=t.match(/hsl\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */),n=iz(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10));return iO({},n,{a:100})}}function iK(t){var e=t.match(/hsla\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */),n=parseInt(r[0],10),i=parseInt(r[1],10),o=parseInt(r[2],10),a=parseInt(100*parseFloat(r[3]),10),s=iz(n,i,o);return iO({},s,{a:a})}}function iJ(t){let e=iX(t);return[e.r,e.g,e.b,Math.round(255*e.a/100)]}function iQ(t,e,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?t+(e-t)*6*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function iZ(t,e,r){let n,i,o,a,s,h;return r/=100,0==(e/=100)?a=s=h=255*r:(i=r<=.5?r*(e+1):r+e-r*e,a=iQ(n=2*r-i,i,(o=t/360)+1/3),s=iQ(n,i,o),h=iQ(n,i,o-1/3)),{r:a,g:s,b:h}}function i$(t){let e=Array(t),r=0;for(let n=0;n<360;n+=360/t){let t=iZ(n,100,30+ ++r%4*15);e[r-1]=[Math.round(255*t.r),Math.round(255*t.g),Math.round(255*t.b)]}return e}function i0(){return[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]}function i1(t){let{color:e,colors:r,randomColors:n,numberColors:i=50}=t;if(e&&!Array.isArray(e)&&(e=iJ(e)),e)return[e];if(r)return r.map(function(t){return Array.isArray(t)?t:iJ(t)});if(n){r=Array(i);for(let t=0;t<i;t++)r[t]=i0()}return i$(i)}function i2(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{color:n="blue",colors:i,font:o="12px Helvetica",rotate:a=0}=r;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:tb}),!Array.isArray(t))throw Error("paintLabels: labels must be an array");if(!Array.isArray(e))throw Error("paintLabels: positions must be an array");if(n&&!Array.isArray(n)&&(n=iJ(n)),i=i?i.map(function(t){return Array.isArray(t)?t:iJ(t)}):[n],t.length!==e.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]);let s=this.getCanvas().getContext("2d");for(let r=0;r<t.length;r++){s.save();let n=i[r%i.length];s.fillStyle="rgba(".concat(n[0],",").concat(n[1],",").concat(n[2],",").concat(n[3]/this.maxValue,")"),s.font=o[r%o.length];let h=e[r];s.translate(h[0],h[1]),s.rotate(a[r%a.length]/180*Math.PI),s.fillText(t[r],0,0),s.restore()}return this.data=Uint8Array.from(s.getImageData(0,0,this.width,this.height).data),this}function i3(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{alpha:r=255,labels:n=[],labelsPosition:i=[],labelColor:o="blue",labelFont:a="12px Helvetica"}=e;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:tb});let s=i1(Object.assign({},e,{numberColors:t.length}));Array.isArray(t)||(t=[t]);for(let e=0;e<t.length;e++){let n=t[e],i=s[e%s.length];for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++)if(n.getBitXY(t,e))for(let o=0;o<Math.min(this.components,i.length);o++)if(255===r)this.setValueXY(t+n.position[0],e+n.position[1],o,i[o]);else{let a=this.getValueXY(t+n.position[0],e+n.position[1],o);a=Math.round((a*(255-r)+i[o]*r)/255),this.setValueXY(t+n.position[0],e+n.position[1],o,a)}}if(Array.isArray(n)&&n.length>0){let e=this.getCanvas().getContext("2d");e.fillStyle=o,e.font=a;for(let r=0;r<Math.min(t.length,n.length);r++){let o=i[r]?i[r]:t[r].position;e.fillText(n[r],o[0],o[1])}this.data=Uint8Array.from(e.getImageData(0,0,this.width,this.height).data)}return this}function i5(t,e){let r=Array(t);for(let n=0;n<t;n++)r[n]=Array(e).fill(0);return r}let i4=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],i6=[[0,1,0],[1,1,1],[0,1,0]];class i8{getPoints(){let t=this.matrix,e=[];for(let r=0;r<t.length;r++)for(let n=0;n<t[0].length;n++)t[r][n]&&e.push([n-this.halfWidth,r-this.halfHeight]);return e}getMask(){let t=new am(this.width,this.height,{kind:tI});for(let e=0;e<this.matrix.length;e++)for(let r=0;r<this.matrix[0].length;r++)this.matrix[e][r]&&t.setBitXY(r,e);return t}constructor(t={}){let{kind:e="cross",shape:r,size:n,width:i,height:o,filled:a=!0}=t;if(n&&(i=n,o=n),r)switch(r.toLowerCase()){case"square":case"rectangle":this.matrix=i7(i,o,{filled:a});break;case"circle":case"ellipse":this.matrix=i9(i,o,{filled:a});break;case"triangle":this.matrix=ot(i,o,{filled:a});break;default:throw Error("Shape: unexpected shape: ".concat(r))}else if(e)switch(e.toLowerCase()){case"cross":this.matrix=i4;break;case"smallcross":this.matrix=i6;break;default:throw Error("Shape: unexpected kind: ".concat(e))}else throw Error("Shape: expected a kind or a shape option");this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2>>0,this.halfWidth=this.width/2>>0}}function i7(t,e,r){let n=i5(e,t);if(r.filled)for(let r=0;r<e;r++)for(let e=0;e<t;e++)n[r][e]=1;else{for(let r of[0,e-1])for(let e=0;e<t;e++)n[r][e]=1;for(let r=0;r<e;r++)for(let e of[0,t-1])n[r][e]=1}return n}function i9(t,e,r){let n=i5(e,t,r),i=1-e%2,o=1-t%2,a=Math.floor((t-1)/2),s=Math.floor((e-1)/2),h=a*a,l=s*s;if(r.filled)for(let e=0;e<=s;e++){let r=Math.floor(Math.sqrt(h-h*e*e/l));for(let o=a-r;o<=a;o++)n[s-e][o]=1,n[s+e+i][o]=1,n[s-e][t-o-1]=1,n[s+e+i][t-o-1]=1}else{for(let e=0;e<=s;e++){let r=a-Math.floor(Math.sqrt(h-h*e*e/l));n[s-e][r]=1,n[s+e+i][r]=1,n[s-e][t-r-1]=1,n[s+e+i][t-r-1]=1}for(let t=0;t<=a;t++){let r=s-Math.floor(Math.sqrt(l-l*t*t/h));n[r][a-t]=1,n[r][a+t+o]=1,n[e-r-1][a-t]=1,n[e-r-1][a+t+o]=1}}return n}function ot(t,e,r){if(!r.filled)throw Error("Non filled triangle is not implemented");let n=i5(e,t,r);for(let r=0;r<e;r++){let i=Math.floor((1-r/e)*t/2);for(let e=i;e<t-i;e++)n[r][e]=1}return n}function oe(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{shape:r}=e;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let n=i1(Object.assign({},e,{numberColors:t.length})),i=new i8(r).getPoints(),o=Math.min(this.channels,n[0].length);for(let e=0;e<t.length;e++){let r=n[e%n.length],a=t[e][0],s=t[e][1];for(let t=0;t<i.length;t++){let e=i[t][0],n=i[t][1];if(a+e>=0&&s+n>=0&&a+e<this.width&&s+n<this.height){let t=(a+e+(s+n)*this.width)*this.channels;for(let e=0;e<o;e++)this.data[t+e]=r[e]}}}return this}function or(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{color:r=[this.maxValue,0,0],closed:n=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let i=Math.min(this.channels,r.length);for(let e=0;e<t.length-1+n;e++){let n=t[e],o=t[(e+1)%t.length],a=o[0]-n[0],s=o[1]-n[1],h=Math.max(Math.abs(a),Math.abs(s)),l=a/h,u=s/h,c=n[0],f=n[1];for(let t=0;t<=h;t++){let t=Math.round(c),e=Math.round(f);if(t>=0&&e>=0&&t<this.width&&e<this.height){if(1===this.bitDepth)this.setBitXY(t,e);else{let n=(t+e*this.width)*this.channels;for(let t=0;t<i;t++)this.data[n+t]=r[t]}}c+=l,f+=u}}return this}function on(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object.assign({},e);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let n=i1(Object.assign({},e,{numberColors:t.length}));for(let e=0;e<t.length;e++)r.color=n[e%n.length],this.paintPolyline(t[e],r);return this}function oi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{color:r=[this.maxValue,0,0],filled:n=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),e.closed=!0;let i=oo(t);if(!1===n)return this.paintPolyline(t,e);{let n=Array(this.height);for(let t=0;t<this.height;t++){n[t]=[];for(let e=0;e<this.width;e++)n[t].push(0)}for(let t=0;t<i.length;t++){let e=oa(i[t],i[(t+1)%i.length]);for(let t=0;t<this.height;t++)for(let r=0;r<this.width;r++)os(r,t,e,this.height)&&(n[t][r]=0===n[t][r]?1:0)}for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)if(1===n[t][e]){if(1===this.bitDepth)this.setBitXY(e,t);else{let n=Math.min(this.channels,r.length),i=(e+t*this.width)*this.channels;for(let t=0;t<n;t++)this.data[i+t]=r[t]}}return this.paintPolyline(t,e)}}function oo(t){let e=[];for(let r=0;r<t.length;r++)if(t[r][0]!==t[(r+1)%t.length][0]||t[r][1]!==t[(r+1)%t.length][1]){if(t[r][0]===t[(r-1+t.length)%t.length][0]&&t[r][1]===t[(r-1+t.length)%t.length][1])continue;if(t[(r+1)%t.length][0]===t[(r-1+t.length)%t.length][0]&&t[(r-1+t.length)%t.length][1]===t[(r+1)%t.length][1])continue;e.push(t[r])}return e}function oa(t,e){if(t[0]===e[0])return{a:0,b:t[0],vertical:!0};{let r=(e[1]-t[1])/(e[0]-t[0]),n=t[1]-r*t[0];return{a:r,b:n,vertical:!1}}}function os(t,e,r,n){if(!0===r.vertical)return r.b<=t;if(0===r.a)return!1;{let i=(e-r.b)/r.a;return i<t&&i>=0&&i<=n}}function oh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object.assign({},e);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let n=i1(Object.assign({},e,{numberColors:t.length}));for(let e=0;e<t.length;e++)r.color=n[e%n.length],this.paintPolygon(t[e],r);return this}function ol(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{maxSlots:e=256,channel:r,useAlpha:n=!0}=t;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),void 0===r){if(this.components>1)throw RangeError("You need to define the channel for an image that contains more than one channel");r=0}return oc.call(this,r,{useAlpha:n,maxSlots:e})}function ou(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{maxSlots:e=256,useAlpha:r=!0}=t;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let n=Array(r?this.components:this.channels);for(let t=0;t<n.length;t++)n[t]=oc.call(this,t,{useAlpha:r,maxSlots:e});return n}function oc(t,e){let{useAlpha:r,maxSlots:n}=e;if(1===this.bitDepth){let t=[0,0];for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++){let n=this.getBitXY(e,r);0===n?t[0]+=1:1===n&&(t[1]+=1)}return t}let i=Math.log2(n);if(!rx()(i))throw RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let o=0;this.bitDepth>i&&(o=this.bitDepth-i);let a=this.data,s=rF()(Math.pow(2,Math.min(this.bitDepth,i)),0);if(r&&this.alpha){let e=this.channels-t-1;for(let r=t;r<a.length;r+=this.channels)s[a[r]>>o]+=a[r+e]/this.maxValue}else for(let e=t;e<a.length;e+=this.channels)s[a[e]>>o]++;return s}function of(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{useAlpha:e=!0,nbSlots:r=512}=t;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let n=Math.log(r)/Math.log(8);if(n!==Math.floor(n))throw RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let i=this.bitDepth-n,o=this.data,a=rF()(Math.pow(8,n),0),s=Math.pow(2,2*n),h=Math.pow(2,n);for(let t=0;t<o.length;t+=this.channels){let r=(o[t]>>i)*s+(o[t+1]>>i)*h+(o[t+2]>>i);e&&this.alpha?a[r]+=o[t+this.channels-1]/this.maxValue:a[r]++}return a}function od(){this.checkProcessable("min",{bitDepth:[8,16,32]});let t=rF()(this.channels,Infinity);for(let e=0;e<this.data.length;e+=this.channels)for(let r=0;r<this.channels;r++)this.data[e+r]<t[r]&&(t[r]=this.data[e+r]);return t}function op(){this.checkProcessable("max",{bitDepth:[8,16,32]});let t=rF()(this.channels,-1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let r=0;r<this.channels;r++)this.data[e+r]>t[r]&&(t[r]=this.data[e+r]);return t}function om(){this.checkProcessable("sum",{bitDepth:[8,16]});let t=rF()(this.channels,0);for(let e=0;e<this.data.length;e+=this.channels)for(let r=0;r<this.channels;r++)t[r]+=this.data[e+r];return t}function og(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.checkProcessable("getMoment",{bitDepth:[1]});let r=0;for(let n=0;n<this.width;n++)for(let i=0;i<this.height;i++)1===this.getBitXY(n,i)&&(r+=n**t*i**e);return r}function ov(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{mask:e,region:r=3,removeClosePoints:n=0,invert:i=!1,maxEquals:o=2}=t,a=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1});let s=i?0:1,h=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],l=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],u=(r*=4)<=8?1:2,c=[];for(let t=u;t<a.height-u;t++)for(let n=u;n<a.width-u;n++){if(e&&e.getBitXY(n,t)!==s)continue;let u=0,f=0,d=a.data[n+t*a.width];for(let e=0;e<r;e++)i?a.data[n+h[e]+(t+l[e])*a.width]>d&&u++:a.data[n+h[e]+(t+l[e])*a.width]<d&&u++,a.data[n+h[e]+(t+l[e])*a.width]===d&&f++;u+f===r&&f<=o&&c.push([n,t])}if(n>0)for(let t=0;t<c.length;t++)for(let e=t+1;e<c.length;e++)Math.sqrt(Math.pow(c[t][0]-c[e][0],2)+Math.pow(c[t][1]-c[e][1],2))<n&&(c[t][0]=c[t][0]+c[e][0]>>1,c[t][1]=c[t][1]+c[e][1]>>1,c.splice(e,1),e--);return c}function oy(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=Array(t.length);for(let r=0;r<t.length;r++){let n=t[r];e[r]=eU(n)}return e}function ob(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=Array(t.length);for(let r=0;r<t.length;r++){let n=t[r];e[r]=eR(n)}return e}function ow(){this.checkProcessable("points",{bitDepth:[1]});let t=[];for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++)1===this.getBitXY(e,r)&&t.push([e,r]);return t}function ox(){this.checkProcessable("extendedPoints",{bitDepth:[1]});let t=[];for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++)if(1===this.getBitXY(r,e))for(t.push([r,e]),1!==this.getBitXY(r+1,e)?(t.push([r+1,e]),t.push([r+1,e+1]),1!==this.getBitXY(r,e+1)&&t.push([r,e+1])):1!==this.getBitXY(r,e+1)&&(t.push([r,e+1]),t.push([r+1,e+1]));r<this.width-2&&1===this.getBitXY(r+1,e)&&1===this.getBitXY(r+2,e);)r++;return t}function oM(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this===t)return[0,0];let r=[0,0],n=this;for(;n;){if(n===t)return r;n.position&&(r[0]+=n.position[0],r[1]+=n.position[1]),n=n.parent}return!!e.defaultFurther&&r}function ok(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{alpha:e=1}=t;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let r=0;if(void 0===e)return this.size;for(let t=this.components;t<this.data.length;t+=this.channels)this.data[t]===e&&r++;return r}function oE(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{sorted:r}=e;r||(t=t.slice().sort(o_));let n=t.length,i=Array(2*n),o=0;for(let e=0;e<n;e++){let r=t[e];for(;o>=2&&0>=oA(i[o-2],i[o-1],r);)o--;i[o++]=r}let a=o+1;for(let e=n-2;e>=0;e--){let r=t[e];for(;o>=a&&0>=oA(i[o-2],i[o-1],r);)o--;i[o++]=r}return i.slice(0,o-1)}function oA(t,e,r){return(e[1]-t[1])*(r[0]-t[0])-(e[0]-t[0])*(r[1]-t[1])}function o_(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}function oS(){return oE(this.extendedPoints,{sorted:!1})}function oD(t){for(let e=0;e<t.length;e++)t[e][0]=Math.round(t[e][0]),t[e][1]=Math.round(t[e][1]);return t}function oP(t,e){return[t[0]-e[0],t[1]-e[1]]}function oC(t){let e=Math.sqrt(t[0]**2+t[1]**2);return[t[0]/e,t[1]/e]}function oI(t,e,r){void 0===r&&(r=Array(e.length));let n=Math.cos(t),i=Math.sin(t);for(let t=0;t<r.length;++t)r[t]=[n*e[t][0]-i*e[t][1],i*e[t][0]+n*e[t][1]];return r}function oT(t){let e=0;for(let r=0;r<t.length;r++){let n=t[r][0],i=t[r][1];e+=Math.sqrt((t[r===t.length-1?0:r+1][0]-n)**2+(t[r===t.length-1?0:r+1][1]-i)**2)}return e}function oB(t){let e=0;for(let r=0;r<t.length;r++){let n=t[r][0],i=t[r===t.length-1?0:r+1][1],o=t[r===t.length-1?0:r+1][0],a=t[r][1];e+=n*i*.5,e-=o*a*.5}return Math.abs(e)}function oR(t){let e=Infinity,r=Infinity,n=-1/0,i=-1/0;for(let o=0;o<t.length;o++)t[o][0]<e&&(e=t[o][0]),t[o][0]>n&&(n=t[o][0]),t[o][1]<r&&(r=t[o][1]),t[o][1]>i&&(i=t[o][1]);return[[e,r],[n,i]]}function oU(t,e){void 0===e&&(e=Array(t.length).fill(0).map(()=>[]));let r=oR(t),n=r[0][0],i=r[0][1];for(let r=0;r<t.length;r++)e[r][0]=t[r][0]-n,e[r][1]=t[r][1]-i;return e}function oL(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{originalPoints:r=oS.call(this)}=e;if(0===r.length)return[];if(1===r.length)return[r[0],r[0],r[0],r[0]];let n=Array(r.length),i=Infinity,o=0;for(let e=0;e<n.length;e++){let a=oO(r[e],r[(e+1)%n.length]);oI(-a,r,n);let s=n[e][0],h=n[e][1],l=n[(e+1)%n.length][0],u=n[(e+1)%n.length][1],c=!0,f=0,d=0,p=0;for(let t=0;t<n.length;t++){let e=n[t][0],r=n[t][1],i=(e-s)/(l-s);!0===c?(c=!1,f=i,d=i):(i<f&&(f=i),i>d&&(d=i));let o=(-(l-s)*r+l*h-u*s)/(l-s);Math.abs(o)>Math.abs(p)&&(p=o)}let m=[s+f*(l-s),h],g=[s+d*(l-s),h],v=Math.abs(p*(f-d)*(l-s));v<i&&(o=a,i=v,t=[m,g,[g[0],g[1]-p],[m[0],m[1]-p]])}return oI(o,t,t),t}function oO(t,e){let r=oC(oP(e,t)),n=Math.acos(r[0]);return r[1]<0?-n:n}function oN(t){let e={inPlace:!0};t.extendMethod("invert",rt),t.extendMethod("abs",e8),t.extendMethod("level",rz,e),t.extendMethod("add",rG,e),t.extendMethod("subtract",rq,e),t.extendMethod("subtractImage",rH),t.extendMethod("multiply",rK,e),t.extendMethod("divide",rJ,e),t.extendMethod("hypotenuse",rW),t.extendMethod("background",r3),t.extendMethod("flipX",rn),t.extendMethod("flipY",ri),t.extendMethod("blurFilter",ro),t.extendMethod("medianFilter",rf),t.extendMethod("gaussianFilter",rd),t.extendMethod("sobelFilter",rL),t.extendMethod("gradientFilter",rU),t.extendMethod("scharrFilter",rO),t.extendMethod("dilate",r5),t.extendMethod("erode",r9),t.extendMethod("open",ni),t.extendMethod("close",no),t.extendMethod("topHat",na),t.extendMethod("blackHat",ns),t.extendMethod("morphologicalGradient",nh),t.extendMethod("warpingFourPoints",nm),t.extendMethod("crop",ng),t.extendMethod("cropAlpha",nb),t.extendMethod("resize",nB).extendMethod("scale",nB),t.extendMethod("hsv",nR),t.extendMethod("hsl",nU),t.extendMethod("cmyk",nL),t.extendMethod("rgba8",nO),t.extendMethod("grey",nz).extendMethod("gray",nz),t.extendMethod("mask",n$),t.extendMethod("pad",n1),t.extendMethod("colorDepth",n2),t.extendMethod("setBorder",ii,e),t.extendMethod("rotate",n7),t.extendMethod("rotateLeft",n9),t.extendMethod("rotateRight",it),t.extendMethod("insert",ir),t.extendMethod("getRow",im),t.extendMethod("getColumn",ig),t.extendMethod("getMatrix",iv),t.extendMethod("setMatrix",iy),t.extendMethod("getPixelsArray",ib),t.extendMethod("getIntersection",iw),t.extendMethod("getClosestCommonParent",ik),t.extendMethod("getThreshold",nQ),t.extendMethod("split",io),t.extendMethod("getChannel",ia),t.extendMethod("combineChannels",is),t.extendMethod("setChannel",il),t.extendMethod("getSimilarity",iu),t.extendMethod("getPixelsGrid",ic),t.extendMethod("getBestMatch",ip),t.extendMethod("cannyEdge",iI),t.extendMethod("convolution",rR),t.extendMethod("extract",iT),t.extendMethod("floodFill",iU),t.extendMethod("paintLabels",i2,e),t.extendMethod("paintMasks",i3,e),t.extendMethod("paintPoints",oe,e),t.extendMethod("paintPolyline",or,e),t.extendMethod("paintPolylines",on,e),t.extendMethod("paintPolygon",oi,e),t.extendMethod("paintPolygons",oh,e),t.extendMethod("countAlphaPixels",ok),t.extendMethod("monotoneChainConvexHull",oS),t.extendMethod("minimalBoundingRectangle",oL),t.extendMethod("getHistogram",ol).extendProperty("histogram",ol),t.extendMethod("getHistograms",ou).extendProperty("histograms",ou),t.extendMethod("getColorHistogram",of).extendProperty("colorHistogram",of),t.extendMethod("getMin",od).extendProperty("min",od),t.extendMethod("getMax",op).extendProperty("max",op),t.extendMethod("getSum",om).extendProperty("sum",om),t.extendMethod("getMoment",og).extendProperty("moment",og),t.extendMethod("getLocalMaxima",ov),t.extendMethod("getMedian",ob).extendProperty("median",ob),t.extendMethod("getMean",oy).extendProperty("mean",oy),t.extendMethod("getPoints",ow).extendProperty("points",ow),t.extendMethod("getExtendedPoints",ox).extendProperty("extendedPoints",ox),t.extendMethod("getRelativePosition",oM)}var oF=r(3766),oz=r.n(oF);function oY(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";for(let r of e.split(".")){if(void 0===t[r])return;t=t[r]}return t}var oX=r(5863),oV=r.n(oX);function oj(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{originalPoints:e=oS.call(this)}=t;if(0===e.length)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(1===e.length)return{min:1,max:1,minLine:[e[0],e[0]],maxLine:[e[0],e[0]],aspectRatio:1};let r=Array(e.length),n=Infinity,i=0,o=[];for(let t=0;t<e.length;t++){let a=oG(e[t],e[(t+1)%e.length]);oI(-a,e,r);let s=0,h=[];for(let n=0;n<e.length;n++){let e=Math.abs(r[t][1]-r[n][1]);e>s&&(s=e,(h=[]).push([r[n][0],r[t][1]],[r[n][0],r[n][1]]))}s<n&&(n=s,i=a,o=h)}oI(i,o,o);let a=0,s=[],h=0;for(let t=0;t<e.length-1;t++)for(let r=t+1;r<e.length;r++){let n=(e[t][0]-e[r][0])**2+(e[t][1]-e[r][1])**2;n>h&&(h=n,a=Math.sqrt(n),s=[e[t],e[r]])}return{min:n,minLine:o,max:a,maxLine:s,aspectRatio:n/a}}function oG(t,e){let r=oC(oP(e,t)),n=Math.acos(r[0]);return r[1]<0?-n:n}class oq{getMask(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{scale:r=1,kind:n=""}=e;switch(n){case"contour":t=this.contourMask;break;case"box":t=this.boxMask;break;case"filled":t=this.filledMask;break;case"center":t=this.centerMask;break;case"mbr":t=this.mbrFilledMask;break;case"hull":t=this.convexHullFilledMask;break;case"hullContour":t=this.convexHullMask;break;case"mbrContour":t=this.mbrMask;break;case"feret":t=this.feretMask;break;default:t=this.mask}return r<1&&((t=t.resize({factor:r})).parent=this.mask.parent,t.position[0]+=this.minX,t.position[1]+=this.minY),t}get mean(){throw Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2>>0,this.height/2>>0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let t=this.borderIDs,e=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let r=this.internalIDs;for(let n=0;n<t.length;n++)r.includes(t[n])||(this.computed.externalIDs.push(t[n]),this.computed.externalLengths.push(e[n]))}get externalIDs(){return this.computed.externalIDs||this._computExternalIDs(),this.computed.externalIDs}get externalLengths(){return this.computed.externalLengths||this._computExternalIDs(),this.computed.externalLengths}_computeBorderIDs(){let t=oH(this);this.computed.borderIDs=t.ids,this.computed.borderLengths=t.lengths}get borderIDs(){return this.computed.borderIDs||this._computeBorderIDs(),this.computed.borderIDs}get borderLengths(){return this.computed.borderLengths||this._computeBorderIDs(),this.computed.borderLengths}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=oW(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=o0(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=oK(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=oZ(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=o$(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=oJ(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let t=new am(this.width,this.height,{kind:tI,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++)this.map.data[e+this.minX+(r+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&r>0&&r<this.height-1?(this.map.data[e-1+this.minX+(r+this.minY)*this.map.width]!==this.id||this.map.data[e+1+this.minX+(r+this.minY)*this.map.width]!==this.id||this.map.data[e+this.minX+(r-1+this.minY)*this.map.width]!==this.id||this.map.data[e+this.minX+(r+1+this.minY)*this.map.width]!==this.id)&&t.setBitXY(e,r):t.setBitXY(e,r));this.computed.contourMask=t}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let t=new am(this.width,this.height,{kind:tI,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)t.setBitXY(e,0),t.setBitXY(e,this.height-1);for(let e=0;e<this.height;e++)t.setBitXY(0,e),t.setBitXY(this.width-1,e);this.computed.boxMask=t}return this.computed.boxMask}get mask(){if(!this.computed.mask){let t=new am(this.width,this.height,{kind:tI,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++)this.map.data[e+this.minX+(r+this.minY)*this.map.width]===this.id&&t.setBitXY(e,r);this.computed.mask=t}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let t=new am(this.width,this.height,{kind:tI,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++){let n=e+this.minX+(r+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[n])&&t.setBitXY(e,r)}this.computed.filledMask=t}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let t=new i8({kind:"smallCross"}).getMask();t.parent=this.map.parent,t.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=t}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){let t=[];for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++)this.map.data[e+this.minX+(r+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&r>0&&r<this.height-1?(this.map.data[e-1+this.minX+(r+this.minY)*this.map.width]!==this.id||this.map.data[e+1+this.minX+(r+this.minY)*this.map.width]!==this.id||this.map.data[e+this.minX+(r-1+this.minY)*this.map.width]!==this.id||this.map.data[e+this.minX+(r+1+this.minY)*this.map.width]!==this.id)&&(t.push([e,r]),t.push([e+1,r]),t.push([e,r+1]),t.push([e+1,r+1])):(t.push([e,r]),t.push([e+1,r]),t.push([e,r+1]),t.push([e+1,r+1])));let e=oE(t);this.computed.convexHull={polyline:e,surface:oB(e),perimeter:oT(e)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){let t=this.convexHull,e=new am(this.width+1,this.height+1,{kind:tI,position:[this.minX,this.minY],parent:this.map.parent});e.paintPolyline(t.polyline,{closed:!0}),this.computed.convexHullMask=e}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){let t=this.convexHull,e=new am(this.width,this.height,{kind:tI,position:[this.minX,this.minY],parent:this.map.parent});for(let r=0;r<this.width;r++)for(let n=0;n<this.height;n++)1!==oV()(t.polyline,[r,n])&&e.setBitXY(r,n);this.computed.convexHullFilledMask=e}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let t=oL({originalPoints:this.convexHull.polyline});if(0===t.length)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:t};else{let e=t[0],r=t[1],n=t[2],i=Math.sqrt((e[0]-r[0])**2+(e[1]-r[1])**2),o=Math.sqrt((n[0]-r[0])**2+(n[1]-r[1])**2);this.computed.mbr={width:i,height:o,elongation:1-i/o,aspectRatio:i/o,surface:i*o,perimeter:(i+o)*2,rectangle:t}}}return this.computed.mbr}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=oj({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=oQ(this)),this.computed.perimeterInfo}get perimeter(){let t=this.perimeterInfo,e=2-Math.sqrt(2);return t.one+2*t.two+3*t.three+4*t.four-e*(t.two+2*t.three+t.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){let t=new am(this.width+1,this.height+1,{kind:tI,position:[this.minX,this.minY],parent:this.map.parent});t.paintPolyline(this.feretDiameters.minLine),t.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=t}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let t=oD(this.mbr.rectangle);if(t.length>0){let e=oR(t),r=new am(e[1][0]-e[0][0]+1,e[1][1]-e[0][1]+1,{kind:tI,position:[this.minX+e[0][0],this.minY+e[0][1]],parent:this.map.parent});t=oU(t),r.paintPolyline(t,{closed:!0}),this.computed.mbrMask=r}else this.computed.mbrMask=new am(1,1,{kind:tI,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){let t=new am(this.width,this.height,{kind:tI,position:[this.minX,this.minY],parent:this.map.parent}),e=this.mask.minimalBoundingRectangle();for(let r=0;r<this.width;r++)for(let n=0;n<this.height;n++)1!==oV()(e,[r,n])&&t.setBitXY(r,n);this.computed.mbrFilledMask=t}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let t=[];for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++){let n=(e+this.minY)*this.map.width+r+this.minX;this.map.data[n]===this.id&&t.push([r,e])}this.computed.points=t}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let t,e=0,r=this.points;for(let n=0;n<r.length;n++)for(let i=n+1;i<r.length;i++){let o=Math.pow(r[n][0]-r[i][0],2)+Math.pow(r[n][1]-r[i][1],2);o>=e&&(e=o,t=[r[n],r[i]])}this.computed.maxLengthPoints=t}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let t=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=t}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let t=this.maxLengthPoints,e=-(180*Math.atan2(t[0][1]-t[1][1],t[0][0]-t[1][0]))/Math.PI;this.computed.angle=e}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}constructor(t,e){this.map=t,this.id=e,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}}function oH(t){let e=t.map,r=e.data,n=new Set,i=new Map,o=new Set,a=[1,0,-1,0],s=[0,1,0,-1];for(let h=t.minX;h<=t.maxX;h++)for(let l=t.minY;l<=t.maxY;l++)if(r[h+l*e.width]===t.id)for(let u=0;u<4;u++){let c=h+a[u],f=l+s[u];if(c>=0&&f>=0&&c<e.width&&f<e.height){let a=c+f*e.width;if(r[a]!==t.id&&!o.has(a)){o.add(a),n.add(r[a]);let t=i.get(r[a]);t?i.set(r[a],++t):i.set(r[a],1)}}}let h=Array.from(n),l=h.map(function(t){return i.get(t)});return{ids:h,lengths:l}}function oW(t){let e=new Set,r=t.map,n=r.data;for(let i of[0,t.height-1])for(let o=0;o<t.width;o++){let a=(i+t.minY)*r.width+o+t.minX;if(o-t.minX>0&&n[a]===t.id&&n[a-1]!==t.id){let t=n[a-1];e.add(t)}if(r.width-o-t.minX>1&&n[a]===t.id&&n[a+1]!==t.id){let t=n[a+1];e.add(t)}}for(let i of[0,t.width-1])for(let o=0;o<t.height;o++){let a=(o+t.minY)*r.width+i+t.minX;if(o-t.minY>0&&n[a]===t.id&&n[a-r.width]!==t.id){let t=n[a-r.width];e.add(t)}if(r.height-o-t.minY>1&&n[a]===t.id&&n[a+r.width]!==t.id){let t=n[a+r.width];e.add(t)}}return Array.from(e)}function oK(t){let e=0,r=t.map,n=r.data,i=[0];for(let o of(t.height>1&&(i[1]=t.height-1),i))for(let i=1;i<t.width-1;i++)n[(o+t.minY)*r.width+i+t.minX]===t.id&&e++;let o=[0];for(let i of(t.width>1&&(o[1]=t.width-1),o))for(let o=0;o<t.height;o++)n[(o+t.minY)*r.width+i+t.minX]===t.id&&e++;return e}function oJ(t){let e=0,r=t.map,n=r.data;for(let i=1;i<t.width-1;i++)for(let o=1;o<t.height-1;o++){let a=(o+t.minY)*r.width+i+t.minX;n[a]===t.id&&(n[a-1]!==t.id||n[a+1]!==t.id||n[a-r.width]!==t.id||n[a+r.width]!==t.id)&&e++}return e+t.box}function oQ(t){let e=t.map,r=e.data,n=0,i=0,o=0,a=0;for(let s=0;s<t.width;s++)for(let h=0;h<t.height;h++){let l=(h+t.minY)*e.width+s+t.minX;if(r[l]===t.id){let u=0;switch(0===s?u++:t.externalIDs.includes(r[l-1])&&u++,s===t.width-1?u++:t.externalIDs.includes(r[l+1])&&u++,0===h?u++:t.externalIDs.includes(r[l-e.width])&&u++,h===t.height-1?u++:t.externalIDs.includes(r[l+e.width])&&u++,u){case 1:n++;break;case 2:i++;break;case 3:o++;break;case 4:a++}}}return{one:n,two:i,three:o,four:a}}function oZ(t){let e=0,r=t.map,n=r.data;for(let i=1;i<t.width-1;i++)for(let o=1;o<t.height-1;o++){let a=(o+t.minY)*r.width+i+t.minX;n[a]===t.id&&(t.externalIDs.includes(n[a-1])||t.externalIDs.includes(n[a+1])||t.externalIDs.includes(n[a-r.width])||t.externalIDs.includes(n[a+r.width]))&&e++}return e+t.box}function o$(t){let e=0,r=t.map.width,n=t.map.data;for(let i=1;i<t.width-1;i++)for(let o=1;o<t.height-1;o++){let a=(o+t.minY)*r+i+t.minX;t.internalIDs.includes(n[a])&&n[a]!==t.id&&e++}return{number:t.internalIDs.length-1,surface:e}}function o0(t){let e=[t.id],r=t.map,n=r.data;if(t.height>2)for(let i=0;i<t.width;i++){let o=t.minY*r.width+i+t.minX;if(e.includes(n[o])){let i=n[o+r.width];e.includes(i)||t.boxIDs.includes(i)||e.push(i)}}let i=[,,,,];for(let o=1;o<t.width-1;o++)for(let a=1;a<t.height-1;a++){let s=(a+t.minY)*r.width+o+t.minX;if(e.includes(n[s])){i[0]=n[s-1],i[1]=n[s+1],i[2]=n[s-r.width],i[3]=n[s+r.width];for(let r=0;r<4;r++){let n=i[r];e.includes(n)||t.boxIDs.includes(n)||e.push(n)}}}return e}class o1{createRoi(){let t=this.roiMap.data,e={};this.roiMap.positive=0,this.roiMap.negative=0;for(let r=0;r<t.length;r++)t[r]&&!e[t[r]]&&(e[t[r]]=!0,t[r]>0?this.roiMap.positive++:this.roiMap.negative++);let r={};for(let t in e)r[t]=new oq(this.roiMap,1*t);let n=this.roiMap.width,i=this.roiMap.height;for(let e=0;e<i;e++)for(let i=0;i<n;i++){let o=e*n+i;if(0!==t[o]){let n=r[t[o]];i<n.minX&&(n.minX=i),i>n.maxX&&(n.maxX=i),e<n.minY&&(n.minY=e),e>n.maxY&&(n.maxY=e),n.meanX+=i,n.meanY+=e,n.surface++}}let o=[];for(let t in e)r[t].meanX/=r[t].surface,r[t].meanY/=r[t].surface,o.push(r[t]);return o}constructor(t,e){this.roiMap=t,this.options=e,this.roi=this.createRoi()}}function o2(t){let e=t.data,r=[1,0,-1,0],n=[0,1,0,-1],i=t.minMax,o=-i.min,a=i.max+o,s=[];for(let t=0;t<=a;t++)s.push(Object.create(null));for(let i=0;i<t.width;i++)for(let a=0;a<t.height;a++){let h=e[i+a*t.width];if(0!==h){let l=Object.create(null),u=!1;for(let c=0;c<4;c++){let f=i+r[c],d=a+n[c];if(f>=0&&d>=0&&f<t.width&&d<t.height){let r=e[f+d*t.width];h!==r&&(u=!0,0!==r&&void 0===l[r]&&(l[r]=!0,s[r+o][h]?s[r+o][h]++:s[r+o][h]=1))}else u=!0}u&&(s[h+o][h]?s[h+o][h]++:s[h+o][h]=1)}}let h={};for(let t=0;t<s.length;t++)Object.keys(s[t]).length>0&&(h[t-o]=s[t]);return h}function o3(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{algorithm:e="commonBorderLength",minCommonBorderLength:r=5,maxCommonBorderLength:n=100,minCommonBorderRatio:i=.3,maxCommonBorderRatio:o=1}=t,a=function(t,e,i){return t[i]>=r&&t[i]<=n};"function"==typeof e&&(a=e),"commonborderratio"===e.toLowerCase()&&(a=function(t,e,r){let n=Math.min(t[r]/t[e],1);return n>=i&&n<=o});let s=this,h=s.commonBorderLength,l={},u={};for(let t of Object.keys(h)){let e=h[t];for(let r of Object.keys(e))if(r!==t&&a(e,t,r)){let e=r;u[r]&&(e=u[r]);let n=t;if(u[t]&&(n=u[t]),Number(e)!==n){let t=Math.min(e,n),r=Math.max(e,n);if(l[t]||(l[t]={}),l[t][r]=!0,u[r]=t,l[r]){for(let e of Object.keys(l[r]))l[t][e]=!0,u[e]=t;delete l[r]}}}}let c=s.minMax,f=-c.min,d=Array(c.max+f+1).fill(0);for(let t of Object.keys(u))d[Number(t)+f]=u[t];let p=s.data;for(let t=0;t<p.length;t++){let e=p[t];if(0!==e){let r=d[e+f];0!==r&&(p[t]=r)}}return s.computed={},s}class o5{get total(){return this.negative+this.positive}get minMax(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;for(let r=0;r<this.data.length;r++)this.data[r]<t&&(t=this.data[r]),this.data[r]>e&&(e=this.data[r]);return{min:t,max:e}}get commonBorderLength(){return o2(this)}mergeRoi(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o3.call(this,t)}mergeRois(t){let e=t[0],r=t.slice(1);for(let t=0;t<this.data.length;t++)r.includes(this.data[t])&&(this.data[t]=e)}rowsInfo(){let t=Array(this.height),e=0;for(let r=0;r<this.data.length;r+=this.width){let n={row:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=n;let i={},o={},a=[],s=this.data[r],h=0;for(let t=r;t<r+this.width;t++){let e=this.data[t];s!==e&&(s=e,a.push(h),h=0),h++,e>0?(n.positivePixel++,i[e]||(i[e]=!0)):e<0?(n.negativePixel++,o[e]||(o[e]=!0)):n.zeroPixel++}a.push(h),n.medianChange=a.sort((t,e)=>t-e)[Math.floor(a.length/2)],n.positiveRoiIDs=Object.keys(i),n.negativeRoiIDs=Object.keys(o),n.positiveRoi=n.positiveRoiIDs.length,n.negativeRoi=n.negativeRoiIDs.length}return t}colsInfo(){let t=Array(this.width),e=0;for(let r=0;r<this.width;r++){let n={col:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=n;let i={},o={},a=[],s=this.data[r],h=0;for(let t=r;t<r+this.data.length;t+=this.width){let e=this.data[t];s!==e&&(s=e,a.push(h),h=0),h++,e>0?(n.positivePixel++,i[e]||(i[e]=!0)):e<0?(n.negativePixel++,o[e]||(o[e]=!0)):n.zeroPixel++}a.push(h),n.medianChange=a.sort((t,e)=>t-e)[Math.floor(a.length/2)],n.positiveRoiIDs=Object.keys(i),n.negativeRoiIDs=Object.keys(o),n.positiveRoi=n.positiveRoiIDs.length,n.negativeRoi=n.negativeRoiIDs.length}return t}constructor(t,e){this.parent=t,this.width=t.width,this.height=t.height,this.data=e,this.negative=0,this.positive=0}}function o4(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{allowCorners:r=!1}=e,n=65535,i=new Int16Array(t.size),o=0,a=0,s=new Uint16Array(n+1),h=new Uint16Array(n+1);for(let e=0;e<t.width;e++)for(let r=0;r<t.height;r++)0===i[r*t.width+e]&&l(e,r);function l(e,l){let u=0,c=0,f=t.getBitXY(e,l),d=f?++o:--a;if(o>32767||a<-32768)throw Error("Too many regions of interest");for(s[0]=e,h[0]=l;u<=c;){let e=s[u&n],o=h[u&n];if(i[o*t.width+e]=d,e>0&&0===i[o*t.width+e-1]&&t.getBitXY(e-1,o)===f&&(s[++c&n]=e-1,h[c&n]=o,i[o*t.width+e-1]=-32768),o>0&&0===i[(o-1)*t.width+e]&&t.getBitXY(e,o-1)===f&&(s[++c&n]=e,h[c&n]=o-1,i[(o-1)*t.width+e]=-32768),e<t.width-1&&0===i[o*t.width+e+1]&&t.getBitXY(e+1,o)===f&&(s[++c&n]=e+1,h[c&n]=o,i[o*t.width+e+1]=-32768),o<t.height-1&&0===i[(o+1)*t.width+e]&&t.getBitXY(e,o+1)===f&&(s[++c&n]=e,h[c&n]=o+1,i[(o+1)*t.width+e]=-32768),r&&(e>0&&o>0&&0===i[(o-1)*t.width+e-1]&&t.getBitXY(e-1,o-1)===f&&(s[++c&n]=e-1,h[c&n]=o-1,i[(o-1)*t.width+e-1]=-32768),e<t.width-1&&o>0&&0===i[(o-1)*t.width+e+1]&&t.getBitXY(e+1,o-1)===f&&(s[++c&n]=e+1,h[c&n]=o-1,i[(o-1)*t.width+e+1]=-32768),e>0&&o<t.height-1&&0===i[(o+1)*t.width+e-1]&&t.getBitXY(e-1,o+1)===f&&(s[++c&n]=e-1,h[c&n]=o+1,i[(o+1)*t.width+e-1]=-32768),e<t.width-1&&o<t.height-1&&0===i[(o+1)*t.width+e+1]&&t.getBitXY(e+1,o+1)===f&&(s[++c&n]=e+1,h[c&n]=o+1,i[(o+1)*t.width+e+1]=-32768)),c-++u>n)throw Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new o5(t,i)}var o6=r(8802),o8=r.n(o6);let o7=[-1,0],o9=[0,-1],at=[null,null],ae=[-1,-1,0,1],ar=[0,-1,-1,-1],an=[null,null,null,null];function ai(t){let e,r,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{allowCorners:o=!1}=i,a=4;if(o&&(a=8),8===a)e=ae,r=ar,n=an;else if(4===a)e=o7,r=o9,n=at;else throw RangeError("unsupported neighbours count: ".concat(a));let s=t.size,h=t.width,l=t.height,u=Array(s),c=new Uint32Array(s),f=new(o8()),d=1;for(let i=0;i<l;i++)for(let o=0;o<h;o++){let a=o+i*h;if(t.getBit(a)){let t=null;for(let a=0;a<n.length;a++){let s=o+e[a],c=i+r[a];if(s>=0&&c>=0&&s<h&&c<l){let e=u[s+c*h];e?(n[a]=e,(!t||n[a].value<t.value)&&(t=n[a])):n[a]=null}}if(t){u[a]=t;for(let e=0;e<n.length;e++)n[e]&&n[e]!==t&&f.union(t,n[e])}else u[a]=f.add(d++)}}for(let e=0;e<l;e++)for(let r=0;r<h;r++){let n=r+e*h;t.getBit(n)&&(c[n]=f.find(u[n]).value)}return new o5(t,c)}function ao(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{allowCorner:e=!0,onlyTop:r=!1,invert:n=!1}=t,i=this;i.checkProcessable("fromMaxima",{components:[1]});let o=1,a=2,s=0,h=0,l=new Int16Array(i.size),u=new Int8Array(i.size),c=new Float32Array(i.size),f=1048575,d=new Uint16Array(f+1),p=new Uint16Array(f+1),m=0,g=0,v=new Uint16Array(f+1),y=new Uint16Array(f+1),b=0,w=0;for(x(i,{maxima:!n});m<g;)k(d[m&f],p[m&f],a),m++;return new o5(i,l);function x(t){let{maxima:r=!0}=t;for(let t=1;t<i.height-1;t++)for(let n=1;n<i.width-1;n++){let a=n+t*i.width;if(0===u[a]){let u=r?i.data[a]:-i.data[n+t*i.width];if(i.data[t*i.width+n-1]>u||i.data[t*i.width+n+1]>u||i.data[(t-1)*i.width+n]>u||i.data[(t+1)*i.width+n]>u||e&&(i.data[(t-1)*i.width+n-1]>u||i.data[(t-1)*i.width+n+1]>u||i.data[(t+1)*i.width+n-1]>u||i.data[(t+1)*i.width+n+1]>u))continue;l[a]=r?++s:--h,!M(n,t,o)&&(r?--s:++h)}}}function M(t,e){let r=g;b=0,w=1,v[0]=t,y[0]=e;let n=!0;for(;b<w;)n&=k(v[b&f],y[b&f],o),b++;if(!n){for(let t=0;t<w;t++){let e=v[t&f];l[y[t&f]*i.width+e]=0}g=r}return n}function k(t,e,n){let s=l[e*i.width+t],h=i.data[e*i.width+t];for(let m=e-1;m<=e+1;m++)for(let e=t-1;e<=t+1;e++){let t=m*i.width+e;if(0===u[t])switch(u[t]=1,c[t]=i.data[t]-h,n){case o:if(0===c[t]){if(0===e||0===m||e===i.width-1||m===i.height-1)return!1;l[t]=s,v[w&f]=e,y[w&f]=m,w++}else{if(c[t]>0)return!1;!r&&(l[t]=s,d[g&f]=e,p[g&f]=m,g++)}break;case a:c[t]<=0&&(l[t]=s,d[g&f]=e,p[g&f]=m,g++);break;default:throw Error("unreachable")}}return!0}}function aa(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new i8(e),n=new Int16Array(this.size),i=0,o=r.getPoints();for(let e=0;e<t.length;e++){i++;let r=t[e][0],a=t[e][1];for(let t=0;t<o.length;t++){let e=o[t][0],s=o[t][1];r+e>=0&&a+s>=0&&r+e<this.width&&a+s<this.height&&(n[r+e+(a+s)*this.width]=i)}}return new o5(this,n)}var as=r(5339),ah=r.n(as);let al=[1,0,-1,0,1,1,-1,-1],au=[0,1,0,-1,1,-1,1,-1];function ac(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{points:e,mask:r,image:n,fillMaxValue:i=this.maxValue,invert:o=!1}=t,a=n||this;a.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),o=!o,e||(e=a.getLocalMaxima({invert:o,mask:r}));let s=o?0:1,h=new Int16Array(a.size),l=a.width,u=a.height,c=new(ah())({comparator:(t,e)=>t[2]-e[2],strategy:ah().BinaryHeapStrategy});for(let t=0;t<e.length;t++){let r=e[t][0]+e[t][1]*l;h[r]=t+1;let n=a.data[r];(o&&n<=i||!o&&n>=i)&&c.queue([e[t][0],e[t][1],n])}for(;c.length>0;){let t=c.dequeue(),e=t[0]+t[1]*l;for(let n=0;n<4;n++){let f=t[0]+al[n],d=t[1]+au[n];if(f>=0&&d>=0&&f<l&&d<u){let u=f+d*l;if(!r||r.getBit(u)===s){let r=a.data[u];(o&&r<=i||!o&&r>=i)&&0===h[u]&&(h[u]=h[e],c.queue([t[0]+al[n],t[1]+au[n],r]))}}}}return new o5(a,h)}class af{fromMaxima(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this._options,t),r=ao.call(this._image,t);this._layers[e.label]=new o1(r,e)}fromPoints(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object.assign({},this._options,e),n=aa.call(this._image,t,e);return this._layers[r.label]=new o1(n,r),this}putMap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new o5(this._image,t),n=Object.assign({},this._options,e);return this._layers[n.label]=new o1(r,n),this}fromWaterShed(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this._options,t),r=ac.call(this._image,t);this._layers[e.label]=new o1(r,e)}fromMask(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object.assign({},this._options,e),n=o4.call(this._image,t,e);return this._layers[r.label]=new o1(n,r),this}fromMaskConnectedComponentLabelingAlgorithm(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object.assign({},this._options,e),n=ai.call(this._image,t,e);return this._layers[r.label]=new o1(n,r),this}getMap(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap}rowsInfo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getMap(t).rowsInfo()}colsInfo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getMap(t).rowsInfo()}getRoiIds(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getRois(t);if(e){let t=Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r].id;return t}throw Error("ROIs not found")}getRois(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{label:e=this._options.label,positive:r=!0,negative:n=!0,minSurface:i=0,maxSurface:o=Number.POSITIVE_INFINITY,minWidth:a=0,maxWidth:s=Number.POSITIVE_INFINITY,minHeight:h=0,maxHeight:l=Number.POSITIVE_INFINITY,minRatio:u=0,maxRatio:c=Number.POSITIVE_INFINITY}=t;if(!this._layers[e])throw Error("this Roi layer (".concat(e,") does not exist"));let f=this._layers[e].roi,d=[];for(let t of f)(t.id<0&&n||t.id>0&&r)&&t.surface>=i&&t.surface<=o&&t.width>=a&&t.width<=s&&t.height>=h&&t.height<=l&&t.ratio>=u&&t.ratio<=c&&d.push(t);return d}getRoi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{label:r=this._options.label}=e;if(!this._layers[r])throw Error("this Roi layer (".concat(r,") does not exist"));let n=this._layers[r].roi.find(e=>e.id===t);if(!n)throw Error("found no Roi with id ".concat(t));return n}getMasks(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getRois(t),r=Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n].getMask(t);return r}getAnalysisMasks(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{analysisProperty:e}=t,r="".concat(e,"Mask"),n=this.getRois(t);return 0!==n.length&&n[0][r]?n.map(t=>t[r]):[]}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap.data}paint(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{labelProperty:e,analysisProperty:r}=t;this._painted||(this._painted=this._image.rgba8());let n=this.getMasks(t);if(e){let r=this.getRois(t);t.labels=r.map(t=>oY(t,e));let n=Math.max(...t.labels),i=!1,o=!1;if(e.includes("surface")?i=!0:/(?:perimeter|min|max|external|width|height|length)/.test(e)&&(o=!0),isFinite(n)){let e="";if("pixel"!==t.unit&&t.pixelSize&&(o||i)){e=i?"".concat(t.unit,"^2"):t.unit;let r=i?"m^2":"m",n=i?t.pixelSize**2:t.pixelSize,o=oz().swiftConverter(r,e);t.labels=t.labels.map(t=>o(n*t))}n>50?t.labels=t.labels.map(t=>Math.round(t)+e):n>10?t.labels=t.labels.map(t=>t.toFixed(1)+e):t.labels=t.labels.map(t=>t.toFixed(2)+e)}t.labelsPosition=r.map(t=>[t.meanX,t.meanY])}if(this._painted.paintMasks(n,t),r){let e=this.getAnalysisMasks(t);this._painted.paintMasks(e,{color:t.analysisColor,alpha:t.analysisAlpha})}return this._painted}getMask(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new am(this._image.width,this._image.height,{kind:"BINARY"}),r=this.getMasks(t);for(let t=0;t<r.length;t++){let n=r[t];for(let t=0;t<n.width;t++)for(let r=0;r<n.height;r++)n.getBitXY(t,r)&&e.setBitXY(t+n.position[0],r+n.position[1])}return e}resetPainted(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{image:e}=t;e?this._painted=this.image.rgba8():this._painted=this._image.rgba8()}mergeRoi(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getMap(t);return e.mergeRoi(t),this.putMap(e.data,t),this}mergeRois(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Array.isArray(t)||t.some(t=>!Number.isInteger(t)))throw Error("Roi ids must be an array of integers");if(t.length<2)throw Error("Roi ids must have at least two elements");if(new Set(t).size!==t.length)throw Error("Roi ids must be all different");t.forEach(t=>this.getRoi(t));let r=this.getMap(e);return r.mergeRois(t),this.putMap(r.data,e),this}findCorrespondingRoi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getRois(e),n=[];for(let e=0;e<r.length;e++){let i=r[e],o=ad(i.minX,i.minY,i.points,t,Math.sign(i.id));n.push(o)}return n}_assertLayerWithLabel(t){if(!this._layers[t])throw Error("no layer with label ".concat(t))}constructor(t,e={}){this._image=t,this._options=e,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}}function ad(t,e,r,n,i){let o={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let i=0;i<r.length;i++){let a=r[i],s=a[0]+t+(a[1]+e)*n.width,h=n.data[s];(h>0||h<0)&&(o.id.includes(h)?o.surface[o.id.indexOf(h)]+=1:(o.id.push(h),o.surface.push(1)))}for(let t=0;t<o.id.length;t++)Math.sign(o.id[t])===i?o.same+=o.surface[t]:o.opposite+=o.surface[t],o.roiSurfaceCovered[t]=o.surface[t]/r.length;return o.total=o.opposite+o.same,o}let ap=Object.prototype.toString;class am{get[Symbol.toStringTag](){return"IJSImage"}static isImage(t){return"[object IJSImage]"===ap.call(t)}static fromCanvas(t){let e=t.getContext("2d").getImageData(0,0,t.width,t.height);return new am(e.width,e.height,e.data)}static createFrom(t,e){let r=e5(t);return Object.assign(r,{parent:t,position:[0,0]},e),new am(r)}getRoiManager(t){return new af(this,t)}clone(){let t=this.data.slice();return new am(this.width,this.height,t,this)}apply(t){for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++){let n=(e*this.width+r)*this.channels;t.call(this,n)}}constructor(t,e,r,n){if(1==arguments.length?(n=t,{width:t,height:e,data:r}=n):r&&!r.length&&(n=r,{data:r}=n),void 0===t&&(t=1),void 0===e&&(e=1),void 0===n&&(n={}),"object"!=typeof n||null===n)throw TypeError("options must be an object");if(!Number.isInteger(t)||t<=0)throw RangeError("width must be a positive integer");if(!Number.isInteger(e)||e<=0)throw RangeError("height must be a positive integer");let{kind:i=tU}=n;if("string"!=typeof i)throw TypeError("kind must be a string");let o=tF(i),a=Object.assign({},n);for(let t in o)void 0===a[t]&&(a[t]=o[t]);tY(a);let{components:s,bitDepth:h,colorModel:l}=a,u=a.alpha+0,c=t*e,f=s+u,d=32===h?Number.MAX_VALUE:2**h-1;if(void 0===r)r=tV(c,s,u,f,h,d);else{let t=tX(c,f,h);if(r.length!==t)throw RangeError("incorrect data size: ".concat(r.length,". Should be ").concat(t))}this.width=t,this.height=e,this.data=r,this.size=c,this.components=s,this.alpha=u,this.bitDepth=h,this.maxValue=d,this.colorModel=l,this.channels=f,this.meta=n.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:n.parent||null}),this.position=n.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}}e3(am),m(am),tf(am),am.prototype.checkProcessable=g,am.prototype.getRGBAData=tk,am.load=eq,am.extendMethod=tg,am.extendProperty=tv,oN(am);var ag=r(8672),av=r.n(ag);let ay={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function ab(t,e,r){return t.post("data",[e,r]).then(function(t){for(let e in t)t[e]=new am(t[e]);return t})}var aw={run:function(t,e,r){e=Object.assign({},ay,e);let n=this.manager;return Array.isArray(t)?Promise.all(t.map(function(t){let i=ab(n,t,e);return"function"==typeof r&&i.then(r),i})):ab(n,t,e)},work:function(){worker.on("data",function(t,e,r){e=new IJS(e);let n={},i=[],o=e.grey(),a=o.sobelFilter();d("sobel",a);let s=a.level().mask({threshold:r.threshold});d("mask",s);let h=a.getRoiManager();h.fromMask(s);let l=h.getMask(r.roi);d("realMask",l);let u=o.getPixelsGrid({sampling:r.sampling,mask:l}),c=e.getBackground(u.xyS,u.zS,r.regression);d("background",c);let f=e.subtract(c);function d(t,e){r.include.includes(t)&&(n[t]=e,i.push(e.data.buffer))}n.result=f,i.push(f.data.buffer),t(n,i)})}};function ax(t){t.extendMethod("background",aw)}class aM{checkUrl(){if(null===this._url)throw Error("image worker must be initialized with an URL")}get url(){return this._url}set url(t){if("string"!=typeof t)throw TypeError("worker URL must be a string");this._url=t,this._deps[0]=t}static extendMethod(t,e){let r,n;let i={};function o(){for(var t=arguments.length,o=Array(t),a=0;a<t;a++)o[a]=arguments[a];return r||(this.checkUrl(),n=this.url,r=new(av())(e.work,{deps:n}),i.manager=r),e.run.call(i,...o)}o.reset=function(){r&&(r.terminate(),r=new(av())(e.work,{deps:n}),i.manager=r)},aM.prototype[t]=o}constructor(){this._url=null,this._deps=[null]}}ax(aM),new aM},820:function(t,e,r){"use strict";let n=r(9474),i=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),o=t=>{let e=n(t);return i.has(e&&e.ext)?e:null};t.exports=o,t.exports.default=o,Object.defineProperty(o,"minimumBytes",{value:n.minimumBytes})},9474:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(8620).Buffer;let toBytes=t=>[...t].map(t=>t.charCodeAt(0)),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=t[e],n=1,i=0;for(;++i<8;)n*=256,r+=t[e+i]*n;return r}let fileType=t=>{if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Buffer.isBuffer(t)))throw TypeError("Expected the `input` argument to be of type `Uint8Array` or `Buffer` or `ArrayBuffer`, got `".concat(typeof t,"`"));let e=t instanceof Uint8Array?t:new Uint8Array(t);if(!(e&&e.length>1))return null;let r=(t,r)=>{r=Object.assign({offset:0},r);for(let n=0;n<t.length;n++)if(r.mask){if(t[n]!==(r.mask[n]&e[n+r.offset]))return!1}else if(t[n]!==e[n+r.offset])return!1;return!0},n=(t,e)=>r(toBytes(t),e);if(r([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(r([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(r([71,73,70]))return{ext:"gif",mime:"image/gif"};if(r([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(r([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((r([73,73,42,0])||r([77,77,0,42]))&&r([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r([73,73,42,0])||r([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(r([66,77]))return{ext:"bmp",mime:"image/bmp"};if(r([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(r([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(r([80,75,3,4])){if(r([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(r(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(n("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(n("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(n("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};let t=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.findIndex((t,r,n)=>r>=e&&80===n[r]&&75===n[r+1]&&3===n[r+2]&&4===n[r+3])},i=0,o=!1,a=null;do{let s=i+30;if(o||(o=r(oxmlContentTypes,{offset:s})||r(oxmlRels,{offset:s})),!a&&(n("word/",{offset:s})?a={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:n("ppt/",{offset:s})?a={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:n("xl/",{offset:s})&&(a={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),o&&a)return a;i=t(e,s)}while(i>=0);if(a)return a}if(r([80,75])&&(3===e[2]||5===e[2]||7===e[2])&&(4===e[3]||6===e[3]||8===e[3]))return{ext:"zip",mime:"application/zip"};if(r([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(r([82,97,114,33,26,7])&&(0===e[6]||1===e[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(r([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(r([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(r([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(r([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(r([51,103,112,53])||r([0,0,0])&&r([102,116,121,112],{offset:4})&&(r([109,112,52,49],{offset:8})||r([109,112,52,50],{offset:8})||r([105,115,111,109],{offset:8})||r([105,115,111,50],{offset:8})||r([109,109,112,52],{offset:8})||r([77,52,86],{offset:8})||r([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(r([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(r([26,69,223,163])){let t=e.subarray(4,4100),r=t.findIndex((t,e,r)=>66===r[e]&&130===r[e+1]);if(-1!==r){let e=r+3,n=r=>[...r].every((r,n)=>t[e+n]===r.charCodeAt(0));if(n("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(n("webm"))return{ext:"webm",mime:"video/webm"}}}if(r([0,0,0,20,102,116,121,112,113,116,32,32])||r([102,114,101,101],{offset:4})||r([102,116,121,112,113,116,32,32],{offset:4})||r([109,100,97,116],{offset:4})||r([109,111,111,118],{offset:4})||r([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(r([82,73,70,70])){if(r([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(r([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(r([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(r([48,38,178,117,142,102,207,17,166,217])){let t=30;do{let n=readUInt64LE(e,t+16);if(r([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:t})){if(r([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(r([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}t+=n}while(t+24<=e.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(r([0,0,1,186])||r([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(r([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let t=0;t<2&&t<e.length-16;t++){if(r([73,68,51],{offset:t})||r([255,226],{offset:t,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(r([255,228],{offset:t,mask:[255,228]})||r([255,248],{offset:t,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([255,240],{offset:t,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(r([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(r([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(r([79,103,103,83]))return r([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:r([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:r([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:r([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:r([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(r([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(r([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(r([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(r([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(r([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(r([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===e[0]||70===e[0])&&r([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(r([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(r([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(r([119,79,70,70])&&(r([0,1,0,0],{offset:4})||r([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(r([119,79,70,50])&&(r([0,1,0,0],{offset:4})||r([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(r([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(r([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(r([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(r([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(r([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(r([37,33]))return{ext:"ps",mime:"application/postscript"};if(r([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(r([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(r([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(r([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(r([77,83,67,70])||r([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(r([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(r([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(r([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(r([31,160])||r([31,157]))return{ext:"Z",mime:"application/x-compress"};if(r([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(r([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(r([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(r([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(r([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(r([0,0,0,12,106,80,32,32,13,10,135,10])){if(r([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(r([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(r([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(r([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(r([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(n("<?xml "))return{ext:"xml",mime:"application/xml"};if(r([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(r([102,116,121,112],{offset:4})){if(r([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(r([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(r([104,101,105,99],{offset:8})||r([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(r([104,101,118,99],{offset:8})||r([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return r([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:r([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:r([77,80,43])||r([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:r([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:r([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:r([212,195,178,161])||r([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise((resolve,reject)=>{let stream=eval("require")("stream");readableStream.once("readable",()=>{let t=new stream.PassThrough,e=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{t.fileType=fileType(e)}catch(t){reject(t)}readableStream.unshift(e),stream.pipeline?resolve(stream.pipeline(readableStream,t,()=>{})):resolve(readableStream.pipe(t))})})},714:function(t,e,r){"use strict";function n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return new TextDecoder(e).decode(t)}r.r(e),r.d(e,{IOBuffer:function(){return l}}),r(5220);let i=new TextEncoder;function o(t){return i.encode(t)}let a=8192,s=(()=>{let t=new Uint8Array(4);return!((new Uint32Array(t.buffer)[0]=1)&t[0])})(),h={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class l{available(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+=t,this}back(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){let t=this._marks.pop();if(void 0===t)throw Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.available(t)){let e=2*(this.offset+t),r=new Uint8Array(e);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=this.byteLength=e,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.readArray(t,"uint8")}readArray(t,e){let r=h[e].BYTES_PER_ELEMENT*t,n=this.byteOffset+this.offset,i=this.buffer.slice(n,n+r);if(this.littleEndian===s&&"uint8"!==e&&"int8"!==e){let t=new Uint8Array(this.buffer.slice(n,n+r));t.reverse();let i=new h[e](t.buffer);return this.offset+=r,i.reverse(),i}let o=new h[e](i);return this.offset+=r,o}readInt16(){let t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){let t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){let t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){let t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){let t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){let t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){let t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){let t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e="";for(let r=0;r<t;r++)e+=this.readChar();return e}readUtf8(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return n(this.readBytes(t))}decodeText(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return n(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(o(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}constructor(t=a,e={}){let r=!1;"number"==typeof t?t=new ArrayBuffer(t):(r=!0,this.lastWrittenByte=t.byteLength);let n=e.offset?e.offset>>>0:0,i=t.byteLength-n,o=n;(ArrayBuffer.isView(t)||t instanceof l)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+n),t=t.buffer),r?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}}},5220:function(){"use strict";!function(t){function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf-8";if("utf-8"!==t)throw RangeError("Failed to construct 'TextEncoder': The encoding label provided ('".concat(t,"') is invalid."))}function r(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf-8",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fatal:!1};if("utf-8"!==t)throw RangeError("Failed to construct 'TextDecoder': The encoding label provided ('".concat(t,"') is invalid."));if(e.fatal)throw Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}t.TextEncoder&&t.TextDecoder||(Object.defineProperty(e.prototype,"encoding",{value:"utf-8"}),e.prototype.encode=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{stream:!1};if(e.stream)throw Error("Failed to encode: the 'stream' option is unsupported.");let r=0,n=t.length,i=0,o=Math.max(32,n+(n>>1)+7),a=new Uint8Array(o>>3<<3);for(;r<n;){let e=t.charCodeAt(r++);if(e>=55296&&e<=56319){if(r<n){let n=t.charCodeAt(r);(64512&n)==56320&&(++r,e=((1023&e)<<10)+(1023&n)+65536)}if(e>=55296&&e<=56319)continue}if(i+4>a.length){o+=8,o*=1+r/t.length*2,o=o>>3<<3;let e=new Uint8Array(o);e.set(a),a=e}if((4294967168&e)==0){a[i++]=e;continue}if((4294965248&e)==0)a[i++]=e>>6&31|192;else if((4294901760&e)==0)a[i++]=e>>12&15|224,a[i++]=e>>6&63|128;else{if((4292870144&e)!=0)continue;a[i++]=e>>18&7|240,a[i++]=e>>12&63|128,a[i++]=e>>6&63|128}a[i++]=63&e|128}return a.slice(0,i)},Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(r.prototype,"fatal",{value:!1}),Object.defineProperty(r.prototype,"ignoreBOM",{value:!1}),r.prototype.decode=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{stream:!1};if(e.stream)throw Error("Failed to decode: the 'stream' option is unsupported.");let r=new Uint8Array(t),n=0,i=r.length,o=[];for(;n<i;){let t=r[n++];if(0===t)break;if((128&t)==0)o.push(t);else if((224&t)==192){let e=63&r[n++];o.push((31&t)<<6|e)}else if((240&t)==224){let e=63&r[n++],i=63&r[n++];o.push((31&t)<<12|e<<6|i)}else if((248&t)==240){let e=(7&t)<<18|(63&r[n++])<<12|(63&r[n++])<<6|63&r[n++];e>65535&&(e-=65536,o.push(e>>>10&1023|55296),e=56320|1023&e),o.push(e)}}return String.fromCharCode.apply(null,o)},t.TextEncoder=e,t.TextDecoder=r)}(window)},9900:function(t,e,r){"use strict";r.r(e),r.d(e,{isAnyArray:function(){return i}});let n=Object.prototype.toString;function i(t){let e=n.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},6209:function(t){"use strict";var e=Object.prototype.toString;t.exports=function(t){return"Array"===e.call(t).substr(-6,5)}},4762:function(t){"use strict";t.exports=Number.isFinite||function(t){return!("number"!=typeof t||t!=t||t===1/0||t===-1/0)}},7364:function(t,e,r){"use strict";var n=r(4762);t.exports=Number.isInteger||function(t){return"number"==typeof t&&n(t)&&Math.floor(t)===t}},9786:function(t,e,r){"use strict";var n=r(4539),i=r(5684);t.exports={encode:n,decode:i}},5684:function(t,e,r){"use strict";var n=r(8620).Buffer,i=function(){var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,r=799,n=3406,i=2276,o=1567,a=3784,s=5793,h=2896;function l(){}function u(t,e){for(var r,n,i=0,o=[],a=16;a>0&&!t[a-1];)a--;o.push({children:[],index:0});var s,h=o[0];for(r=0;r<a;r++){for(n=0;n<t[r];n++){for((h=o.pop()).children[h.index]=e[i];h.index>0;){if(0===o.length)throw Error("Could not recreate Huffman Table");h=o.pop()}for(h.index++,o.push(h);o.length<=r;)o.push(s={children:[],index:0}),h.children[h.index]=s.children,h=s;i++}r+1<a&&(o.push(s={children:[],index:0}),h.children[h.index]=s.children,h=s)}return o[0].children}function c(e,r,n,i,o,a,s,h,l,u){n.precision,n.samplesPerLine,n.scanLines;var c,f,d,p=n.mcusPerLine,m=n.progressive;n.maxH,n.maxV;var g=r,v=0,y=0;function b(){if(y>0)return y--,v>>y&1;if(255==(v=e[r++])){var t=e[r++];if(t)throw Error("unexpected marker: "+(v<<8|t).toString(16))}return y=7,v>>>7}function w(t){for(var e,r=t;null!==(e=b());){if("number"==typeof(r=r[e]))return r;if("object"!=typeof r)throw Error("invalid huffman sequence")}return null}function x(t){for(var e=0;t>0;){var r=b();if(null===r)return;e=e<<1|r,t--}return e}function M(t){var e=x(t);return e>=1<<t-1?e:e+(-1<<t)+1}function k(e,r){var n=w(e.huffmanTableDC),i=0===n?0:M(n);r[0]=e.pred+=i;for(var o=1;o<64;){var a=w(e.huffmanTableAC),s=15&a,h=a>>4;if(0===s){if(h<15)break;o+=16;continue}r[t[o+=h]]=M(s),o++}}function E(t,e){var r=w(t.huffmanTableDC),n=0===r?0:M(r)<<l;e[0]=t.pred+=n}function A(t,e){e[0]|=b()<<l}var _=0;function S(e,r){if(_>0){_--;return}for(var n=a,i=s;n<=i;){var o=w(e.huffmanTableAC),h=15&o,u=o>>4;if(0===h){if(u<15){_=x(u)+(1<<u)-1;break}n+=16;continue}r[t[n+=u]]=M(h)*(1<<l),n++}}var D,P=0;function C(e,r){for(var n=a,i=s,o=0;n<=i;){var h=t[n],u=r[h]<0?-1:1;switch(P){case 0:var c=w(e.huffmanTableAC),f=15&c,o=c>>4;if(0===f)o<15?(_=x(o)+(1<<o),P=4):(o=16,P=1);else{if(1!==f)throw Error("invalid ACn encoding");D=M(f),P=o?2:3}continue;case 1:case 2:r[h]?r[h]+=(b()<<l)*u:0==--o&&(P=2==P?3:0);break;case 3:r[h]?r[h]+=(b()<<l)*u:(r[h]=D<<l,P=0);break;case 4:r[h]&&(r[h]+=(b()<<l)*u)}n++}4===P&&0==--_&&(P=0)}function I(t,e,r,n,i){var o=r/p|0,a=r%p,s=o*t.v+n,h=a*t.h+i;void 0===t.blocks[s]&&u.tolerantDecoding||e(t,t.blocks[s][h])}function T(t,e,r){var n=r/t.blocksPerLine|0,i=r%t.blocksPerLine;void 0===t.blocks[n]&&u.tolerantDecoding||e(t,t.blocks[n][i])}var B=i.length;F=m?0===a?0===h?E:A:0===h?S:C:k;var R,U,L,O,N,F,z,Y=0;for(c=1==B?i[0].blocksPerLine*i[0].blocksPerColumn:p*n.mcusPerColumn,o||(o=c);Y<c;){for(U=0;U<B;U++)i[U].pred=0;if(_=0,1==B)for(N=0,R=i[0];N<o;N++)T(R,F,Y),Y++;else for(N=0;N<o;N++){for(U=0;U<B;U++)for(L=0,f=(R=i[U]).h,d=R.v;L<d;L++)for(O=0;O<f;O++)I(R,F,Y,L,O);if(++Y===c)break}if(Y===c)do{if(255===e[r]&&0!==e[r+1])break;r+=1}while(r<e.length-2);if(y=0,(z=e[r]<<8|e[r+1])<65280)throw Error("marker was not found");if(z>=65488&&z<=65495)r+=2;else break}return r-g}function f(t,l){var u,c,f=[],d=l.blocksPerLine,p=l.blocksPerColumn,m=d<<3,v=new Int32Array(64),y=new Uint8Array(64);function b(t,u,c){var f,d,p,m,g,v,y,b,w,x,M=l.quantizationTable,k=c;for(x=0;x<64;x++)k[x]=t[x]*M[x];for(x=0;x<8;++x){var E=8*x;if(0==k[1+E]&&0==k[2+E]&&0==k[3+E]&&0==k[4+E]&&0==k[5+E]&&0==k[6+E]&&0==k[7+E]){w=s*k[0+E]+512>>10,k[0+E]=w,k[1+E]=w,k[2+E]=w,k[3+E]=w,k[4+E]=w,k[5+E]=w,k[6+E]=w,k[7+E]=w;continue}f=s*k[0+E]+128>>8,d=s*k[4+E]+128>>8,p=k[2+E],m=k[6+E],g=h*(k[1+E]-k[7+E])+128>>8,b=h*(k[1+E]+k[7+E])+128>>8,v=k[3+E]<<4,y=k[5+E]<<4,w=f-d+1>>1,f=f+d+1>>1,d=w,w=p*a+m*o+128>>8,p=p*o-m*a+128>>8,m=w,w=g-y+1>>1,g=g+y+1>>1,y=w,w=b+v+1>>1,v=b-v+1>>1,b=w,w=f-m+1>>1,f=f+m+1>>1,m=w,w=d-p+1>>1,d=d+p+1>>1,p=w,w=g*i+b*n+2048>>12,g=g*n-b*i+2048>>12,b=w,w=v*r+y*e+2048>>12,v=v*e-y*r+2048>>12,y=w,k[0+E]=f+b,k[7+E]=f-b,k[1+E]=d+y,k[6+E]=d-y,k[2+E]=p+v,k[5+E]=p-v,k[3+E]=m+g,k[4+E]=m-g}for(x=0;x<8;++x){var A=x;if(0==k[8+A]&&0==k[16+A]&&0==k[24+A]&&0==k[32+A]&&0==k[40+A]&&0==k[48+A]&&0==k[56+A]){w=s*c[x+0]+8192>>14,k[0+A]=w,k[8+A]=w,k[16+A]=w,k[24+A]=w,k[32+A]=w,k[40+A]=w,k[48+A]=w,k[56+A]=w;continue}f=s*k[0+A]+2048>>12,d=s*k[32+A]+2048>>12,p=k[16+A],m=k[48+A],g=h*(k[8+A]-k[56+A])+2048>>12,b=h*(k[8+A]+k[56+A])+2048>>12,v=k[24+A],y=k[40+A],w=f-d+1>>1,f=f+d+1>>1,d=w,w=p*a+m*o+2048>>12,p=p*o-m*a+2048>>12,m=w,w=g-y+1>>1,g=g+y+1>>1,y=w,w=b+v+1>>1,v=b-v+1>>1,b=w,w=f-m+1>>1,f=f+m+1>>1,m=w,w=d-p+1>>1,d=d+p+1>>1,p=w,w=g*i+b*n+2048>>12,g=g*n-b*i+2048>>12,b=w,w=v*r+y*e+2048>>12,v=v*e-y*r+2048>>12,y=w,k[0+A]=f+b,k[56+A]=f-b,k[8+A]=d+y,k[48+A]=d-y,k[16+A]=p+v,k[40+A]=p-v,k[24+A]=m+g,k[32+A]=m-g}for(x=0;x<64;++x){var _=128+(k[x]+8>>4);u[x]=_<0?0:_>255?255:_}}g(m*p*8);for(var w=0;w<p;w++){var x=w<<3;for(u=0;u<8;u++)f.push(new Uint8Array(m));for(var M=0;M<d;M++){b(l.blocks[w][M],y,v);var k=0,E=M<<3;for(c=0;c<8;c++){var A=f[x+c];for(u=0;u<8;u++)A[E+u]=y[k++]}}}return f}function d(t){return t<0?0:t>255?255:t}l.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=(function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}).bind(this),e.send(null)},parse:function(e){var r=1e6*this.opts.maxResolutionInMP,n=0;function i(){var t=e[n]<<8|e[n+1];return n+=2,t}function o(){var t=i(),r=e.subarray(n,n+t-2);return n+=r.length,r}function a(t){var e,r,n=1,i=1;for(r in t.components)t.components.hasOwnProperty(r)&&(n<(e=t.components[r]).h&&(n=e.h),i<e.v&&(i=e.v));var o=Math.ceil(t.samplesPerLine/8/n),a=Math.ceil(t.scanLines/8/i);for(r in t.components)if(t.components.hasOwnProperty(r)){e=t.components[r];var s=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/n),h=Math.ceil(Math.ceil(t.scanLines/8)*e.v/i),l=o*e.h,u=a*e.v,c=[];g(u*l*256);for(var f=0;f<u;f++){for(var d=[],p=0;p<l;p++)d.push(new Int32Array(64));c.push(d)}e.blocksPerLine=s,e.blocksPerColumn=h,e.blocks=c}t.maxH=n,t.maxV=i,t.mcusPerLine=o,t.mcusPerColumn=a}e.length;var s=null,h=null,l=[],d=[],p=[],m=[],v=i(),y=-1;if(this.comments=[],65496!=v)throw Error("SOI not found");for(v=i();65497!=v;){switch(v){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var b=o();if(65534===v){var w=String.fromCharCode.apply(null,b);this.comments.push(w)}65504===v&&74===b[0]&&70===b[1]&&73===b[2]&&70===b[3]&&0===b[4]&&(s={version:{major:b[5],minor:b[6]},densityUnits:b[7],xDensity:b[8]<<8|b[9],yDensity:b[10]<<8|b[11],thumbWidth:b[12],thumbHeight:b[13],thumbData:b.subarray(14,14+3*b[12]*b[13])}),65505===v&&69===b[0]&&120===b[1]&&105===b[2]&&102===b[3]&&0===b[4]&&(this.exifBuffer=b.subarray(5,b.length)),65518===v&&65===b[0]&&100===b[1]&&111===b[2]&&98===b[3]&&101===b[4]&&0===b[5]&&(h={version:b[6],flags0:b[7]<<8|b[8],flags1:b[9]<<8|b[10],transformCode:b[11]});break;case 65499:for(var x=i()+n-2;n<x;){var M=e[n++];g(256);var k=new Int32Array(64);if(M>>4==0)for(C=0;C<64;C++){var E=t[C];k[E]=e[n++]}else if(M>>4==1)for(C=0;C<64;C++){var E=t[C];k[E]=i()}else throw Error("DQT: invalid table spec");l[15&M]=k}break;case 65472:case 65473:case 65474:i(),(S={}).extended=65473===v,S.progressive=65474===v,S.precision=e[n++],S.scanLines=i(),S.samplesPerLine=i(),S.components={},S.componentsOrder=[];var A=S.scanLines*S.samplesPerLine;if(A>r){var _=Math.ceil((A-r)/1e6);throw Error("maxResolutionInMP limit exceeded by ".concat(_,"MP"))}var S,D,P,C,I,T=e[n++];for(P=0;P<T;P++){I=e[n];var B=e[n+1]>>4,R=15&e[n+1],U=e[n+2];if(B<=0||R<=0)throw Error("Invalid sampling factor, expected values above 0");S.componentsOrder.push(I),S.components[I]={h:B,v:R,quantizationIdx:U},n+=3}a(S),d.push(S);break;case 65476:var L=i();for(P=2;P<L;){var O=e[n++],N=new Uint8Array(16),F=0;for(C=0;C<16;C++,n++)F+=N[C]=e[n];g(16+F);var z=new Uint8Array(F);for(C=0;C<F;C++,n++)z[C]=e[n];P+=17+F,(O>>4==0?m:p)[15&O]=u(N,z)}break;case 65501:i(),D=i();break;case 65500:i(),i();break;case 65498:i();var Y,X=e[n++],V=[];for(P=0;P<X;P++){Y=S.components[e[n++]];var j=e[n++];Y.huffmanTableDC=m[j>>4],Y.huffmanTableAC=p[15&j],V.push(Y)}var G=e[n++],q=e[n++],H=e[n++],W=c(e,n,S,V,D,G,q,H>>4,15&H,this.opts);n+=W;break;case 65535:255!==e[n]&&n--;break;default:if(255==e[n-3]&&e[n-2]>=192&&e[n-2]<=254){n-=3;break}if(224===v||225==v){if(-1!==y)throw Error("first unknown JPEG marker at offset ".concat(y.toString(16),", second unknown JPEG marker ").concat(v.toString(16)," at offset ").concat((n-1).toString(16)));y=n-1;let t=i();if(255===e[n+t-2]){n+=t-2;break}}throw Error("unknown JPEG marker "+v.toString(16))}v=i()}if(1!=d.length)throw Error("only single frame JPEGs supported");for(var P=0;P<d.length;P++){var K=d[P].components;for(var C in K)K[C].quantizationTable=l[K[C].quantizationIdx],delete K[C].quantizationIdx}this.width=S.samplesPerLine,this.height=S.scanLines,this.jfif=s,this.adobe=h,this.components=[];for(var P=0;P<S.componentsOrder.length;P++){var Y=S.components[S.componentsOrder[P]];this.components.push({lines:f(S,Y),scaleX:Y.h/S.maxH,scaleY:Y.v/S.maxV})}},getData:function(t,e){var r,n,i,o,a,s,h,l,u,c,f,p,m,v,y,b,w,x,M,k,E,A=this.width/t,_=this.height/e,S=0,D=t*e*this.components.length;g(D);var P=new Uint8Array(D);switch(this.components.length){case 1:for(c=0,r=this.components[0];c<e;c++)for(u=0,a=r.lines[0|c*r.scaleY*_];u<t;u++)f=a[0|u*r.scaleX*A],P[S++]=f;break;case 2:for(c=0,r=this.components[0],n=this.components[1];c<e;c++)for(u=0,a=r.lines[0|c*r.scaleY*_],s=n.lines[0|c*n.scaleY*_];u<t;u++)f=a[0|u*r.scaleX*A],P[S++]=f,f=s[0|u*n.scaleX*A],P[S++]=f;break;case 3:for(E=!0,this.adobe&&this.adobe.transformCode?E=!0:void 0!==this.opts.colorTransform&&(E=!!this.opts.colorTransform),r=this.components[0],n=this.components[1],i=this.components[2],c=0;c<e;c++)for(u=0,a=r.lines[0|c*r.scaleY*_],s=n.lines[0|c*n.scaleY*_],h=i.lines[0|c*i.scaleY*_];u<t;u++)E?(f=a[0|u*r.scaleX*A],p=s[0|u*n.scaleX*A],x=d(f+1.402*((m=h[0|u*i.scaleX*A])-128)),M=d(f-.3441363*(p-128)-.71413636*(m-128)),k=d(f+1.772*(p-128))):(x=a[0|u*r.scaleX*A],M=s[0|u*n.scaleX*A],k=h[0|u*i.scaleX*A]),P[S++]=x,P[S++]=M,P[S++]=k;break;case 4:if(!this.adobe)throw Error("Unsupported color mode (4 components)");for(E=!1,this.adobe&&this.adobe.transformCode?E=!0:void 0!==this.opts.colorTransform&&(E=!!this.opts.colorTransform),r=this.components[0],n=this.components[1],i=this.components[2],o=this.components[3],c=0;c<e;c++)for(u=0,a=r.lines[0|c*r.scaleY*_],s=n.lines[0|c*n.scaleY*_],h=i.lines[0|c*i.scaleY*_],l=o.lines[0|c*o.scaleY*_];u<t;u++)E?(f=a[0|u*r.scaleX*A],p=s[0|u*n.scaleX*A],m=h[0|u*i.scaleX*A],v=l[0|u*o.scaleX*A],y=255-d(f+1.402*(m-128)),b=255-d(f-.3441363*(p-128)-.71413636*(m-128)),w=255-d(f+1.772*(p-128))):(y=a[0|u*r.scaleX*A],b=s[0|u*n.scaleX*A],w=h[0|u*i.scaleX*A],v=l[0|u*o.scaleX*A]),P[S++]=255-y,P[S++]=255-b,P[S++]=255-w,P[S++]=255-v;break;default:throw Error("Unsupported color mode")}return P},copyToImageData:function(t,e){var r,n,i,o,a,s,h,l,u,c=t.width,f=t.height,p=t.data,m=this.getData(c,f),g=0,v=0;switch(this.components.length){case 1:for(u=0;u<f;u++)for(l=0;l<c;l++)r=m[g++],p[v++]=r,p[v++]=r,p[v++]=r,e&&(p[v++]=255);break;case 3:for(u=0;u<f;u++)for(l=0;l<c;l++)a=m[g++],s=m[g++],h=m[g++],p[v++]=a,p[v++]=s,p[v++]=h,e&&(p[v++]=255);break;case 4:for(u=0;u<f;u++)for(l=0;l<c;l++)i=m[g++],o=m[g++],r=m[g++],a=255-d(i*(1-(n=m[g++])/255)+n),s=255-d(o*(1-n/255)+n),h=255-d(r*(1-n/255)+n),p[v++]=a,p[v++]=s,p[v++]=h,e&&(p[v++]=255);break;default:throw Error("Unsupported color mode")}}};var p=0,m=0;function g(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;var e=p+t;if(e>m){var r=Math.ceil((e-m)/1024/1024);throw Error("maxMemoryUsageInMB limit exceeded by at least ".concat(r,"MB"))}p=e}return l.resetMaxMemoryUsage=function(t){p=0,m=t},l.getBytesAllocated=function(){return p},l.requestMemoryAllocation=g,l}();function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...e},o=new Uint8Array(t),a=new i;a.opts=r,i.resetMaxMemoryUsage(1048576*r.maxMemoryUsageInMB),a.parse(o);var s=r.formatAsRGBA?4:3,h=a.width*a.height*s;try{i.requestMemoryAllocation(h);var l={width:a.width,height:a.height,exifBuffer:a.exifBuffer,data:r.useTArray?new Uint8Array(h):n.alloc(h)};a.comments.length>0&&(l.comments=a.comments)}catch(t){if(t instanceof RangeError)throw Error("Could not allocate enough memory for the image. Required: "+h);if(t instanceof ReferenceError&&"Buffer is not defined"===t.message)throw Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw t}return a.copyToImageData(l,r.formatAsRGBA),l}t.exports=o},4539:function(t,e,r){"use strict";var n=r(8620).Buffer;function i(t){var e,r,i,o,a,s=Math.floor,h=Array(64),l=Array(64),u=Array(64),c=Array(64),f=Array(65535),d=Array(65535),p=Array(64),m=Array(64),g=[],v=0,y=7,b=Array(64),w=Array(64),x=Array(64),M=Array(256),k=Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],_=[0,1,2,3,4,5,6,7,8,9,10,11],S=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],D=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],T=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function B(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var n=s((e[r]*t+50)/100);n<1?n=1:n>255&&(n=255),h[E[r]]=n}for(var i=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],o=0;o<64;o++){var a=s((i[o]*t+50)/100);a<1?a=1:a>255&&(a=255),l[E[o]]=a}for(var f=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],d=0,p=0;p<8;p++)for(var m=0;m<8;m++)u[d]=1/(h[E[d]]*f[p]*f[m]*8),c[d]=1/(l[E[d]]*f[p]*f[m]*8),d++}function R(t,e){for(var r=0,n=0,i=[],o=1;o<=16;o++){for(var a=1;a<=t[o];a++)i[e[n]]=[],i[e[n]][0]=r,i[e[n]][1]=o,n++,r++;r*=2}return i}function U(){e=R(A,_),r=R(P,C),i=R(S,D),o=R(I,T)}function L(){for(var t=1,e=2,r=1;r<=15;r++){for(var n=t;n<e;n++)d[32767+n]=r,f[32767+n]=[],f[32767+n][1]=r,f[32767+n][0]=n;for(var i=-(e-1);i<=-t;i++)d[32767+i]=r,f[32767+i]=[],f[32767+i][1]=r,f[32767+i][0]=e-1+i;t<<=1,e<<=1}}function O(){for(var t=0;t<256;t++)k[t]=19595*t,k[t+256>>0]=38470*t,k[t+512>>0]=7471*t+32768,k[t+768>>0]=-11059*t,k[t+1024>>0]=-21709*t,k[t+1280>>0]=32768*t+8421375,k[t+1536>>0]=-27439*t,k[t+1792>>0]=-5329*t}function N(t){for(var e=t[0],r=t[1]-1;r>=0;)e&1<<r&&(v|=1<<y),r--,--y<0&&(255==v?(F(255),F(0)):F(v),y=7,v=0)}function F(t){g.push(t)}function z(t){F(t>>8&255),F(255&t)}function Y(t,e){var r,n,i,o,a,s,h,l,u,c,f=0,d=8,m=64;for(u=0;u<d;++u){r=t[f],n=t[f+1],i=t[f+2],o=t[f+3],a=t[f+4],s=t[f+5],h=t[f+6];var g=r+(l=t[f+7]),v=r-l,y=n+h,b=n-h,w=i+s,x=i-s,M=o+a,k=o-a,E=g+M,A=g-M,_=y+w,S=y-w;t[f]=E+_,t[f+4]=E-_;var D=(S+A)*.707106781;t[f+2]=A+D,t[f+6]=A-D,E=k+x,_=x+b;var P=(E-(S=b+v))*.382683433,C=.5411961*E+P,I=1.306562965*S+P,T=.707106781*_,B=v+T,R=v-T;t[f+5]=R+C,t[f+3]=R-C,t[f+1]=B+I,t[f+7]=B-I,f+=8}for(u=0,f=0;u<d;++u){r=t[f],n=t[f+8],i=t[f+16],o=t[f+24],a=t[f+32],s=t[f+40],h=t[f+48];var U=r+(l=t[f+56]),L=r-l,O=n+h,N=n-h,F=i+s,z=i-s,Y=o+a,X=o-a,V=U+Y,j=U-Y,G=O+F,q=O-F;t[f]=V+G,t[f+32]=V-G;var H=(q+j)*.707106781;t[f+16]=j+H,t[f+48]=j-H,V=X+z,G=z+N;var W=(V-(q=N+L))*.382683433,K=.5411961*V+W,J=1.306562965*q+W,Q=.707106781*G,Z=L+Q,$=L-Q;t[f+40]=$+K,t[f+24]=$-K,t[f+8]=Z+J,t[f+56]=Z-J,f++}for(u=0;u<m;++u)c=t[u]*e[u],p[u]=c>0?c+.5|0:c-.5|0;return p}function X(){z(65504),z(16),F(74),F(70),F(73),F(70),F(0),F(1),F(1),F(0),z(1),z(1),F(0),F(0)}function V(t){if(t){z(65505),69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]?z(t.length+2):(z(t.length+5+2),F(69),F(120),F(105),F(102),F(0));for(var e=0;e<t.length;e++)F(t[e])}}function j(t,e){z(65472),z(17),F(8),z(e),z(t),F(3),F(1),F(17),F(0),F(2),F(17),F(1),F(3),F(17),F(1)}function G(){z(65499),z(132),F(0);for(var t=0;t<64;t++)F(h[t]);F(1);for(var e=0;e<64;e++)F(l[e])}function q(){z(65476),z(418),F(0);for(var t=0;t<16;t++)F(A[t+1]);for(var e=0;e<=11;e++)F(_[e]);F(16);for(var r=0;r<16;r++)F(S[r+1]);for(var n=0;n<=161;n++)F(D[n]);F(1);for(var i=0;i<16;i++)F(P[i+1]);for(var o=0;o<=11;o++)F(C[o]);F(17);for(var a=0;a<16;a++)F(I[a+1]);for(var s=0;s<=161;s++)F(T[s])}function H(t){void 0!==t&&t.constructor===Array&&t.forEach(t=>{if("string"==typeof t){z(65534);var e,r=t.length;for(z(r+2),e=0;e<r;e++)F(t.charCodeAt(e))}})}function W(){z(65498),z(12),F(3),F(1),F(0),F(2),F(17),F(3),F(17),F(0),F(63),F(0)}function K(t,e,r,n,i){for(var o,a,s=i[0],h=i[240],l=16,u=63,c=64,p=Y(t,e),g=0;g<c;++g)m[E[g]]=p[g];var v=m[0]-r;r=m[0],0==v?N(n[0]):(N(n[d[o=32767+v]]),N(f[o]));for(var y=63;y>0&&0==m[y];y--);if(0==y)return N(s),r;for(var b=1;b<=y;){for(var w=b;0==m[b]&&b<=y;++b);var x=b-w;if(x>=l){a=x>>4;for(var M=1;M<=a;++M)N(h);x&=15}N(i[(x<<4)+d[o=32767+m[b]]]),N(f[o]),b++}return y!=u&&N(s),r}function J(){for(var t=String.fromCharCode,e=0;e<256;e++)M[e]=t(e)}function Q(t){if(t<=0&&(t=1),t>100&&(t=100),a!=t){var e=0;e=t<50?Math.floor(5e3/t):Math.floor(200-2*t),B(e),a=t}}this.encode=function(t,a){new Date().getTime(),a&&Q(a),g=[],v=0,y=7,z(65496),X(),H(t.comments),V(t.exifBuffer),G(),j(t.width,t.height),q(),W();var s=0,h=0,l=0;v=0,y=7,this.encode.displayName="_encode_";for(var f,d,p,m,M,E,A,_,S,D=t.data,P=t.width,C=t.height,I=4*P,T=0;T<C;){for(S=0;S<I;){for(_=0,M=m=I*T+S,E=-1,A=0;_<64;_++)M=m+(A=_>>3)*I+(E=(7&_)*4),T+A>=C&&(M-=I*(T+1+A-C)),S+E>=I&&(M-=S+E-I+4),f=D[M++],d=D[M++],p=D[M++],b[_]=(k[f]+k[d+256>>0]+k[p+512>>0]>>16)-128,w[_]=(k[f+768>>0]+k[d+1024>>0]+k[p+1280>>0]>>16)-128,x[_]=(k[f+1280>>0]+k[d+1536>>0]+k[p+1792>>0]>>16)-128;s=K(b,u,s,e,i),h=K(w,c,h,r,o),l=K(x,c,l,r,o),S+=32}T+=8}if(y>=0){var B=[];B[1]=y+1,B[0]=(1<<y+1)-1,N(B)}return z(65497),n.from(g)},function(){new Date().getTime(),t||(t=50),J(),U(),L(),O(),Q(t),new Date().getTime()}()}function o(t,e){return void 0===e&&(e=50),{data:new i(e).encode(t,e),width:t.width,height:t.height}}t.exports=o},5339:function(t){"use strict";!function(e){t.exports=e()}(function(){return(function t(e,r,n){function i(a,s){if(!r[a]){if(!e[a]){var h=void 0;if(!s&&h)return require(a,!0);if(o)return o(a,!0);var l=Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[a]={exports:{}};e[a][0].call(u.exports,function(t){return i(e[a][1][t]||t)},u,u.exports,t,e,r,n)}return r[a].exports}for(var o=void 0,a=0;a<n.length;a++)i(n[a]);return i})({1:[function(t,e,r){var n,i,o,a,s,h=function(t,e){for(var r in e)l.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l={}.hasOwnProperty;n=t("./PriorityQueue/AbstractPriorityQueue"),i=t("./PriorityQueue/ArrayStrategy"),a=t("./PriorityQueue/BinaryHeapStrategy"),o=t("./PriorityQueue/BHeapStrategy"),(s=function(t){function e(t){t||(t={}),t.strategy||(t.strategy=a),t.comparator||(t.comparator=function(t,e){return(t||0)-(e||0)}),e.__super__.constructor.call(this,t)}return h(e,t),e}(n)).ArrayStrategy=i,s.BinaryHeapStrategy=a,s.BHeapStrategy=o,e.exports=s},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(t,e,r){e.exports=function(){function t(t){var e;if((null!=t?t.strategy:void 0)==null)throw"Must pass options.strategy, a strategy";if((null!=t?t.comparator:void 0)==null)throw"Must pass options.comparator, a comparator";this.priv=new t.strategy(t),this.length=(null!=t&&null!=(e=t.initialValues)?e.length:void 0)||0}return t.prototype.queue=function(t){this.length++,this.priv.queue(t)},t.prototype.dequeue=function(t){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},t.prototype.peek=function(t){if(!this.length)throw"Empty queue";return this.priv.peek()},t.prototype.clear=function(){return this.length=0,this.priv.clear()},t}()},{}],3:[function(t,e,r){var n;n=function(t,e,r){var n,i,o;for(i=0,n=t.length;i<n;)r(t[o=i+n>>>1],e)>=0?i=o+1:n=o;return i},e.exports=function(){function t(t){var e;this.options=t,this.comparator=this.options.comparator,this.data=(null!=(e=this.options.initialValues)?e.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return t.prototype.queue=function(t){var e;e=n(this.data,t,this.comparator),this.data.splice(e,0,t)},t.prototype.dequeue=function(){return this.data.pop()},t.prototype.peek=function(){return this.data[this.data.length-1]},t.prototype.clear=function(){this.data.length=0},t}()},{}],4:[function(t,e,r){e.exports=function(){function t(t){var e,r,n,i,o,a,s,h,l;for(this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.pageSize=(null!=t?t.pageSize:void 0)||512,this.length=0,h=0;1<<h<this.pageSize;)h+=1;if(1<<h!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=h,this._emptyMemoryPageTemplate=e=[],r=n=0,a=this.pageSize;0<=a?n<a:n>a;r=0<=a?++n:--n)e.push(null);if(this._memory=[],this._mask=this.pageSize-1,t.initialValues)for(i=0,o=(s=t.initialValues).length;i<o;i++)l=s[i],this.queue(l)}return t.prototype.queue=function(t){this.length+=1,this._write(this.length,t),this._bubbleUp(this.length,t)},t.prototype.dequeue=function(){var t,e;return t=this._read(1),e=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,e),this._bubbleDown(1,e)),t},t.prototype.peek=function(){return this._read(1)},t.prototype.clear=function(){this.length=0,this._memory.length=0},t.prototype._write=function(t,e){var r;for(r=t>>this._shift;r>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[r][t&this._mask]=e},t.prototype._read=function(t){return this._memory[t>>this._shift][t&this._mask]},t.prototype._bubbleUp=function(t,e){var r,n,i,o;for(r=this.comparator;t>1&&(n=t&this._mask,t<this.pageSize||n>3?i=t&~this._mask|n>>1:n<2?(i=t-this.pageSize>>this._shift,i+=i&~(this._mask>>1),i|=this.pageSize>>1):i=t-2,!(0>r(o=this._read(i),e)));)this._write(i,e),this._write(t,o),t=i},t.prototype._bubbleDown=function(t,e){var r,n,i,o,a;for(a=this.comparator;t<this.length;)if(t>this._mask&&!(t&this._mask-1)?r=n=t+2:n=t&this.pageSize>>1?(r=(r=(t&~this._mask)>>1|t&this._mask>>1)+1<<this._shift)+1:(r=t+(t&this._mask))+1,r!==n&&n<=this.length){if(i=this._read(r),o=this._read(n),0>a(i,e)&&0>=a(i,o))this._write(r,e),this._write(t,i),t=r;else if(0>a(o,e))this._write(n,e),this._write(t,o),t=n;else break}else if(r<=this.length){if(0>a(i=this._read(r),e))this._write(r,e),this._write(t,i),t=r;else break}else break},t}()},{}],5:[function(t,e,r){e.exports=function(){function t(t){var e;this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.length=0,this.data=(null!=(e=t.initialValues)?e.slice(0):void 0)||[],this._heapify()}return t.prototype._heapify=function(){var t,e,r;if(this.data.length>0)for(t=e=1,r=this.data.length;1<=r?e<r:e>r;t=1<=r?++e:--e)this._bubbleUp(t)},t.prototype.queue=function(t){this.data.push(t),this._bubbleUp(this.data.length-1)},t.prototype.dequeue=function(){var t,e;return e=this.data[0],t=this.data.pop(),this.data.length>0&&(this.data[0]=t,this._bubbleDown(0)),e},t.prototype.peek=function(){return this.data[0]},t.prototype.clear=function(){this.length=0,this.data.length=0},t.prototype._bubbleUp=function(t){for(var e,r;t>0;)if(e=t-1>>>1,0>this.comparator(this.data[t],this.data[e]))r=this.data[e],this.data[e]=this.data[t],this.data[t]=r,t=e;else break},t.prototype._bubbleDown=function(t){var e,r,n,i,o;for(e=this.data.length-1;;)if(i=(r=(t<<1)+1)+1,n=t,r<=e&&0>this.comparator(this.data[r],this.data[n])&&(n=r),i<=e&&0>this.comparator(this.data[i],this.data[n])&&(n=i),n!==t)o=this.data[n],this.data[n]=this.data[t],this.data[t]=o,t=n;else break},t}()},{}]},{},[1])(1)})},3766:function(t){"use strict";!function(e,r){t.exports=r()}(0,function(){function t(t){return"string"==typeof t||t instanceof String}var e=Number.isFinite||window.isFinite;function r(t){return e(t)}function n(t){return t}function i(t){var e={};return t.filter(function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)})}function o(t,e){if(e.length!==t.length)return!1;for(var r=0;r<t.length;r++)if(e[r].compareArray&&!e[r].compareArray(t[r])||e[r]!==t[r])return!1;return!0}function a(t,e){Object.keys(e).forEach(function(r){t[r]=e[r]})}function s(){for(var t=1,e=0,r=0;r<arguments.length;r++){var n=arguments[r];e+=u(n),t*=n}return 0!==e?l(t,e):t}function h(t,e){if(0===e)throw Error("Divide by zero");var r=Math.pow(10,u(e));return s(t,r/(r*e))}function l(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function u(t){if(!isFinite(t))return 0;for(var e=0;t%1!=0;)t*=10,e++;return e}function c(){var t;if(!this)return t=Object.create(c.prototype),c.apply(t,arguments),t;t=Error.apply(this,arguments),this.name="QtyError",this.message=t.message,this.stack=t.stack}function f(t,e){throw new c("Incompatible units: "+t+" and "+e)}c.prototype=Object.create(Error.prototype,{constructor:{value:c}});var d={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],1024,"prefix"],"<mebi>":[["Mi","Mebi","mebi"],1048576,"prefix"],"<gibi>":[["Gi","Gibi","gibi"],1073741824,"prefix"],"<tebi>":[["Ti","Tebi","tebi"],1099511627776,"prefix"],"<pebi>":[["Pi","Pebi","pebi"],0x4000000000000,"prefix"],"<exi>":[["Ei","Exi","exi"],0x1000000000000000,"prefix"],"<zebi>":[["Zi","Zebi","zebi"],11805916207174113e5,"prefix"],"<yebi>":[["Yi","Yebi","yebi"],12089258196146292e8,"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","","\xb5","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],352777778e-12,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],94635295e-11,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],473176475e-12,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],56826125e-11,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],236588238e-12,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","",""],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},p=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],m="<1>",g=[m];function v(t,e){var n=e[1],i=e[3]||[],o=e[4]||[];if(!r(n))throw new c(t+": Invalid unit definition. 'scalar' must be a number");i.forEach(function(e){if(void 0===d[e])throw new c(t+": Invalid unit definition. Unit "+e+" in 'numerator' is not recognized")}),o.forEach(function(e){if(void 0===d[e])throw new c(t+": Invalid unit definition. Unit "+e+" in 'denominator' is not recognized")})}var y={},b={},w={},x={},M={};for(var k in d)if(d.hasOwnProperty(k)){var E=d[k];if("prefix"===E[2]){y[k]=E[1];for(var A=0;A<E[0].length;A++)b[E[0][A]]=k}else{v(k,E),w[k]={scalar:E[1],numerator:E[3],denominator:E[4]};for(var _=0;_<E[0].length;_++)x[E[0][_]]=k}M[k]=E[0][0]}function S(t){var e,r=[],n=Object.keys(d);if(void 0===t)for(e=0;e<n.length;e++)-1===["","prefix"].indexOf(d[n[e]][2])&&r.push(n[e].substr(1,n[e].length-2));else if(-1===this.getKinds().indexOf(t))throw new c("Kind not recognized");else for(e=0;e<n.length;e++)d[n[e]][2]===t&&r.push(n[e].substr(1,n[e].length-2));return r.sort(function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0})}function D(t){if(!x[t])throw new c("Unit not recognized");return d[x[t]][0]}var P=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function C(){if(this.signature)return this.signature;for(var t=I.call(this),e=0;e<t.length;e++)t[e]*=Math.pow(20,e);return t.reduce(function(t,e){return t+e},0)}function I(){if(!this.isBase())return I.call(this.toBase());for(var t,e,r=Array(P.length),n=0;n<r.length;n++)r[n]=0;for(var i=0;i<this.numerator.length;i++)(t=d[this.numerator[i]])&&(e=P.indexOf(t[2]))>=0&&(r[e]=r[e]+1);for(var o=0;o<this.denominator.length;o++)(t=d[this.denominator[o]])&&(e=P.indexOf(t[2]))>=0&&(r[e]=r[e]-1);return r}var T="[+-]",B="\\d+",R=T+"?"+B,U="\\."+B,L=RegExp("^"+("("+(T+"?\\s*"+("(?:"+("(?:"+B+"(?:"+U+")?)|(?:")+U+"))(?:[Ee]"))+R)+")?)?\\s*([^/]*)(?:/(.+))?$"),O="\\^|\\*{2}",N="[01234]",F=RegExp("([^ \\*\\d]+?)(?:"+O+")?(-?"+N+"(?![a-zA-Z]))"),z=RegExp("([^ \\*\\d]+?)(?:"+O+")?("+N+"(?![a-zA-Z]))");function Y(e){t(e)||(e=e.toString()),e=e.trim();var r,n,i,o=L.exec(e);if(!o)throw new c(e+": Quantity not recognized");var a=o[1];a?(a=a.replace(/\s/g,""),this.scalar=parseFloat(a)):this.scalar=1;for(var s=o[2],h=o[3];o=F.exec(s);){if(isNaN(r=parseFloat(o[2])))throw new c("Unit exponent is not a number");if(0===r&&!V.test(o[1]))throw new c("Unit not recognized");n=o[1]+" ",i="";for(var l=0;l<Math.abs(r);l++)i+=n;r>=0?s=s.replace(o[0],i):(h=h?h+i:i,s=s.replace(o[0],""))}for(;o=z.exec(h);){if(isNaN(r=parseFloat(o[2])))throw new c("Unit exponent is not a number");if(0===r&&!V.test(o[1]))throw new c("Unit not recognized");n=o[1]+" ",i="";for(var u=0;u<r;u++)i+=n;h=h.replace(o[0],i)}s&&(this.numerator=q(s.trim())),h&&(this.denominator=q(h.trim()))}var X="("+Object.keys(b).sort(function(t,e){return e.length-t.length}).join("|")+")??("+Object.keys(x).sort(function(t,e){return e.length-t.length}).join("|")+")(?:\\b|$)",V=RegExp("^\\s*("+X+"[\\s\\*]*)+$"),j=RegExp(X,"g"),G={};function q(t){var e=G[t];if(e)return e;var r,n=[];if(!V.test(t))throw new c("Unit not recognized");for(;r=j.exec(t);)n.push(r.slice(1));return n=(n=(n=n.map(function(t){return b[t[0]]?[b[t[0]],x[t[1]]]:[x[t[1]]]})).reduce(function(t,e){return t.concat(e)},[])).filter(function(t){return t}),G[t]=n,n}function H(e){if(!t(e))throw new c("Argument should be a string");try{return this(e)}catch(t){return null}}function W(t){return t instanceof K}function K(t,e){if(J.apply(null,arguments),!W(this))return new K(t,e);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=g,this.denominator=g,Q(t)?(this.scalar=t.scalar,this.numerator=t.numerator&&0!==t.numerator.length?t.numerator:g,this.denominator=t.denominator&&0!==t.denominator.length?t.denominator:g):e?(Y.call(this,e),this.scalar=t):Y.call(this,t),this.denominator.join("*").indexOf("temp")>=0)throw new c("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new c("Cannot multiply by temperatures");if(!o(this.denominator,g))throw new c("Cannot divide with temperatures")}if(this.initValue=t,Z.call(this),this.isTemperature()&&this.baseScalar<0)throw new c("Temperatures must not be less than absolute zero")}function J(e,n){if(n){if(!(r(e)&&t(n)))throw new c("Only number accepted as initialization value when units are explicitly provided")}else if(!(t(e)||r(e)||W(e)||Q(e)))throw new c("Only string, number or quantity accepted as single initialization value")}function Q(t){return t&&"object"==typeof t&&t.hasOwnProperty("scalar")}function Z(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=C.call(this);else{var t=this.toBase();this.baseScalar=t.scalar,this.signature=t.signature}}K.prototype={constructor:K};var $={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency","25599999980":"information_rate","25600000000":"information","511999999980":"angular_velocity","512000000000":"angle"};function tt(){return i(Object.keys($).map(function(t){return $[t]}))}function te(t,e){var r=t.units(),n=e.to(r),i=K(ti(r));return K({scalar:t.scalar-n.scalar,numerator:i.numerator,denominator:i.denominator})}function tr(t,e){var r=e.to(ti(t.units()));return K({scalar:t.scalar-r.scalar,numerator:t.numerator,denominator:t.denominator})}function tn(t,e){var r=e.to(ti(t.units()));return K({scalar:t.scalar+r.scalar,numerator:t.numerator,denominator:t.denominator})}function ti(t){if("tempK"===t)return"degK";if("tempC"===t)return"degC";if("tempF"===t)return"degF";if("tempR"===t)return"degR";throw new c("Unknown type for temp conversion from: "+t)}function to(t,e){var r,n=ta(t),i=e.units();if("degK"===i)r=n.scalar;else if("degC"===i)r=n.scalar;else if("degF"===i)r=9*n.scalar/5;else if("degR"===i)r=9*n.scalar/5;else throw new c("Unknown type for degree conversion to: "+i);return K({scalar:r,numerator:e.numerator,denominator:e.denominator})}function ta(t){var e,r=t.units();if(r.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===r)e=t.scalar;else if("tempC"===r)e=t.scalar;else if("tempF"===r)e=5*t.scalar/9;else if("tempR"===r)e=5*t.scalar/9;else throw new c("Unknown type for temp conversion from: "+r);return K({scalar:e,numerator:["<kelvin>"],denominator:g})}function ts(t,e){var r,n=e.units();if("tempK"===n)r=t.baseScalar;else if("tempC"===n)r=t.baseScalar-273.15;else if("tempF"===n)r=9*t.baseScalar/5-459.67;else if("tempR"===n)r=9*t.baseScalar/5;else throw new c("Unknown type for temp conversion to: "+n);return K({scalar:r,numerator:e.numerator,denominator:e.denominator})}function th(t){var e,r=t.units();if(r.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===r)e=t.scalar;else if("tempC"===r)e=t.scalar+273.15;else if("tempF"===r)e=(t.scalar+459.67)*5/9;else if("tempR"===r)e=5*t.scalar/9;else throw new c("Unknown type for temp conversion from: "+r);return K({scalar:e,numerator:["<temp-K>"],denominator:g})}function tl(t,e){var r,i=K(t),o=K(e);return i.eq(o)?n:(r=i.isTemperature()?function(t){return i.mul(t).to(o).scalar}:function(t){return t*i.baseScalar/o.baseScalar},function(t){var e,n,i;if(!Array.isArray(t))return r(t);for(e=0,n=t.length,i=[];e<n;e++)i.push(r(t[e]));return i})}K.prototype.kind=function(){return $[this.signature.toString()]},a(K.prototype,{isDegrees:function(){return(null===this.signature||400===this.signature)&&1===this.numerator.length&&o(this.denominator,g)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}}),a(K.prototype,{to:function(e){var r,n;return null==e?this:t(e)?(r=this._conversionCache[e])?r:(n=K(e)).units()===this.units()?this:(this.isCompatible(n)?n=n.isTemperature()?ts(this,n):n.isDegrees()?to(this,n):K({scalar:h(this.baseScalar,n.baseScalar),numerator:n.numerator,denominator:n.denominator}):this.isInverse(n)?n=this.inverse().to(e):f(this.units(),n.units()),this._conversionCache[e]=n,n):this.to(e.units())},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return th(this);var t=tu[this.units()];return t||(t=tc(this.numerator,this.denominator),tu[this.units()]=t),t.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new c("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(e){if(t(e)&&(e=K(e)),r(e)&&(e=K(e+" "+this.units())),this.isUnitless()?e.isUnitless()||f(this.units(),e.units()):e=e.to(this.units()),0===e.scalar)throw new c("Divide by zero");return K(s(Math.round(this.scalar/e.scalar),e.scalar)+this.units())}});var tu={};function tc(t,e){for(var r,n=[],i=[],o=1,a=0;a<t.length;a++)y[r=t[a]]?o=s(o,y[r]):w[r]&&(o*=w[r].scalar,w[r].numerator&&n.push(w[r].numerator),w[r].denominator&&i.push(w[r].denominator));for(var h=0;h<e.length;h++)y[r=e[h]]?o/=y[r]:w[r]&&(o/=w[r].scalar,w[r].numerator&&i.push(w[r].numerator),w[r].denominator&&n.push(w[r].denominator));return K({scalar:o,numerator:n=n.reduce(function(t,e){return t.concat(e)},[]),denominator:i=i.reduce(function(t,e){return t.concat(e)},[])})}function tf(t,e,r,n){function i(t){return t!==m}t=t.filter(i),r=r.filter(i),e=e.filter(i),n=n.filter(i);var o={};function a(t,e){for(var r,n,i,a=0;a<t.length;a++)if(y[t[a]]?(r=t[a+1],i=y[n=t[a]],a++):(r=t[a],n=null,i=1),r&&r!==m){if(o[r]){o[r][0]+=e;var s=o[r][2]?y[o[r][2]]:1;o[r][1===e?3:4]*=h(i,s)}else o[r]=[e,r,n,1,1]}}a(t,1),a(e,-1),a(r,1),a(n,-1);var s=[],l=[],u=1;for(var c in o)if(o.hasOwnProperty(c)){var f,d=o[c];if(d[0]>0)for(f=0;f<d[0];f++)s.push(null===d[2]?d[1]:[d[2],d[1]]);else if(d[0]<0)for(f=0;f<-d[0];f++)l.push(null===d[2]?d[1]:[d[2],d[1]]);u*=h(d[3],d[4])}return 0===s.length&&(s=g),0===l.length&&(l=g),[s=s.reduce(function(t,e){return t.concat(e)},[]),l=l.reduce(function(t,e){return t.concat(e)},[]),u]}function td(){}function tp(t,e){return(t+" "+e).trim()}K.parse=H,K.getUnits=S,K.getAliases=D,K.mulSafe=s,K.divSafe=h,K.getKinds=tt,K.swiftConverter=tl,K.Error=c,a(K.prototype,{add:function(e){if(t(e)&&(e=K(e)),this.isCompatible(e)||f(this.units(),e.units()),this.isTemperature()&&e.isTemperature())throw new c("Cannot add two temperatures");return this.isTemperature()?tn(this,e):e.isTemperature()?tn(e,this):K({scalar:this.scalar+e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(e){if(t(e)&&(e=K(e)),this.isCompatible(e)||f(this.units(),e.units()),this.isTemperature()&&e.isTemperature())return te(this,e);if(this.isTemperature())return tr(this,e);if(e.isTemperature())throw new c("Cannot subtract a temperature from a differential degree unit");return K({scalar:this.scalar-e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(e){if(r(e))return K({scalar:s(this.scalar,e),numerator:this.numerator,denominator:this.denominator});if(t(e)&&(e=K(e)),(this.isTemperature()||e.isTemperature())&&!(this.isUnitless()||e.isUnitless()))throw new c("Cannot multiply by temperatures");var n=this,i=e;n.isCompatible(i)&&400!==n.signature&&(i=i.to(n));var o=tf(n.numerator,n.denominator,i.numerator,i.denominator);return K({scalar:s(n.scalar,i.scalar,o[2]),numerator:o[0],denominator:o[1]})},div:function(e){if(r(e)){if(0===e)throw new c("Divide by zero");return K({scalar:this.scalar/e,numerator:this.numerator,denominator:this.denominator})}if(t(e)&&(e=K(e)),0===e.scalar)throw new c("Divide by zero");if(e.isTemperature()||this.isTemperature()&&!e.isUnitless())throw new c("Cannot divide with temperatures");var n=this,i=e;n.isCompatible(i)&&400!==n.signature&&(i=i.to(n));var o=tf(n.numerator,n.denominator,i.denominator,i.numerator);return K({scalar:s(n.scalar,o[2])/i.scalar,numerator:o[0],denominator:o[1]})},inverse:function(){if(this.isTemperature())throw new c("Cannot divide with temperatures");if(0===this.scalar)throw new c("Divide by zero");return K({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}}),a(K.prototype,{eq:function(t){return 0===this.compareTo(t)},lt:function(t){return -1===this.compareTo(t)},lte:function(t){return this.eq(t)||this.lt(t)},gt:function(t){return 1===this.compareTo(t)},gte:function(t){return this.eq(t)||this.gt(t)},compareTo:function(e){return t(e)?this.compareTo(K(e)):(this.isCompatible(e)||f(this.units(),e.units()),this.baseScalar<e.baseScalar)?-1:this.baseScalar===e.baseScalar?0:this.baseScalar>e.baseScalar?1:void 0},same:function(t){return this.scalar===t.scalar&&this.units()===t.units()}}),a(K.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every(function(t){return o(t,g)})},isCompatible:function(e){return t(e)?this.isCompatible(K(e)):!!W(e)&&void 0!==e.signature&&this.signature===e.signature},isInverse:function(t){return this.inverse().isCompatible(t)},isBase:function(){return void 0!==this._isBase||(this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?this._isBase=!0:(this.numerator.concat(this.denominator).forEach(function(t){t!==m&&-1===p.indexOf(t)&&(this._isBase=!1)},this),!1===this._isBase||(this._isBase=!0))),this._isBase}}),td.prototype.get=function(t){return arguments.length>1&&(t=Array.apply(null,arguments)),t.reduce(function(e,r,n){if(e){var i=e[r];return n===t.length-1?i?i.data:void 0:i}},this)},td.prototype.set=function(t,e){return arguments.length>2&&(t=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1]),t.reduce(function(r,n,i){var o=r[n];return(void 0===o&&(o=r[n]={}),i===t.length-1)?(o.data=e,e):o},this)},K.formatter=tp,a(K.prototype,{units:function(){if(void 0!==this._units)return this._units;var t=o(this.numerator,g),e=o(this.denominator,g);if(t&&e)return this._units="",this._units;var r=tg(this.numerator),n=tg(this.denominator);return this._units=r+(e?"":"/"+n),this._units},toString:function(e,n){if(r(e))i=this.units(),n=e;else if(t(e))i=e;else if(W(e))return this.toPrec(e).toString(n);var i,o=this.to(i);return((void 0!==n?l(o.scalar,n):o.scalar)+" "+o.units()).trim()},format:function(t,e){1==arguments.length&&"function"==typeof t&&(e=t,t=void 0),e=e||K.formatter;var r=this.to(t);return e.call(this,r.scalar,r.units())}});var tm=new td;function tg(t){var e=tm.get(t);return e||(e=o(t,g)?"1":ty(tv(t)).join("*"),tm.set(t,e)),e}function tv(t){for(var e,r,n=[],i=0;i<t.length;i++)e=t[i],r=t[i+1],y[e]?(n.push(M[e]+M[r]),i++):n.push(M[e]);return n}function ty(t){return t.reduce(function(t,e){var r=t[e];return r||t.push(r=t[e]=[e,0]),r[1]++,t},[]).map(function(t){return t[0]+(t[1]>1?t[1]:"")})}return K.version="1.8.0",K})},586:function(t){"use strict";!function(){function e(t){for(var e=0,i=t.length-1,o=void 0,a=void 0,s=void 0,h=n(e,i);;){if(i<=e)return t[h];if(i==e+1)return t[e]>t[i]&&r(t,e,i),t[h];for(t[o=n(e,i)]>t[i]&&r(t,o,i),t[e]>t[i]&&r(t,e,i),t[o]>t[e]&&r(t,o,e),r(t,o,e+1),a=e+1,s=i;;){do a++;while(t[e]>t[a]);do s--;while(t[s]>t[e]);if(s<a)break;r(t,a,s)}r(t,e,s),s<=h&&(e=a),s>=h&&(i=s-1)}}var r=function(t,e,r){var n;return n=[t[r],t[e]],t[e]=n[0],t[r]=n[1],n},n=function(t,e){return~~((t+e)/2)};t.exports?t.exports=e:window.median=e}()},9655:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return a}});var n=r(9900);function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isAnyArray)(t))throw TypeError("input must be an array");if(0===t.length)throw TypeError("input must not be empty");var r=e.fromIndex,i=void 0===r?0:r,o=e.toIndex,a=void 0===o?t.length:o;if(i<0||i>=t.length||!Number.isInteger(i))throw Error("fromIndex must be a positive integer smaller than length");if(a<=i||a>t.length||!Number.isInteger(a))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[i],h=i+1;h<a;h++)t[h]>s&&(s=t[h]);return s}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isAnyArray)(t))throw TypeError("input must be an array");if(0===t.length)throw TypeError("input must not be empty");var r=e.fromIndex,i=void 0===r?0:r,o=e.toIndex,a=void 0===o?t.length:o;if(i<0||i>=t.length||!Number.isInteger(i))throw Error("fromIndex must be a positive integer smaller than length");if(a<=i||a>t.length||!Number.isInteger(a))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[i],h=i+1;h<a;h++)t[h]<s&&(s=t[h]);return s}function a(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,n.isAnyArray)(t)){if(0===t.length)throw TypeError("input must not be empty")}else throw TypeError("input must be an array");if(void 0!==r.output){if(!(0,n.isAnyArray)(r.output))throw TypeError("output option must be an array if specified");e=r.output}else e=Array(t.length);var a=o(t),s=i(t);if(a===s)throw RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var h=r.min,l=void 0===h?r.autoMinMax?a:0:h,u=r.max,c=void 0===u?r.autoMinMax?s:1:u;if(l>=c)throw RangeError("min option must be smaller than max option");for(var f=(c-l)/(s-a),d=0;d<t.length;d++)e[d]=(t[d]-a)*f+l;return e}},8802:function(t){"use strict";class e{add(t){var e=this.nodes.get(t);return e||(e=new r(t),this.nodes.set(t,e)),e}union(t,e){let r=this.find(t),n=this.find(e);r!==n&&(r.rank<n.rank?r.parent=n:r.rank>n.rank?n.parent=r:(n.parent=r,r.rank++))}find(t){for(var e=t;null!==e.parent;)e=e.parent;for(var r=t;null!==r.parent;){var n=r;r=r.parent,n.parent=e}return e}connected(t,e){return this.find(t)===this.find(e)}constructor(){this.nodes=new Map}}function r(t){this.value=t,this.parent=null,this.rank=0}t.exports=e},4771:function(t,e,r){"use strict";function n(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n]);return r}function i(t,e){return Math.sqrt(n(t,e))}r.r(e),r.d(e,{euclidean:function(){return i},squaredEuclidean:function(){return n}})},7617:function(t,e,r){"use strict";var n=r(7207),i={DEBUG:!1,ifft2DArray:function(t,e,r){var i=Array(e*r),o=e/2,a=(r-1)*2;n.init(o);for(var s={re:Array(o),im:Array(o)},h=0;h<r;h++){for(var l=o-1;l>=0;l--)s.re[l]=t[2*l*r+h],s.im[l]=t[(2*l+1)*r+h];n.bt(s.re,s.im);for(var l=o-1;l>=0;l--)i[2*l*r+h]=s.re[l],i[(2*l+1)*r+h]=s.im[l]}var u=Array(o*a);n.init(a);for(var c={re:Array(a),im:Array(a)},f=a*o,l=0;l<e;l+=2){c.re[0]=i[l*r],c.im[0]=i[(l+1)*r];for(var h=1;h<r;h++)c.re[h]=i[l*r+h],c.im[h]=i[(l+1)*r+h],c.re[a-h]=i[l*r+h],c.im[a-h]=-i[(l+1)*r+h];n.bt(c.re,c.im);for(var d=l/2*a,h=a-1;h>=0;h--)u[d+h]=c.re[h]/f}return u},fft2DArray:function(t,e,r,i){Object.assign({},{inplace:!0});var o,a,s,h,l,u=r/2+1,c=2*e,f=Array(c*u);n.init(r);for(var d={re:Array(r),im:Array(r)},p={re:Array(r),im:Array(r)},m={re:Array(r),im:Array(r)},g=0;g<e/2;g++){o=2*g*r,d.re=t.slice(o,o+r),o=(2*g+1)*r,d.im=t.slice(o,o+r),n.fft1d(d.re,d.im),this.reconstructTwoRealFFT(d,p,m),a=4*g*u,s=(4*g+1)*u,h=(4*g+2)*u,l=(4*g+3)*u;for(var v=u-1;v>=0;v--)f[a+v]=p.re[v],f[s+v]=p.im[v],f[h+v]=m.re[v],f[l+v]=m.im[v]}p=null,m=null;var y=Array(c*u);n.init(e);for(var b={re:Array(e),im:Array(e)},w=u-1;w>=0;w--){for(var g=e-1;g>=0;g--)b.re[g]=f[2*g*u+w],b.im[g]=f[(2*g+1)*u+w],isNaN(b.re[g])&&(b.re[g]=0),isNaN(b.im[g])&&(b.im[g]=0);n.fft1d(b.re,b.im);for(var g=e-1;g>=0;g--)y[2*g*u+w]=b.re[g],y[(2*g+1)*u+w]=b.im[g]}return y},reconstructTwoRealFFT:function(t,e,r){var n,i,o,a,s,h=t.re.length;e.re[0]=t.re[0],e.im[0]=0,r.re[0]=t.im[0],r.im[0]=0;for(var l=h/2;l>0;l--)s=h-l,n=.5*(t.re[l]-t.re[s]),i=.5*(t.re[l]+t.re[s]),o=.5*(t.im[l]-t.im[s]),a=.5*(t.im[l]+t.im[s]),e.re[l]=i,e.im[l]=o,e.re[s]=i,e.im[s]=-o,r.re[l]=a,r.im[l]=-n,r.re[s]=a,r.im[s]=n},convolute2DI:function(t,e,r,n){for(var i,o,a=0;a<r/2;a++)for(var s=0;s<n;s++)i=t[2*a*n+s]*e[2*a*n+s]-t[(2*a+1)*n+s]*e[(2*a+1)*n+s],o=t[2*a*n+s]*e[(2*a+1)*n+s]+t[(2*a+1)*n+s]*e[2*a*n+s],t[2*a*n+s]=i,t[(2*a+1)*n+s]=o},convolute:function(t,e,r,n,i){for(var o,a,s=Array(n*r),h=0;h<r*n;h++)s[h]=t[h];s=this.fft2DArray(s,r,n);for(var l=e.length,u=e[0].length,c=Array(n*r),h=0;h<n*r;h++)c[h]=0;for(var f=Math.floor((l-1)/2),d=Math.floor((u-1)/2),p=0;p<l;p++){o=(p-f+r)%r;for(var m=0;m<u;m++)a=(m-d+n)%n,c[o*n+a]=e[p][m]}c=this.fft2DArray(c,r,n);var g=2*r,v=n/2+1;return this.convolute2DI(s,c,g,v),this.ifft2DArray(s,g,v)},toRadix2:function(t,e,r){var n,i,o,a,s=r,h=e,l=0,u=0;if(!(0!==r&&(r&r-1)==0)){for(s=0;r>>++s!=0;);u=(s=1<<s)-r}if(!(0!==e&&(e&e-1)==0)){for(h=0;e>>++h!=0;);l=((h=1<<h)-e)*s}if(h==e&&s==r)return{data:t,rows:e,cols:r};var c=Array(h*s),f=Math.floor((h-e)/2)-e,d=Math.floor((s-r)/2)-r;for(n=0;n<h;n++)for(i=0,o=n*s,a=(n-f)%e*r;i<s;i++)c[o+i]=t[a+(i-d)%r];return{data:c,rows:h,cols:s}},crop:function(t,e,r,n,i,o){if(e==n&&r==i)return t;Object.assign({},o);var a,s,h,l,u=Array(i*n),c=Math.floor((e-n)/2),f=Math.floor((r-i)/2);for(h=0;h<n;h++)for(l=0,a=h*i,s=(h+c)*r;l<i;l++)u[a+l]=t[s+(l+f)];return u}};t.exports=i},7207:function(t,e){(function(){var t;(t=e).toString=function(){return"version 0.3.0, released 2013-03"};for(var r=0,n=null,i=null,o={init:function(t){if(0!==t&&(t&t-1)==0)r=t,o._initArray(),o._makeBitReversalTable(),o._makeCosSinTable();else throw Error("init: radix-2 required")},fft1d:function(t,e){o.fft(t,e,1)},ifft1d:function(t,e){var n=1/r;o.fft(t,e,-1);for(var i=0;i<r;i++)t[i]*=n,e[i]*=n},bt1d:function(t,e){o.fft(t,e,-1)},fft2d:function(t,e){for(var n=[],i=[],a=0,s=0;s<r;s++){a=s*r;for(var h=0;h<r;h++)n[h]=t[h+a],i[h]=e[h+a];o.fft1d(n,i);for(var l=0;l<r;l++)t[l+a]=n[l],e[l+a]=i[l]}for(var u=0;u<r;u++){for(var c=0;c<r;c++)a=u+c*r,n[c]=t[a],i[c]=e[a];o.fft1d(n,i);for(var f=0;f<r;f++)t[a=u+f*r]=n[f],e[a]=i[f]}},ifft2d:function(t,e){for(var n=[],i=[],a=0,s=0;s<r;s++){a=s*r;for(var h=0;h<r;h++)n[h]=t[h+a],i[h]=e[h+a];o.ifft1d(n,i);for(var l=0;l<r;l++)t[l+a]=n[l],e[l+a]=i[l]}for(var u=0;u<r;u++){for(var c=0;c<r;c++)a=u+c*r,n[c]=t[a],i[c]=e[a];o.ifft1d(n,i);for(var f=0;f<r;f++)t[a=u+f*r]=n[f],e[a]=i[f]}},fft:function(t,e,o){for(var a,s,h,l,u,c,f,d,p,m=r>>2,g=0;g<r;g++)l=n[g],g<l&&(u=t[g],t[g]=t[l],t[l]=u,u=e[g],e[g]=e[l],e[l]=u);for(var v=1;v<r;v<<=1){s=0,a=r/(v<<1);for(var y=0;y<v;y++){c=i[s+m],f=o*i[s];for(var b=y;b<r;b+=v<<1)d=c*t[h=b+v]+f*e[h],p=c*e[h]-f*t[h],t[h]=t[b]-d,t[b]+=d,e[h]=e[b]-p,e[b]+=p;s+=a}}},_initArray:function(){n="undefined"!=typeof Uint32Array?new Uint32Array(r):[],i="undefined"!=typeof Float64Array?new Float64Array(1.25*r):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,e=0,i=0;for(n[0]=0;++t<r;){for(i=r>>1;i<=e;)e-=i,i>>=1;e+=i,n[t]=e}},_makeCosSinTable:function(){var t=r>>1,e=r>>2,n=r>>3,o=t+e,a=Math.sin(Math.PI/r),s=2*a*a,h=Math.sqrt(s*(2-s)),l=i[e]=1,u=i[0]=0;a=2*s;for(var c=1;c<n;c++)l-=s,s+=a*l,u+=h,h-=a*u,i[c]=u,i[e-c]=l;0!==n&&(i[n]=Math.sqrt(.5));for(var f=0;f<e;f++)i[t-f]=i[f];for(var d=0;d<o;d++)i[d+t]=-i[d]}},a=["init","fft1d","ifft1d","fft2d","ifft2d"],s=0;s<a.length;s++)t[a[s]]=o[a[s]];return t.bt=o.bt1d,t.fft=o.fft1d,t.ifft=o.ifft1d,t}).call(this)},1014:function(t,e,r){"use strict";e.FFTUtils=r(7617),r(7207)},9083:function(t,e,r){"use strict";let{squaredEuclidean:n}=r(4771),i={sigma:1};class o{compute(t,e){return Math.exp(-n(t,e)/this.divisor)}constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}}t.exports=o},4342:function(t){"use strict";let e={degree:1,constant:1,scale:1};class r{compute(t,e){for(var r=0,n=0;n<t.length;n++)r+=t[n]*e[n];return Math.pow(this.scale*r+this.constant,this.degree)}constructor(t){t=Object.assign({},e,t),this.degree=t.degree,this.constant=t.constant,this.scale=t.scale}}t.exports=r},5778:function(t){"use strict";let e={alpha:.01,constant:-Math.E};class r{compute(t,e){for(var r=0,n=0;n<t.length;n++)r+=t[n]*e[n];return Math.tanh(this.alpha*r+this.constant)}constructor(t){t=Object.assign({},e,t),this.alpha=t.alpha,this.constant=t.constant}}t.exports=r},7876:function(t,e,r){"use strict";let{Matrix:n,MatrixTransposeView:i}=r(3719),o=r(9083),a=r(4342),s=r(5778),h=r(2609),l=r(8934),u=r(1248),c=r(6936),f={gaussian:o,rbf:o,polynomial:a,poly:a,anova:h,cauchy:l,exponential:u,histogram:c,min:c,laplacian:r(5056),multiquadratic:r(6714),rational:r(7593),sigmoid:s,mlp:s};class d{compute(t,e){if(t=n.checkMatrix(t),e=void 0===e?t:n.checkMatrix(e),"linear"===this.kernelType)return t.mmul(new i(e));let r=new n(t.rows,e.rows);if(t===e)for(let e=0;e<t.rows;e++)for(let n=e;n<t.rows;n++){let i=this.kernelFunction.compute(t.getRow(e),t.getRow(n));r.set(e,n,i),r.set(n,e,i)}else for(let n=0;n<t.rows;n++)for(let i=0;i<e.rows;i++)r.set(n,i,this.kernelFunction.compute(t.getRow(n),e.getRow(i)));return r}constructor(t,e){if(this.kernelType=t,"linear"===t)return;if("string"==typeof t){var r=f[t=t.toLowerCase()];if(r)this.kernelFunction=new r(e);else throw Error("unsupported kernel type: ".concat(t))}else if("object"==typeof t&&"function"==typeof t.compute)this.kernelFunction=t;else throw TypeError("first argument must be a valid kernel type or instance")}}t.exports=d},2609:function(t){"use strict";let e={sigma:1,degree:1};class r{compute(t,e){for(var r=0,n=Math.min(t.length,e.length),i=1;i<=n;++i)r+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(t[i-1],i)-Math.pow(e[i-1],i),2)),this.degree);return r}constructor(t){t=Object.assign({},e,t),this.sigma=t.sigma,this.degree=t.degree}}t.exports=r},8934:function(t,e,r){"use strict";let{squaredEuclidean:n}=r(4771),i={sigma:1};class o{compute(t,e){return 1/(1+n(t,e)/(this.sigma*this.sigma))}constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma}}t.exports=o},1248:function(t,e,r){"use strict";let{euclidean:n}=r(4771),i={sigma:1};class o{compute(t,e){return Math.exp(-n(t,e)/this.divisor)}constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}}t.exports=o},6936:function(t){"use strict";class e{compute(t,e){for(var r=Math.min(t.length,e.length),n=0,i=0;i<r;++i)n+=Math.min(t[i],e[i]);return n}}t.exports=e},5056:function(t,e,r){"use strict";let{euclidean:n}=r(4771),i={sigma:1};class o{compute(t,e){return Math.exp(-n(t,e)/this.sigma)}constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma}}t.exports=o},6714:function(t,e,r){"use strict";let{squaredEuclidean:n}=r(4771),i={constant:1};class o{compute(t,e){return Math.sqrt(n(t,e)+this.constant*this.constant)}constructor(t){t=Object.assign({},i,t),this.constant=t.constant}}t.exports=o},7593:function(t,e,r){"use strict";let{squaredEuclidean:n}=r(4771),i={constant:1};class o{compute(t,e){let r=n(t,e);return 1-r/(r+this.constant)}constructor(t){t=Object.assign({},i,t),this.constant=t.constant}}t.exports=o},8466:function(t,e,r){"use strict";var n=r(1014).FFTUtils;function i(t,e,r){var i,o,a,h,l=s(t),u=l.data,c=Object.assign({normalize:!1,divisor:1,rows:l.rows,cols:l.cols},r);if(c.rows&&c.cols)i=c.rows,o=c.cols;else throw Error("Invalid number of rows or columns "+i+" "+o);var f=c.divisor,d=e.length,p=e[0].length;if(c.normalize)for(a=0,f=0;a<d;a++)for(h=0;h<p;h++)f+=e[a][h];if(0===f)throw RangeError("convolution: The divisor is equal to zero");var m=n.toRadix2(u,i,o),g=n.convolute(m.data,e,m.rows,m.cols);if(g=n.crop(g,m.rows,m.cols,i,o),0!=f&&1!=f)for(a=0;a<g.length;a++)g[a]/=f;return g}function o(t,e,r){var n,i,o,a,h,l,u,c,f,d,p,m=s(t),g=m.data,v=Object.assign({normalize:!1,divisor:1,rows:m.rows,cols:m.cols},r);if(v.rows&&v.cols)n=v.rows,i=v.cols;else throw Error("Invalid number of rows or columns "+n+" "+i);var y=v.divisor,b=e.length,w=e[0].length;if(v.normalize)for(o=0,y=0;o<b;o++)for(a=0;a<w;a++)y+=e[o][a];if(0===y)throw RangeError("convolution: The divisor is equal to zero");var x=Array(n*i),M=Math.floor(b/2),k=Math.floor(w/2);for(l=0;l<n;l++)for(h=0;h<i;h++){for(a=0,c=0;a<b;a++)for(o=0;o<w;o++)f=e[b-a-1][w-o-1],d=(l+a-M+n)%n,p=(h+o-k+i)%i,c+=g[u=d*i+p]*f;x[u=l*i+h]=c/y}return x}function a(t,e,r){var n,i,o,a,s=1e3;r&&r.factor&&(s=r.factor);var h=Array(e);s*=-1;var l=(e-1)/2,u=2*t*t;for(n=0;n<e;n++)for(i=0,h[n]=Array(e),a=(n-l)*(n-l);i<e;i++)o=-((i-l)*(i-l)+a)/u,h[n][i]=Math.round(s*(1+o)*Math.exp(o));return h}function s(t){var e,r,n=t;if("number"!=typeof t[0]){n=Array((e=t.length)*(r=t[0].length));for(var i=0;i<e;i++)for(var o=0;o<r;o++)n[i*r+o]=t[i][o]}else{var a=Math.sqrt(t.length);Number.isInteger(a)&&(e=a,r=a)}return{data:n,rows:e,cols:r}}t.exports={fft:i,direct:o,kernelFactory:{LoG:a},matrix2Array:s}},9361:function(t){"use strict";function e(t,e){for(var r=Array(t=t||0),n=0;n<t;n++)r[n]=e;return r}t.exports=e},1846:function(t){"use strict";function e(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1)}t.exports=e},9079:function(t,e,r){"use strict";var n,i;t.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(i=r.g.process)?void 0:i.env)?r.g.process:r(3127)},8620:function(t){"use strict";var e="/";!function(){var r={675:function(t,e){e.byteLength=l,e.toByteArray=c,e.fromByteArray=p;for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=o.length;a<s;++a)r[a]=o[a],n[o.charCodeAt(a)]=a;function h(t){var e=t.length;if(e%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");-1===r&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function l(t){var e=h(t),r=e[0],n=e[1];return(r+n)*3/4-n}function u(t,e,r){return(e+r)*3/4-r}function c(t){var e,r,o=h(t),a=o[0],s=o[1],l=new i(u(t,a,s)),c=0,f=s>0?a-4:a;for(r=0;r<f;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],l[c++]=e>>16&255,l[c++]=e>>8&255,l[c++]=255&e;return 2===s&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,l[c++]=255&e),1===s&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,l[c++]=e>>8&255,l[c++]=255&e),l}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function d(t,e,r){for(var n=[],i=e;i<r;i+=3)n.push(f((t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2])));return n.join("")}function p(t){for(var e,n=t.length,i=n%3,o=[],a=16383,s=0,h=n-i;s<h;s+=a)o.push(d(t,s,s+a>h?h:s+a));return 1===i?o.push(r[(e=t[n-1])>>2]+r[e<<4&63]+"=="):2===i&&o.push(r[(e=(t[n-2]<<8)+t[n-1])>>10]+r[e>>4&63]+r[e<<2&63]+"="),o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},72:function(t,e,r){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var n=r(675),i=r(783),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=l,e.SlowBuffer=b,e.INSPECT_MAX_BYTES=50;var a=2147483647;function s(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}function h(t){if(t>a)throw RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,l.prototype),e}function l(t,e,r){if("number"==typeof t){if("string"==typeof e)throw TypeError('The "string" argument must be of type string. Received type number');return d(t)}return u(t,e,r)}function u(t,e,r){if("string"==typeof t)return p(t,e);if(ArrayBuffer.isView(t))return m(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Q(t,ArrayBuffer)||t&&Q(t.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(Q(t,SharedArrayBuffer)||t&&Q(t.buffer,SharedArrayBuffer)))return g(t,e,r);if("number"==typeof t)throw TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return l.from(n,e,r);var i=v(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return l.from(t[Symbol.toPrimitive]("string"),e,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw TypeError('"size" argument must be of type number');if(t<0)throw RangeError('The value "'+t+'" is invalid for option "size"')}function f(t,e,r){return(c(t),t<=0)?h(t):void 0!==e?"string"==typeof r?h(t).fill(e,r):h(t).fill(e):h(t)}function d(t){return c(t),h(t<0?0:0|y(t))}function p(t,e){if(("string"!=typeof e||""===e)&&(e="utf8"),!l.isEncoding(e))throw TypeError("Unknown encoding: "+e);var r=0|w(t,e),n=h(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function m(t){for(var e=t.length<0?0:0|y(t.length),r=h(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function g(t,e,r){var n;if(e<0||t.byteLength<e)throw RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),l.prototype),n}function v(t){if(l.isBuffer(t)){var e=0|y(t.length),r=h(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||Z(t.length)?h(0):m(t):"Buffer"===t.type&&Array.isArray(t.data)?m(t.data):void 0}function y(t){if(t>=a)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|t}function b(t){return+t!=t&&(t=0),l.alloc(+t)}function w(t,e){if(l.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Q(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return K(t).length;default:if(i)return n?-1:q(t).length;e=(""+e).toLowerCase(),i=!0}}function x(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(e>>>=0)))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,r);case"utf8":case"utf-8":return T(this,e,r);case"ascii":return U(this,e,r);case"latin1":case"binary":return L(this,e,r);case"base64":return I(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,r);default:if(n)throw TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function M(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function k(t,e,r,n,i){if(0===t.length)return -1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return -1;r=t.length-1}else if(r<0){if(!i)return -1;r=0}if("string"==typeof e&&(e=l.from(e,n)),l.isBuffer(e))return 0===e.length?-1:E(t,e,r,n,i);if("number"==typeof e)return(e&=255,"function"==typeof Uint8Array.prototype.indexOf)?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):E(t,[e],r,n,i);throw TypeError("val must be string, number or Buffer")}function E(t,e,r,n,i){var o,a=1,s=t.length,h=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return -1;a=2,s/=2,h/=2,r/=2}function l(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var u=-1;for(o=r;o<s;o++)if(l(t,o)===l(e,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===h)return u*a}else -1!==u&&(o-=o-u),u=-1}else for(r+h>s&&(r=s-h),o=r;o>=0;o--){for(var c=!0,f=0;f<h;f++)if(l(t,o+f)!==l(e,f)){c=!1;break}if(c)return o}return -1}function A(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(e.substr(2*a,2),16);if(Z(s))break;t[r+a]=s}return a}function _(t,e,r,n){return J(q(e,t.length-r),t,r,n)}function S(t,e,r,n){return J(H(e),t,r,n)}function D(t,e,r,n){return S(t,e,r,n)}function P(t,e,r,n){return J(K(e),t,r,n)}function C(t,e,r,n){return J(W(e,t.length-r),t,r,n)}function I(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function T(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,a,s,h,l=t[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c<=r)switch(c){case 1:l<128&&(u=l);break;case 2:(192&(o=t[i+1]))==128&&(h=(31&l)<<6|63&o)>127&&(u=h);break;case 3:o=t[i+1],a=t[i+2],(192&o)==128&&(192&a)==128&&(h=(15&l)<<12|(63&o)<<6|63&a)>2047&&(h<55296||h>57343)&&(u=h);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],(192&o)==128&&(192&a)==128&&(192&s)==128&&(h=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&h<1114112&&(u=h)}null===u?(u=65533,c=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=c}return R(n)}e.kMaxLength=a,l.TYPED_ARRAY_SUPPORT=s(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(t,e,r){return u(t,e,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(t,e,r){return f(t,e,r)},l.allocUnsafe=function(t){return d(t)},l.allocUnsafeSlow=function(t){return d(t)},l.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==l.prototype},l.compare=function(t,e){if(Q(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),Q(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(t)||!l.isBuffer(e))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!Array.isArray(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);if(void 0===e)for(r=0,e=0;r<t.length;++r)e+=t[r].length;var r,n=l.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var o=t[r];if(Q(o,Uint8Array)&&(o=l.from(o)),!l.isBuffer(o))throw TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},l.byteLength=w,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)M(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)M(this,e,e+3),M(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)M(this,e,e+7),M(this,e+1,e+6),M(this,e+2,e+5),M(this,e+3,e+4);return this},l.prototype.toString=function(){var t=this.length;return 0===t?"":0==arguments.length?T(this,0,t):x.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(t){if(!l.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(t,e,r,n,i){if(Q(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(t))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return -1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,i>>>=0,this===t)return 0;for(var o=i-n,a=r-e,s=Math.min(o,a),h=this.slice(n,i),u=t.slice(e,r),c=0;c<s;++c)if(h[c]!==u[c]){o=h[c],a=u[c];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(t,e,r){return -1!==this.indexOf(t,e,r)},l.prototype.indexOf=function(t,e,r){return k(this,t,e,r,!0)},l.prototype.lastIndexOf=function(t,e,r){return k(this,t,e,r,!1)},l.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else if(isFinite(e))e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,e,r);case"utf8":case"utf-8":return _(this,t,e,r);case"ascii":return S(this,t,e,r);case"latin1":case"binary":return D(this,t,e,r);case"base64":return P(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,e,r);default:if(o)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var B=4096;function R(t){var e=t.length;if(e<=B)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=B));return r}function U(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function L(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function O(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=$[t[o]];return i}function N(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function F(t,e,r){if(t%1!=0||t<0)throw RangeError("offset is not uint");if(t+e>r)throw RangeError("Trying to access beyond buffer length")}function z(t,e,r,n,i,o){if(!l.isBuffer(t))throw TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw RangeError('"value" argument is out of bounds');if(r+n>t.length)throw RangeError("Index out of range")}function Y(t,e,r,n,i,o){if(r+n>t.length||r<0)throw RangeError("Index out of range")}function X(t,e,r,n,o){return e=+e,r>>>=0,o||Y(t,e,r,4,34028234663852886e22,-34028234663852886e22),i.write(t,e,r,n,23,4),r+4}function V(t,e,r,n,o){return e=+e,r>>>=0,o||Y(t,e,r,8,17976931348623157e292,-17976931348623157e292),i.write(t,e,r,n,52,8),r+8}l.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||F(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},l.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||F(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},l.prototype.readUInt8=function(t,e){return t>>>=0,e||F(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return t>>>=0,e||F(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return t>>>=0,e||F(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return t>>>=0,e||F(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return t>>>=0,e||F(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||F(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},l.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||F(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return(t>>>=0,e||F(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},l.prototype.readInt16LE=function(t,e){t>>>=0,e||F(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(t,e){t>>>=0,e||F(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(t,e){return t>>>=0,e||F(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return t>>>=0,e||F(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return t>>>=0,e||F(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return t>>>=0,e||F(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return t>>>=0,e||F(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return t>>>=0,e||F(t,8,this.length),i.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){var i=Math.pow(2,8*r)-1;z(this,t,e,r,i,0)}var o=1,a=0;for(this[e]=255&t;++a<r&&(o*=256);)this[e+a]=t/o&255;return e+r},l.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){var i=Math.pow(2,8*r)-1;z(this,t,e,r,i,0)}var o=r-1,a=1;for(this[e+o]=255&t;--o>=0&&(a*=256);)this[e+o]=t/a&255;return e+r},l.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,1,255,0),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},l.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);z(this,t,e,r,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<r&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},l.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);z(this,t,e,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},l.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},l.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeFloatLE=function(t,e,r){return X(this,t,e,!0,r)},l.prototype.writeFloatBE=function(t,e,r){return X(this,t,e,!1,r)},l.prototype.writeDoubleLE=function(t,e,r){return V(this,t,e,!0,r)},l.prototype.writeDoubleBE=function(t,e,r){return V(this,t,e,!1,r)},l.prototype.copy=function(t,e,r,n){if(!l.isBuffer(t))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r||0===t.length||0===this.length)return 0;if(e<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,r,n);else if(this===t&&r<e&&e<n)for(var o=i-1;o>=0;--o)t[o+e]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,n),e);return i},l.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===t.length){var i,o=t.charCodeAt(0);("utf8"===n&&o<128||"latin1"===n)&&(t=o)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw RangeError("Out of range index");if(r<=e)return this;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var a=l.isBuffer(t)?t:l.from(t,n),s=a.length;if(0===s)throw TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=a[i%s]}return this};var j=/[^+/0-9A-Za-z-_]/g;function G(t){if((t=(t=t.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function q(t,e){e=e||1/0;for(var r,n=t.length,i=null,o=[],a=0;a<n;++a){if((r=t.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319||a+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return o}function H(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function W(t,e){for(var r,n,i=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(r=t.charCodeAt(o))>>8,i.push(r%256),i.push(n);return i}function K(t){return n.toByteArray(G(t))}function J(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length)&&!(i>=t.length);++i)e[i+r]=t[i];return i}function Q(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!=t}var $=function(){for(var t="0123456789abcdef",e=Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()},783:function(t,e){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */e.read=function(t,e,r,n,i){var o,a,s=8*i-n-1,h=(1<<s)-1,l=h>>1,u=-7,c=r?i-1:0,f=r?-1:1,d=t[e+c];for(c+=f,o=d&(1<<-u)-1,d>>=-u,u+=s;u>0;o=256*o+t[e+c],c+=f,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;u>0;a=256*a+t[e+c],c+=f,u-=8);if(0===o)o=1-l;else{if(o===h)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=l}return(d?-1:1)*a*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var a,s,h,l=8*o-i-1,u=(1<<l)-1,c=u>>1,f=23===i?5960464477539062e-23:0,d=n?0:o-1,p=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(isNaN(e=Math.abs(e))||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-a))<1&&(a--,h*=2),a+c>=1?e+=f/h:e+=f*Math.pow(2,1-c),e*h>=2&&(a++,h/=2),a+c>=u?(s=0,a=u):a+c>=1?(s=(e*h-1)*Math.pow(2,i),a+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,i),a=0));i>=8;t[r+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;t[r+d]=255&a,d+=p,a/=256,l-=8);t[r+d-p]|=128*m}}},n={};function i(t){var e=n[t];if(void 0!==e)return e.exports;var o=n[t]={exports:{}},a=!0;try{r[t](o,o.exports,i),a=!1}finally{a&&delete n[t]}return o.exports}i.ab=e+"/";var o=i(72);t.exports=o}()},3127:function(t){"use strict";var e="/";!function(){var r={229:function(t){var e,r,n,i=t.exports={};function o(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}function h(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{return r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var l=[],u=!1,c=-1;function f(){u&&n&&(u=!1,n.length?l=n.concat(l):c=-1,l.length&&d())}function d(){if(!u){var t=s(f);u=!0;for(var e=l.length;e;){for(n=l,l=[];++c<e;)n&&n[c].run();c=-1,e=l.length}n=null,u=!1,h(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new p(t,e)),1!==l.length||u||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function i(t){var e=n[t];if(void 0!==e)return e.exports;var o=n[t]={exports:{}},a=!0;try{r[t](o,o.exports,i),a=!1}finally{a&&delete n[t]}return o.exports}i.ab=e+"/";var o=i(229);t.exports=o}()},8614:function(t,e,r){"use strict";r.d(e,{x:function(){return v}});var n=r(4090);function i(t,e,r,n,i,o,a){try{var s=t[o](a),h=s.value}catch(t){r(t);return}s.done?e(h):Promise.resolve(h).then(n,i)}function o(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var a=t.apply(e,r);function s(t){i(a,n,o,s,h,"next",t)}function h(t){i(a,n,o,s,h,"throw",t)}s(void 0)})}}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var s={exports:{}};!function(t){var e=function(t){var e,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=Object.create((e&&e.prototype instanceof g?e:g).prototype),o=new P(n||[]);return i._invoke=A(t,r,o),i}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var c="suspendedStart",f="suspendedYield",d="executing",p="completed",m={};function g(){}function v(){}function y(){}var b={};h(b,o,function(){return this});var w=Object.getPrototypeOf,x=w&&w(w(C([])));x&&x!==r&&n.call(x,o)&&(b=x);var M=y.prototype=g.prototype=Object.create(b);function k(t){["next","throw","return"].forEach(function(e){h(t,e,function(t){return this._invoke(e,t)})})}function E(t,e){var r;function i(r,o,a,s){var h=u(t[r],t,o);if("throw"===h.type)s(h.arg);else{var l=h.arg,c=l.value;return c&&"object"==typeof c&&n.call(c,"__await")?e.resolve(c.__await).then(function(t){i("next",t,a,s)},function(t){i("throw",t,a,s)}):e.resolve(c).then(function(t){l.value=t,a(l)},function(t){return i("throw",t,a,s)})}}function o(t,n){function o(){return new e(function(e,r){i(t,n,e,r)})}return r=r?r.then(o,o):o()}this._invoke=o}function A(t,e,r){var n=c;return function(i,o){if(n===d)throw Error("Generator is already running");if(n===p){if("throw"===i)throw o;return I()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=_(a,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===c)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var h=u(t,e,r);if("normal"===h.type){if(n=r.done?p:f,h.arg===m)continue;return{value:h.arg,done:r.done}}"throw"===h.type&&(n=p,r.method="throw",r.arg=h.arg)}}}function _(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,_(t,r),"throw"===r.method))return m;r.method="throw",r.arg=TypeError("The iterator does not provide a 'throw' method")}return m}var i=u(n,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var o=i.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):o:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(t){if(t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}return{next:I}}function I(){return{value:e,done:!0}}return v.prototype=y,h(M,"constructor",y),h(y,"constructor",v),v.displayName=h(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,h(t,s,"GeneratorFunction")),t.prototype=Object.create(M),t},t.awrap=function(t){return{__await:t}},k(E.prototype),h(E.prototype,a,function(){return this}),t.AsyncIterator=E,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new E(l(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next()})},k(M),h(M,s,"Generator"),h(M,o,function(){return this}),h(M,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=C,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(D),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return s.type="throw",s.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var h=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(h&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(h){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else if(l){if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else throw Error("try statement without catch or finally")}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return(a.type=t,a.arg=e,o)?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;D(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(s);var h=s.exports,l=function(t){var e=t.paths,r=t.id,i=t.strokeWidth,o=t.strokeColor,a=t.command,s=void 0===a?f:a;if(1===e.length){var h=e[0],l=h.x,u=h.y,c=i/2;return n.createElement("circle",{key:r,id:r,cx:l,cy:u,r:c,stroke:o,fill:o})}var d=e.reduce(function(t,e,r,n){return 0===r?"M "+e.x+","+e.y:t+" "+s(e,r,n)},"");return n.createElement("path",{key:r,id:r,d:d,fill:"none",strokeLinecap:"round",stroke:o,strokeWidth:i})},u=function(t,e){var r=e.x-t.x,n=e.y-t.y;return{length:Math.sqrt(Math.pow(r,2)+Math.pow(n,2)),angle:Math.atan2(n,r)}},c=function(t){var e=t.current,r=t.next,n=t.previous,i=t.reverse,o=.2,a=u(n||e,r||e),s=a.angle+(i?Math.PI:0),h=a.length*o;return[e.x+Math.cos(s)*h,e.y+Math.sin(s)*h]},f=function(t,e,r){var n=null,i=null;switch(e){case 0:var o=c({current:t});n=o[0],i=o[1];break;case 1:var a=c({current:r[e-1],next:t});n=a[0],i=a[1];break;default:var s=c({current:r[e-1],previous:r[e-2],next:t});n=s[0],i=s[1]}var h=c({current:t,previous:r[e-1],next:r[e+1],reverse:!0});return"C "+n+","+i+" "+h[0]+","+h[1]+" "+t.x+", "+t.y},d=function(t){var e=t.id,r=t.paths;return n.createElement(n.Fragment,null,r.map(function(t,r){return n.createElement(l,{key:e+"__"+r,paths:t.paths,id:e+"__"+r,strokeWidth:t.strokeWidth,strokeColor:t.strokeColor,command:f})}))},p=function(t){return new Promise(function(e,r){var n=new Image;n.addEventListener("load",function(){n.width>0&&e(n),r("Image not found")}),n.addEventListener("error",function(t){return r(t)}),n.src=t,n.setAttribute("crossorigin","anonymous")})};function m(t){var e,r=null==(e=t.firstChild)?void 0:e.cloneNode(!0),n=t.offsetWidth,i=t.offsetHeight;return r.setAttribute("viewBox","0 0 "+n+" "+i),r.setAttribute("width",n.toString()),r.setAttribute("height",i.toString()),{svgCanvas:r,width:n,height:i}}var g=n.forwardRef(function(t,e){var r=t.paths,i=t.isDrawing,s=t.onPointerDown,u=t.onPointerMove,c=t.onPointerUp,f=t.id,g=void 0===f?"react-sketch-canvas":f,v=t.width,y=void 0===v?"100%":v,b=t.height,w=void 0===b?"100%":b,x=t.className,M=void 0===x?"react-sketch-canvas":x,k=t.canvasColor,E=void 0===k?"red":k,A=t.backgroundImage,_=void 0===A?"":A,S=t.exportWithBackgroundImage,D=void 0!==S&&S,P=t.preserveBackgroundImageAspectRatio,C=void 0===P?"none":P,I=t.allowOnlyPointerType,T=void 0===I?"all":I,B=t.style,R=void 0===B?{border:"0.0625rem solid #9c9c9c",borderRadius:"0.25rem"}:B,U=t.svgStyle,L=void 0===U?{}:U,O=n.useRef(null),N=function(t){var e,r,n,i=null==(e=O.current)?void 0:e.getBoundingClientRect(),o=null!=(r=window.scrollX)?r:0,a=null!=(n=window.scrollY)?n:0;return i?{x:t.pageX-i.left-o,y:t.pageY-i.top-a}:{x:0,y:0}},F=function(t){if(("all"===T||t.pointerType===T)&&("mouse"!==t.pointerType||0===t.button)){var e=N(t);s(e)}},z=function(t){if(i&&("all"===T||t.pointerType===T)){var e=N(t);u(e)}},Y=function(t){("mouse"!==t.pointerType||0===t.button)&&("all"===T||t.pointerType===T)&&c()};n.useImperativeHandle(e,function(){return{exportImage:function(t){return new Promise(function(){var e=o(h.mark(function e(r,n){var i,o,a,s,l,u,c,f;return h.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=O.current){e.next=4;break}throw Error("Canvas not rendered yet");case 4:return a=(o=m(i)).svgCanvas,s=o.width,l=o.height,u="data:image/svg+xml;base64,"+btoa(a.outerHTML),e.next=8,p(u);case 8:if(e.t0=e.sent,c=[e.t0],!D){e.next=21;break}return e.prev=11,e.next=14,p(_);case 14:f=e.sent,c.push(f),e.next=21;break;case 18:e.prev=18,e.t1=e.catch(11),console.warn("exportWithBackgroundImage props is set without a valid background image URL. This option is ignored");case 21:Promise.all(c).then(function(e){var n=document.createElement("canvas");n.setAttribute("width",s.toString()),n.setAttribute("height",l.toString());var i=n.getContext("2d");if(!i)throw Error("Canvas not rendered yet");e.reverse().forEach(function(t){i.drawImage(t,0,0)}),r(n.toDataURL("image/"+t))}).catch(function(t){throw t}),e.next=27;break;case 24:e.prev=24,e.t2=e.catch(0),n(e.t2);case 27:case"end":return e.stop()}},e,null,[[0,24],[11,18]])}));return function(t,r){return e.apply(this,arguments)}}())},exportSvg:function(){return new Promise(function(t,e){try{var r=null!=(n=O.current)?n:null;if(null!==r){var n,i,o,a=m(r).svgCanvas;if(D){t(a.outerHTML);return}null==(i=a.querySelector("#"+g+"__background"))||i.remove(),null==(o=a.querySelector("#"+g+"__canvas-background"))||o.setAttribute("fill",E),t(a.outerHTML)}e(Error("Canvas not loaded"))}catch(t){e(t)}})}}}),n.useEffect(function(){return document.addEventListener("pointerup",Y),function(){document.removeEventListener("pointerup",Y)}},[Y]);var X=r.filter(function(t){return!t.drawMode}),V=0,j=r.reduce(function(t,e){return e.drawMode?(void 0===t[V]&&(t[V]=[]),t[V].push(e)):V+=1,t},[[]]);return n.createElement("div",{role:"presentation",ref:O,className:M,style:a({touchAction:"none",width:y,height:w},R),"touch-action":"none",onPointerDown:F,onPointerMove:z,onPointerUp:Y},n.createElement("svg",{version:"1.1",baseProfile:"full",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",style:a({width:"100%",height:"100%"},L),id:g},n.createElement("g",{id:g+"__eraser-stroke-group",display:"none"},n.createElement("rect",{id:g+"__mask-background",x:"0",y:"0",width:"100%",height:"100%",fill:"white"}),X.map(function(t,e){return n.createElement(l,{key:g+"__eraser-"+e,id:g+"__eraser-"+e,paths:t.paths,strokeColor:"#000000",strokeWidth:t.strokeWidth})})),n.createElement("defs",null,_&&n.createElement("pattern",{id:g+"__background",x:"0",y:"0",width:"100%",height:"100%",patternUnits:"userSpaceOnUse"},n.createElement("image",{x:"0",y:"0",width:"100%",height:"100%",xlinkHref:_,preserveAspectRatio:C})),X.map(function(t,e){return n.createElement("mask",{id:g+"__eraser-mask-"+e,key:g+"__eraser-mask-"+e,maskUnits:"userSpaceOnUse"},n.createElement("use",{href:"#"+g+"__mask-background"}),Array.from({length:X.length-e},function(t,r){return r+e}).map(function(t){return n.createElement("use",{key:t.toString(),href:"#"+g+"__eraser-"+t.toString()})}))})),n.createElement("g",{id:g+"__canvas-background-group"},n.createElement("rect",{id:g+"__canvas-background",x:"0",y:"0",width:"100%",height:"100%",fill:_?"url(#"+g+"__background)":E})),j.map(function(t,e){return n.createElement("g",{id:g+"__stroke-group-"+e,key:g+"__stroke-group-"+e,mask:"url(#"+g+"__eraser-mask-"+e+")"},n.createElement(d,{id:g,paths:t}))})))}),v=n.forwardRef(function(t,e){var r=t.id,i=void 0===r?"react-sketch-canvas":r,o=t.width,s=void 0===o?"100%":o,h=t.height,l=void 0===h?"100%":h,u=t.className,c=void 0===u?"":u,f=t.canvasColor,d=void 0===f?"white":f,p=t.strokeColor,m=void 0===p?"red":p,v=t.backgroundImage,y=void 0===v?"":v,b=t.exportWithBackgroundImage,w=void 0!==b&&b,x=t.preserveBackgroundImageAspectRatio,M=void 0===x?"none":x,k=t.strokeWidth,E=void 0===k?4:k,A=t.eraserWidth,_=void 0===A?8:A,S=t.allowOnlyPointerType,D=void 0===S?"all":S,P=t.style,C=void 0===P?{border:"0.0625rem solid #9c9c9c",borderRadius:"0.25rem"}:P,I=t.svgStyle,T=void 0===I?{}:I,B=t.onChange,R=void 0===B?function(t){}:B,U=t.onStroke,L=void 0===U?function(t,e){}:U,O=t.withTimestamp,N=void 0!==O&&O,F=n.createRef(),z=n.useState(!0),Y=z[0],X=z[1],V=n.useState(!1),j=V[0],G=V[1],q=n.useState([]),H=q[0],W=q[1],K=n.useState([]),J=K[0],Q=K[1],Z=n.useState([]),$=Z[0],tt=Z[1],te=n.useCallback(function(){var t,e,r=null!=(t=null==(e=$.slice(-1))?void 0:e[0])?t:null;if(null===r){console.warn("No stroke found!");return}L(r,!r.drawMode)},[j]);n.useEffect(function(){te()},[j]),n.useEffect(function(){R($)},[$]),n.useImperativeHandle(e,function(){return{eraseMode:function(t){X(!t)},clearCanvas:function(){W([].concat($)),tt([])},undo:function(){if(0!==H.length){tt([].concat(H)),W([]);return}Q(function(t){return[].concat(t,$.slice(-1))}),tt(function(t){return t.slice(0,-1)})},redo:function(){0!==J.length&&(tt(function(t){return[].concat(t,J.slice(-1))}),Q(function(t){return t.slice(0,-1)}))},exportImage:function(t){var e,r=null==(e=F.current)?void 0:e.exportImage;if(r)return r(t);throw Error("Export function called before canvas loaded")},exportSvg:function(){return new Promise(function(t,e){var r,n=null==(r=F.current)?void 0:r.exportSvg;n?n().then(function(e){t(e)}).catch(function(t){e(t)}):e(Error("Export function called before canvas loaded"))})},exportPaths:function(){return new Promise(function(t,e){try{t($)}catch(t){e(t)}})},loadPaths:function(t){tt(function(e){return[].concat(e,t)})},getSketchingTime:function(){return new Promise(function(t,e){N||e(Error("Set 'withTimestamp' prop to get sketching time"));try{var r=$.reduce(function(t,e){var r,n,i=null!=(r=e.startTimestamp)?r:0,o=null!=(n=e.endTimestamp)?n:0;return t+(o-i)},0);t(r)}catch(t){e(t)}})},resetCanvas:function(){W([]),Q([]),tt([])}}});var tr=function(t){G(!0),Q([]);var e={drawMode:Y,strokeColor:Y?m:"#000000",strokeWidth:Y?E:_,paths:[t]};N&&(e=a({},e,{startTimestamp:Date.now(),endTimestamp:0})),tt(function(t){return[].concat(t,[e])})},tn=function(t){if(j){var e=$.slice(-1)[0],r=a({},e,{paths:[].concat(e.paths,[t])});tt(function(t){return[].concat(t.slice(0,-1),[r])})}},ti=function(){if(j&&(G(!1),N)){var t,e,r=null!=(t=null==(e=$.slice(-1))?void 0:e[0])?t:null;if(null!==r){var n=a({},r,{endTimestamp:Date.now()});tt(function(t){return[].concat(t.slice(0,-1),[n])})}}};return n.createElement(g,{ref:F,id:i,width:s,height:l,className:c,canvasColor:d,backgroundImage:y,exportWithBackgroundImage:w,preserveBackgroundImageAspectRatio:M,allowOnlyPointerType:D,style:C,svgStyle:T,paths:$,isDrawing:j,onPointerDown:tr,onPointerMove:tn,onPointerUp:ti})})},1358:function(t,e,r){"use strict";var n=r(1322),i=r(2505),o=r(3067),a=r(7350),s=5,h=33306690738754716e-32,l=7771561172376103e-31;function u(t,e,r,n){return function(r,i,o){var a=n(t(t(e(i[1],o[0]),e(-o[1],i[0])),t(e(r[1],i[0]),e(-i[1],r[0]))),t(e(r[1],o[0]),e(-o[1],r[0])));return a[a.length-1]}}function c(t,e,r,n){return function(i,o,a,s){var h=n(t(t(r(t(e(a[1],s[0]),e(-s[1],a[0])),o[2]),t(r(t(e(o[1],s[0]),e(-s[1],o[0])),-a[2]),r(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]))),t(r(t(e(o[1],s[0]),e(-s[1],o[0])),i[2]),t(r(t(e(i[1],s[0]),e(-s[1],i[0])),-o[2]),r(t(e(i[1],o[0]),e(-o[1],i[0])),s[2])))),t(t(r(t(e(a[1],s[0]),e(-s[1],a[0])),i[2]),t(r(t(e(i[1],s[0]),e(-s[1],i[0])),-a[2]),r(t(e(i[1],a[0]),e(-a[1],i[0])),s[2]))),t(r(t(e(o[1],a[0]),e(-a[1],o[0])),i[2]),t(r(t(e(i[1],a[0]),e(-a[1],i[0])),-o[2]),r(t(e(i[1],o[0]),e(-o[1],i[0])),a[2])))));return h[h.length-1]}}function f(t,e,r,n){return function(i,o,a,s,h){var l=n(t(t(t(r(t(r(t(e(s[1],h[0]),e(-h[1],s[0])),a[2]),t(r(t(e(a[1],h[0]),e(-h[1],a[0])),-s[2]),r(t(e(a[1],s[0]),e(-s[1],a[0])),h[2]))),o[3]),t(r(t(r(t(e(s[1],h[0]),e(-h[1],s[0])),o[2]),t(r(t(e(o[1],h[0]),e(-h[1],o[0])),-s[2]),r(t(e(o[1],s[0]),e(-s[1],o[0])),h[2]))),-a[3]),r(t(r(t(e(a[1],h[0]),e(-h[1],a[0])),o[2]),t(r(t(e(o[1],h[0]),e(-h[1],o[0])),-a[2]),r(t(e(o[1],a[0]),e(-a[1],o[0])),h[2]))),s[3]))),t(r(t(r(t(e(a[1],s[0]),e(-s[1],a[0])),o[2]),t(r(t(e(o[1],s[0]),e(-s[1],o[0])),-a[2]),r(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]))),-h[3]),t(r(t(r(t(e(s[1],h[0]),e(-h[1],s[0])),o[2]),t(r(t(e(o[1],h[0]),e(-h[1],o[0])),-s[2]),r(t(e(o[1],s[0]),e(-s[1],o[0])),h[2]))),i[3]),r(t(r(t(e(s[1],h[0]),e(-h[1],s[0])),i[2]),t(r(t(e(i[1],h[0]),e(-h[1],i[0])),-s[2]),r(t(e(i[1],s[0]),e(-s[1],i[0])),h[2]))),-o[3])))),t(t(r(t(r(t(e(o[1],h[0]),e(-h[1],o[0])),i[2]),t(r(t(e(i[1],h[0]),e(-h[1],i[0])),-o[2]),r(t(e(i[1],o[0]),e(-o[1],i[0])),h[2]))),s[3]),t(r(t(r(t(e(o[1],s[0]),e(-s[1],o[0])),i[2]),t(r(t(e(i[1],s[0]),e(-s[1],i[0])),-o[2]),r(t(e(i[1],o[0]),e(-o[1],i[0])),s[2]))),-h[3]),r(t(r(t(e(a[1],s[0]),e(-s[1],a[0])),o[2]),t(r(t(e(o[1],s[0]),e(-s[1],o[0])),-a[2]),r(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]))),i[3]))),t(r(t(r(t(e(a[1],s[0]),e(-s[1],a[0])),i[2]),t(r(t(e(i[1],s[0]),e(-s[1],i[0])),-a[2]),r(t(e(i[1],a[0]),e(-a[1],i[0])),s[2]))),-o[3]),t(r(t(r(t(e(o[1],s[0]),e(-s[1],o[0])),i[2]),t(r(t(e(i[1],s[0]),e(-s[1],i[0])),-o[2]),r(t(e(i[1],o[0]),e(-o[1],i[0])),s[2]))),a[3]),r(t(r(t(e(o[1],a[0]),e(-a[1],o[0])),i[2]),t(r(t(e(i[1],a[0]),e(-a[1],i[0])),-o[2]),r(t(e(i[1],o[0]),e(-o[1],i[0])),a[2]))),-s[3]))))),t(t(t(r(t(r(t(e(s[1],h[0]),e(-h[1],s[0])),a[2]),t(r(t(e(a[1],h[0]),e(-h[1],a[0])),-s[2]),r(t(e(a[1],s[0]),e(-s[1],a[0])),h[2]))),i[3]),r(t(r(t(e(s[1],h[0]),e(-h[1],s[0])),i[2]),t(r(t(e(i[1],h[0]),e(-h[1],i[0])),-s[2]),r(t(e(i[1],s[0]),e(-s[1],i[0])),h[2]))),-a[3])),t(r(t(r(t(e(a[1],h[0]),e(-h[1],a[0])),i[2]),t(r(t(e(i[1],h[0]),e(-h[1],i[0])),-a[2]),r(t(e(i[1],a[0]),e(-a[1],i[0])),h[2]))),s[3]),r(t(r(t(e(a[1],s[0]),e(-s[1],a[0])),i[2]),t(r(t(e(i[1],s[0]),e(-s[1],i[0])),-a[2]),r(t(e(i[1],a[0]),e(-a[1],i[0])),s[2]))),-h[3]))),t(t(r(t(r(t(e(a[1],h[0]),e(-h[1],a[0])),o[2]),t(r(t(e(o[1],h[0]),e(-h[1],o[0])),-a[2]),r(t(e(o[1],a[0]),e(-a[1],o[0])),h[2]))),i[3]),r(t(r(t(e(a[1],h[0]),e(-h[1],a[0])),i[2]),t(r(t(e(i[1],h[0]),e(-h[1],i[0])),-a[2]),r(t(e(i[1],a[0]),e(-a[1],i[0])),h[2]))),-o[3])),t(r(t(r(t(e(o[1],h[0]),e(-h[1],o[0])),i[2]),t(r(t(e(i[1],h[0]),e(-h[1],i[0])),-o[2]),r(t(e(i[1],o[0]),e(-o[1],i[0])),h[2]))),a[3]),r(t(r(t(e(o[1],a[0]),e(-a[1],o[0])),i[2]),t(r(t(e(i[1],a[0]),e(-a[1],i[0])),-o[2]),r(t(e(i[1],o[0]),e(-o[1],i[0])),a[2]))),-h[3])))));return l[l.length-1]}}function d(t){return(3===t?u:4===t?c:f)(i,n,o,a)}var p=d(3),m=d(4),g=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,r){var n,i=(t[1]-r[1])*(e[0]-r[0]),o=(t[0]-r[0])*(e[1]-r[1]),a=i-o;if(i>0){if(o<=0)return a;n=i+o}else{if(!(i<0)||o>=0)return a;n=-(i+o)}var s=h*n;return a>=s||a<=-s?a:p(t,e,r)},function(t,e,r,n){var i=t[0]-n[0],o=e[0]-n[0],a=r[0]-n[0],s=t[1]-n[1],h=e[1]-n[1],u=r[1]-n[1],c=t[2]-n[2],f=e[2]-n[2],d=r[2]-n[2],p=o*u,g=a*h,v=a*s,y=i*u,b=i*h,w=o*s,x=c*(p-g)+f*(v-y)+d*(b-w),M=l*((Math.abs(p)+Math.abs(g))*Math.abs(c)+(Math.abs(v)+Math.abs(y))*Math.abs(f)+(Math.abs(b)+Math.abs(w))*Math.abs(d));return x>M||-x>M?x:m(t,e,r,n)}];function v(t){var e=g[t.length];return e||(e=g[t.length]=d(t.length)),e.apply(void 0,t)}function y(t,e,r,n,i,o,a){return function(e,r,s,h,l){switch(arguments.length){case 0:case 1:return 0;case 2:return n(e,r);case 3:return i(e,r,s);case 4:return o(e,r,s,h);case 5:return a(e,r,s,h,l)}for(var u=Array(arguments.length),c=0;c<arguments.length;++c)u[c]=arguments[c];return t(u)}}!function(){for(;g.length<=s;)g.push(d(g.length));t.exports=y.apply(void 0,[v].concat(g));for(var e=0;e<=s;++e)t.exports[e]=g[e]}()},5863:function(t,e,r){"use strict";t.exports=i;var n=r(1358);function i(t,e){for(var r=e[0],i=e[1],o=t.length,a=1,s=o,h=0,l=o-1;h<s;l=h++){var u=t[h],c=t[l],f=u[1],d=c[1];if(d<f){if(d<i&&i<f){var p=n(u,c,e);if(0===p)return 0;a^=0<p|0}else if(i===f){var m=t[(h+1)%o],g=m[1];if(f<g){var p=n(u,c,e);if(0===p)return 0;a^=0<p|0}}}else if(f<d){if(f<i&&i<d){var p=n(u,c,e);if(0===p)return 0;a^=p<0|0}else if(i===f){var m=t[(h+1)%o],g=m[1];if(g<f){var p=n(u,c,e);if(0===p)return 0;a^=p<0|0}}}else if(i===f){var v=Math.min(u[0],c[0]),y=Math.max(u[0],c[0]);if(0===h){for(;l>0;){var b=(l+o-1)%o,w=t[b];if(w[1]!==i)break;var x=w[0];v=Math.min(v,x),y=Math.max(y,x),l=b}if(0===l){if(v<=r&&r<=y)return 0;return 1}s=l+1}for(var M=t[(l+o-1)%o][1];h+1<s;){var w=t[h+1];if(w[1]!==i)break;var x=w[0];v=Math.min(v,x),y=Math.max(y,x),h+=1}if(v<=r&&r<=y)return 0;var k=t[(h+1)%o][1];r<v&&M<i!=k<i&&(a^=1)}}return 2*a-1}},3067:function(t,e,r){"use strict";var n=r(1322),i=r(7838);function o(t,e){var r=t.length;if(1===r){var o=n(t[0],e);return o[0]?o:[o[1]]}var a=Array(2*r),s=[.1,.1],h=[.1,.1],l=0;n(t[0],e,s),s[0]&&(a[l++]=s[0]);for(var u=1;u<r;++u){n(t[u],e,h),i(s[1],h[0],s),s[0]&&(a[l++]=s[0]);var c=h[1],f=s[1],d=c+f,p=f-(d-c);s[1]=d,p&&(a[l++]=p)}return s[1]&&(a[l++]=s[1]),0===l&&(a[l++]=0),a.length=l,a}t.exports=o},7350:function(t){"use strict";function e(t,e){var r=t+e,n=r-t,i=t-(r-n)+(e-n);return i?[i,r]:[r]}function r(t,r){var n,i,o,a,s,h,l,u=0|t.length,c=0|r.length;if(1===u&&1===c)return e(t[0],-r[0]);var f=Array(u+c),d=0,p=0,m=0,g=Math.abs,v=t[0],y=g(v),b=-r[m],w=g(b);y<w?(i=v,(p+=1)<u&&(y=g(v=t[p]))):(i=b,(m+=1)<c&&(w=g(b=-r[m]))),p<u&&y<w||m>=c?(n=v,(p+=1)<u&&(y=g(v=t[p]))):(n=b,(m+=1)<c&&(w=g(b=-r[m])));for(var x=n+i,M=x-n,k=i-M,E=k,A=x;p<u&&m<c;)y<w?(n=v,(p+=1)<u&&(y=g(v=t[p]))):(n=b,(m+=1)<c&&(w=g(b=-r[m]))),M=(x=n+(i=E))-n,(k=i-M)&&(f[d++]=k),a=(o=A+x)-A,s=o-a,h=x-a,E=(l=A-s)+h,A=o;for(;p<u;)M=(x=(n=v)+(i=E))-n,(k=i-M)&&(f[d++]=k),a=(o=A+x)-A,s=o-a,h=x-a,E=(l=A-s)+h,A=o,(p+=1)<u&&(v=t[p]);for(;m<c;)M=(x=(n=b)+(i=E))-n,(k=i-M)&&(f[d++]=k),a=(o=A+x)-A,s=o-a,h=x-a,E=(l=A-s)+h,A=o,(m+=1)<c&&(b=-r[m]);return E&&(f[d++]=E),A&&(f[d++]=A),d||(f[d++]=0),f.length=d,f}t.exports=r},2505:function(t){"use strict";function e(t,e){var r=t+e,n=r-t,i=t-(r-n)+(e-n);return i?[i,r]:[r]}function r(t,r){var n,i,o,a,s,h,l,u=0|t.length,c=0|r.length;if(1===u&&1===c)return e(t[0],r[0]);var f=Array(u+c),d=0,p=0,m=0,g=Math.abs,v=t[0],y=g(v),b=r[m],w=g(b);y<w?(i=v,(p+=1)<u&&(y=g(v=t[p]))):(i=b,(m+=1)<c&&(w=g(b=r[m]))),p<u&&y<w||m>=c?(n=v,(p+=1)<u&&(y=g(v=t[p]))):(n=b,(m+=1)<c&&(w=g(b=r[m])));for(var x=n+i,M=x-n,k=i-M,E=k,A=x;p<u&&m<c;)y<w?(n=v,(p+=1)<u&&(y=g(v=t[p]))):(n=b,(m+=1)<c&&(w=g(b=r[m]))),M=(x=n+(i=E))-n,(k=i-M)&&(f[d++]=k),a=(o=A+x)-A,s=o-a,h=x-a,E=(l=A-s)+h,A=o;for(;p<u;)M=(x=(n=v)+(i=E))-n,(k=i-M)&&(f[d++]=k),a=(o=A+x)-A,s=o-a,h=x-a,E=(l=A-s)+h,A=o,(p+=1)<u&&(v=t[p]);for(;m<c;)M=(x=(n=b)+(i=E))-n,(k=i-M)&&(f[d++]=k),a=(o=A+x)-A,s=o-a,h=x-a,E=(l=A-s)+h,A=o,(m+=1)<c&&(b=r[m]);return E&&(f[d++]=E),A&&(f[d++]=A),d||(f[d++]=0),f.length=d,f}t.exports=r},3718:function(t,e,r){"use strict";var n=r(6215),i=r(8200),o=r(5033),a=r(4072),s=r(7582),h=r(983),l=r(4911);l.alea=n,l.xor128=i,l.xorwow=o,l.xorshift7=a,l.xor4096=s,l.tychei=h,t.exports=l},6215:function(t,e,r){var n;!function(i,o,a){function s(t){var e=this,r=u();e.next=function(){var t=2091639*e.s0+23283064365386963e-26*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=r(" "),e.s1=r(" "),e.s2=r(" "),e.s0-=r(t),e.s0<0&&(e.s0+=1),e.s1-=r(t),e.s1<0&&(e.s1+=1),e.s2-=r(t),e.s2<0&&(e.s2+=1)}function h(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function l(t,e){var r=new s(t),n=e&&e.state,i=r.next;return i.int32=function(){return 4294967296*r.next()|0},i.double=function(){return i()+(2097152*i()|0)*11102230246251565e-32},i.quick=i,n&&("object"==typeof n&&h(n,r),i.state=function(){return h(r,{})}),i}function u(){var t=4022871197;return function(e){e=e.toString();for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));t=n>>>0,n-=t,n*=t,t=n>>>0,n-=t,t+=4294967296*n}return(t>>>0)*23283064365386963e-26}}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0!==(n=(function(){return l}).call(e,r,e,t))&&(t.exports=n):this.alea=l}(0,t=r.nmd(t),r.amdD)},983:function(t,e,r){var n;!function(i,o,a){function s(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,i=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}function h(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function l(t,e){var r=new s(t),n=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152;while(0===t);return t},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&h(n,r),i.state=function(){return h(r,{})}),i}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0!==(n=(function(){return l}).call(e,r,e,t))&&(t.exports=n):this.tychei=l}(0,t=r.nmd(t),r.amdD)},8200:function(t,e,r){var n;!function(i,o,a){function s(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}function h(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function l(t,e){var r=new s(t),n=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152;while(0===t);return t},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&h(n,r),i.state=function(){return h(r,{})}),i}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0!==(n=(function(){return l}).call(e,r,e,t))&&(t.exports=n):this.xor128=l}(0,t=r.nmd(t),r.amdD)},7582:function(t,e,r){var n;!function(i,o,a){function s(t){var e=this;e.next=function(){var t,r,n=e.w,i=e.X,o=e.i;return e.w=n=n+1640531527|0,r=i[o+34&127],t=i[o=o+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=i[o]=r^t,e.i=o,r+(n^n>>>16)|0},function(t,e){var r,n,i,o,a,s=[],h=128;for(e===(0|e)?(n=e,e=null):(e+="\x00",n=0,h=Math.max(h,e.length)),i=0,o=-32;o<h;++o)e&&(n^=e.charCodeAt((o+32)%e.length)),0===o&&(a=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,o>=0&&(a=a+1640531527|0,i=0==(r=s[127&o]^=n+a)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)n=s[i+34&127],r=s[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,s[i]=n^r;t.w=a,t.X=s,t.i=i}(e,t)}function h(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function l(t,e){null==t&&(t=+new Date);var r=new s(t),n=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152;while(0===t);return t},i.int32=r.next,i.quick=i,n&&(n.X&&h(n,r),i.state=function(){return h(r,{})}),i}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0!==(n=(function(){return l}).call(e,r,e,t))&&(t.exports=n):this.xor4096=l}(0,t=r.nmd(t),r.amdD)},4072:function(t,e,r){var n;!function(i,o,a){function s(t){var e=this;e.next=function(){var t,r,n=e.x,i=e.i;return t=n[i],t^=t>>>7,r=t^t<<24^((t=n[i+1&7])^t>>>10)^((t=n[i+3&7])^t>>>3)^((t=n[i+4&7])^t<<7),t=n[i+7&7],t^=t<<13,r^=t^t<<9,n[i]=r,e.i=i+1&7,r},function(t,e){var r,n,i=[];if(e===(0|e))n=i[0]=e;else for(r=0,e=""+e;r<e.length;++r)i[7&r]=i[7&r]<<15^e.charCodeAt(r)+i[r+1&7]<<13;for(;i.length<8;)i.push(0);for(r=0;r<8&&0===i[r];++r);for(n=8==r?i[7]=-1:i[r],t.x=i,t.i=0,r=256;r>0;--r)t.next()}(e,t)}function h(t,e){return e.x=t.x.slice(),e.i=t.i,e}function l(t,e){null==t&&(t=+new Date);var r=new s(t),n=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152;while(0===t);return t},i.int32=r.next,i.quick=i,n&&(n.x&&h(n,r),i.state=function(){return h(r,{})}),i}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0!==(n=(function(){return l}).call(e,r,e,t))&&(t.exports=n):this.xorshift7=l}(0,t=r.nmd(t),r.amdD)},5033:function(t,e,r){var n;!function(i,o,a){function s(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^(t^t<<1))|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function h(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function l(t,e){var r=new s(t),n=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/2097152;while(0===t);return t},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&h(n,r),i.state=function(){return h(r,{})}),i}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0!==(n=(function(){return l}).call(e,r,e,t))&&(t.exports=n):this.xorwow=l}(0,t=r.nmd(t),r.amdD)},4911:function(t,e,r){"use strict";var n;!function(i,o){var a,s=(0,eval)("this"),h=256,l=6,u=52,c="random",f=o.pow(h,l),d=o.pow(2,u),p=2*d,m=h-1;function g(t,e,r){var n=[],a=w(b((e=!0==e?{entropy:!0}:e||{}).entropy?[t,M(i)]:null==t?x():t,3),n),s=new v(n),u=function(){for(var t=s.g(l),e=f,r=0;t<d;)t=(t+r)*h,e*=h,r=s.g(1);for(;t>=p;)t/=2,e/=2,r>>>=1;return(t+r)/e};return u.int32=function(){return 0|s.g(4)},u.quick=function(){return s.g(4)/4294967296},u.double=u,w(M(s.S),i),(e.pass||r||function(t,e,r,n){return(n&&(n.S&&y(n,s),t.state=function(){return y(s,{})}),r)?(o[c]=t,e):t})(u,a,"global"in e?e.global:this==o,e.state)}function v(t){var e,r=t.length,n=this,i=0,o=n.i=n.j=0,a=n.S=[];for(r||(t=[r++]);i<h;)a[i]=i++;for(i=0;i<h;i++)a[i]=a[o=m&o+t[i%r]+(e=a[i])],a[o]=e;(n.g=function(t){for(var e,r=0,i=n.i,o=n.j,a=n.S;t--;)e=a[i=m&i+1],r=r*h+a[m&(a[i]=a[o=m&o+e])+(a[o]=e)];return n.i=i,n.j=o,r})(h)}function y(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function b(t,e){var r,n=[],i=typeof t;if(e&&"object"==i)for(r in t)try{n.push(b(t[r],e-1))}catch(t){}return n.length?n:"string"==i?t:t+"\x00"}function w(t,e){for(var r,n=t+"",i=0;i<n.length;)e[m&i]=m&(r^=19*e[m&i])+n.charCodeAt(i++);return M(e)}function x(){try{var t;return a&&(t=a.randomBytes)?t=t(h):(t=new Uint8Array(h),(s.crypto||s.msCrypto).getRandomValues(t)),M(t)}catch(t){var e=s.navigator,r=e&&e.plugins;return[+new Date,s,r,s.screen,M(i)]}}function M(t){return String.fromCharCode.apply(0,t)}if(o["seed"+c]=g,w(o.random(),i),t.exports){t.exports=g;try{a=r(5042)}catch(t){}}else void 0!==(n=(function(){return g}).call(e,r,e,t))&&(t.exports=n)}([],Math)},1322:function(t){"use strict";t.exports=r;var e=134217729;function r(t,r,n){var i=t*r,o=e*t,a=o-t,s=o-a,h=t-s,l=e*r,u=l-r,c=l-u,f=r-c,d=i-s*c-h*c-s*f,p=h*f-d;return n?(n[0]=p,n[1]=i,n):[p,i]}},7838:function(t){"use strict";function e(t,e,r){var n=t+e,i=n-t,o=n-i,a=e-i,s=t-o;return r?(r[0]=s+a,r[1]=n,r):[s+a,n]}t.exports=e},8672:function(t,e,r){"use strict";var n=r(8914),i=navigator.hardwareConcurrency||1;function o(t,e){if("string"!=typeof t&&"function"!=typeof t)throw TypeError("func argument must be a function");if(void 0===e&&(e={}),"object"!=typeof e||null===e)throw TypeError("options argument must be an object");this._workerCode=t.toString(),void 0===e.maxWorkers||"auto"===e.maxWorkers?this._numWorkers=Math.min(i-1,1):e.maxWorkers>0?this._numWorkers=Math.min(e.maxWorkers,i):this._numWorkers=i,this._workers=new Map,this._timeout=e.timeout||0,this._terminateOnError=!!e.terminateOnError;var r=e.deps;"string"==typeof r&&(r=[r]),Array.isArray(r)||(r=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(r)}o.prototype._init=function(t){for(var e=n.newWorkerURL(this._workerCode,t),r=0;r<this._numWorkers;r++){var i=new Worker(e);i.onmessage=this._onmessage.bind(this,i),i.onerror=this._onerror.bind(this,i),i.running=!1,i.id=r,this._workers.set(i,null)}URL.revokeObjectURL(e)},o.prototype._onerror=function(t,e){if(!this._terminated){this._working--,t.running=!1;var r=this._workers.get(t);r&&r[1](e.message),this._workers.set(t,null),this._terminateOnError?this.terminate():this._exec()}},o.prototype._onmessage=function(t,e){if(!this._terminated){this._working--,t.running=!1;var r=this._workers.get(t);r&&r[0](e.data.data),this._workers.set(t,null),this._exec()}},o.prototype._exec=function(){for(var t of this._workers.keys()){if(this._working===this._numWorkers||0===this._waiting.length)return;if(!t.running)for(var e=0;e<this._waiting.length;e++){var r=this._waiting[e];if("number"!=typeof r[4]||r[4]===t.id){this._waiting.splice(e,1),t.postMessage({action:"exec",event:r[0],args:r[1]},r[2]),t.running=!0,t.time=Date.now(),this._workers.set(t,r[3]),this._working++;break}}}},o.prototype.terminate=function(){if(!this._terminated){for(var t of this._workers)t[0].terminate(),t[1]&&t[1][1](Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},o.prototype.postAll=function(t,e){if(this._terminated)throw Error("Cannot post (terminated)");var r=[];for(var n of this._workers.keys())r.push(this.post(t,e,[],n.id));return Promise.all(r)},o.prototype.post=function(t,e,r,n){void 0===e&&(e=[]),void 0===r&&(r=[]),Array.isArray(e)||(e=[e]),Array.isArray(r)||(r=[r]);var i=this;return new Promise(function(o,a){if(i._terminated)throw Error("Cannot post (terminated)");i._waiting.push([t,e,r,[o,a],n]),i._exec()})},t.exports=o},8914:function(t,e){"use strict";var r=(function(){function t(){this._listeners={}}self.window=self,t.prototype.on=function(t,e){if(this._listeners[t])throw RangeError("there is already a listener for "+t);if("function"!=typeof e)throw TypeError("callback argument must be a function");this._listeners[t]=e},t.prototype._send=function(t,e,r){void 0===r?r=[]:Array.isArray(r)||(r=[r]),self.postMessage({id:t,data:e},r)},t.prototype._trigger=function(t,e){if(!this._listeners[t])throw Error("event "+t+" is not defined");this._listeners[t].apply(null,e)};var e=new t;self.onmessage=function(t){switch(t.data.action){case"exec":t.data.args.unshift(function(r,n){e._send(t.data.id,r,n)}),e._trigger(t.data.event,t.data.args);break;case"ping":e._send(t.data.id,"pong");break;default:throw Error("unexpected action: "+t.data.action)}}}).toString().split('"CODE";');e.newWorkerURL=function(t,e){var n=new Blob(["(",r[0],"importScripts.apply(self, "+JSON.stringify(e)+");\n","(",t,")();",r[1],")();"],{type:"application/javascript"});return URL.createObjectURL(n)}},3879:function(t,e,r){"use strict";function n(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}r.d(e,{E:function(){return n}})},7354:function(t,e,r){"use strict";function n(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}r.d(e,{J:function(){return n}})},2731:function(t,e,r){"use strict";function n(t,e){return e.get?e.get.call(t):e.value}r.r(e),r.d(e,{_:function(){return o},_class_private_field_get:function(){return o}});var i=r(7354);function o(t,e){var r=(0,i.J)(t,e,"get");return n(t,r)}},8146:function(t,e,r){"use strict";r.r(e),r.d(e,{_:function(){return i},_class_private_field_init:function(){return i}});var n=r(3879);function i(t,e,r){(0,n.E)(t,e),e.set(t,r)}},5577:function(t,e,r){"use strict";function n(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}r.r(e),r.d(e,{_:function(){return o},_class_private_field_set:function(){return o}});var i=r(7354);function o(t,e,r){var o=(0,i.J)(t,e,"set");return n(t,o,r),r}},4831:function(t,e,r){"use strict";function n(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}r.r(e),r.d(e,{_:function(){return n},_class_private_method_get:function(){return n}})},7920:function(t,e,r){"use strict";r.r(e),r.d(e,{_:function(){return i},_class_private_method_init:function(){return i}});var n=r(3879);function i(t,e){(0,n.E)(t,e),e.add(t)}},8365:function(t){"use strict";t.exports={version:"1.0.1"}}}]);